!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=103)}([function(e,t){e.exports={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795}},function(e,t,n){"use strict";n.r(t);function r(e,t,n){switch(t){case 300:return n?function(e){return e.replace(/attribute\s+/g,"in ").replace(/varying\s+/g,"out ").replace(/texture2D\(/g,"texture(").replace(/textureCube\(+/g,"texture(")}(e):function(e){return e.replace(/varying\s+/g,"in ").replace(/texture2D\(/g,"texture(").replace(/textureCube\(/g,"texture(")}(e);case 100:return n?function(e){return e.replace(/^in\s+/gm,"attribute ").replace(/^out\s+/gm,"varying ").replace(/texture\(/g,"texture2D(")}(e):function(e){return e.replace(/^in\s+/gm,"varying ").replace(/texture\(/g,"texture2D(")}(e);default:throw new Error(`unknown GLSL version ${t}`)}}function i(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}const o="vs",s="fs";class a{constructor({name:e,vs:t,fs:n,dependencies:r=[],getUniforms:o=(()=>({})),deprecations:s=[],vertexShader:a,fragmentShader:u}){i("string"==typeof e),this.name=e,this.vs=t||a,this.fs=n||u,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(s)}getModuleSource(e,t){let n;switch(e){case o:n=r(this.vs||"",t,!0);break;case s:n=r(this.fs||"",t,!1);break;default:i(!1)}if("string"!=typeof n)return""}getUniforms(e,t){return this.getModuleUniforms(e,t)}checkDeprecations(e,t){this.deprecations.forEach(n=>{n.regex.test(e)&&(n.deprecated&&t?t.deprecated(n.old,n.new)():t&&t.removed(n.old,n.new)())})}_parseDeprecationDefinitions(e=[]){return e.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),e}}const u=new class{constructor(){this.shaderModules={},this.defaultShaderModules=[]}setDefaultShaderModules(e){this.defaultShaderModules=this.resolveModules(e)}registerShaderModules(e,{ignoreMultipleRegistrations:t=!1}={}){for(const n of e)this._registerShaderModule(n,t)}getShaderModule(e){if(e instanceof a)return e;if("string"!=typeof e)return this._registerShaderModule(e,!0);const t=this.shaderModules[e];return t||i(!1,`Unknown shader module ${e}`),t}resolveModules(e){return e.map(e=>this.getShaderModule(e))}_registerShaderModule(e,t=!1){if(e instanceof a)return e;if(i(e.name,"shader module has no name"),this.shaderModules[e.name]&&!t)throw new Error(`shader module ${e.name} already registered`);return(e=new a(e)).dependencies=this.resolveModules(e.dependencies),this.shaderModules[e.name]=e,this.shaderModules[e.name]}};function c(e){u.setDefaultShaderModules(e)}function l(e,{ignoreMultipleRegistrations:t=!1}={}){u.registerShaderModules(e,{ignoreMultipleRegistrations:t})}function f(e){return u.getShaderModule(e)}function h(e){const t={},n={};return d({modules:e,level:0,moduleMap:t,moduleDepth:n}),Object.keys(n).sort((e,t)=>n[t]-n[e]).map(e=>t[e])}function d({modules:e,level:t,moduleMap:n,moduleDepth:r}){if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const i of e)n[i.name]=i,(void 0===r[i.name]||r[i.name]<t)&&(r[i.name]=t);for(const i of e)i.dependencies&&d({modules:i.dependencies,level:t+1,moduleMap:n,moduleDepth:r})}const p="vs",_="fs";const g=32874,m=7936,E=7937,v=7938,y=35724,b={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},A={};Object.keys(b).forEach(e=>{A[e]=e});const T={};function R(e,t,n={}){const r=b[t];if(i(r,t),!function(e={}){const t="undefined"!=typeof window&&window.navigator||{},n=e.userAgent||t.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(t in T)return T[t];const o=`#extension GL_${r[0]} : ${n.behavior||"enable"}\nvoid main(void) {}`,s=e.createShader(e.VERTEX_SHADER);e.shaderSource(s,o),e.compileShader(s);const a=e.getShaderParameter(s,e.COMPILE_STATUS);return e.deleteShader(s),T[t]=a,a}function x(e,t){const n=b[t];i(n,t);const r=function(e){return Boolean(e&&("undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||e.TEXTURE_BINDING_3D===g))}(e)&&n[1]||n[0],o="string"==typeof r?Boolean(e.getExtension(r)):r;return i(!1===o||!0===o),o}function S(e,t){return(t=Array.isArray(t)?t:[t]).every(t=>x(e,t))}function I(e){switch(function(e){const t=e.getExtension("WEBGL_debug_renderer_info"),n=e.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||m),r=e.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||E);return{gpuVendor:function(e,t){return e.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":e.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":e.match(/AMD/i)||t.match(/AMD/i)||e.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,r),vendor:n,renderer:r,version:e.getParameter(v),shadingLanguageVersion:e.getParameter(y)}}(e).gpuVendor.toLowerCase()){case"nvidia":case"intel":case"amd":default:return}}var C=n(14),N=n.n(C);const w={[p]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[_]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},F=/void main\s*\([^)]*\)\s*\{\n?/,M=/}\n?[^{}]*$/;function O(e){const t={};return N()(Array.isArray(e)&&e.length>1),e.forEach(e=>{for(const n in e)t[n]=t[n]?`${t[n]}\n${e[n]}`:e[n]}),t}const L={[p]:"vertex",[_]:"fragment"},P="precision highp float;\n\n";function B(e,t={}){const{vs:n,fs:r}=t,i=function(e){return e=e.concat(u.defaultShaderModules),h(e=u.resolveModules(e))}(t.modules||[]);return{gl:e,vs:D(e,Object.assign({},t,{source:n,type:p,modules:i})),fs:D(e,Object.assign({},t,{source:r,type:_,modules:i})),getUniforms:function(e){return function(t){const n={};for(const r of e){const e=r.getUniforms(t,n);Object.assign(n,e)}return n}}(i),modules:function(e){const t={};for(const n of e){const e=f(n);t[n]=e}return t}(i)}}function D(e,{id:t,source:n,type:r,modules:o=[],defines:s={},inject:a={},prologue:u=!0,log:c}){i("string"==typeof n,"shader source must be a string");const l=r===p,f=n.split("\n");let h=100,d="",_=n;0===f[0].indexOf("#version ")&&(h=300,d=f[0],_=f.slice(1).join("\n"));let g=u?`${d}\n${function({id:e,source:t,type:n}){return e&&"string"==typeof e&&-1===t.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${e}_${L[n]}\n\n`:""}({id:t,source:n,type:r})}\n${I(e)}\n${function(e,t,n){let r="#if (__VERSION__ > 120)\n\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return S(e,A.GLSL_FRAG_DEPTH)&&(r+="// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),S(e,A.GLSL_DERIVATIVES)&&R(e,A.GLSL_DERIVATIVES)&&(r+="// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define DERIVATIVES\n#endif\n"),S(e,A.GLSL_FRAG_DATA)&&R(e,A.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define DRAW_BUFFERS\n#endif\n"),S(e,A.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n# define TEXTURE_LOD\n#define texture2DLod texture2DLodEXT\n#define texture2DProjLod texture2DProjLodEXT\n#define texture2DProjLod texture2DProjLodEXT\n#define textureCubeLod textureCubeLodEXT\n#define texture2DGrad texture2DGradEXT\n#define texture2DProjGrad texture2DProjGradEXT\n#define texture2DProjGrad texture2DProjGradEXT\n#define textureCubeGrad textureCubeGradEXT\n#endif\n"),r}(e)}\n${function(e={}){let t=0,n="";for(const r in e){0===t&&(n+="\n// APPLICATION DEFINES\n"),t++;const i=e[r];(i||Number.isFinite(i))&&(n+=`#define ${r.toUpperCase()} ${e[r]}\n`)}0===t&&(n+="\n");return n}(s)}\n${l?"":P}\n`:`${d}\n`,m=!1;for(const e of o)switch(e.name){case"inject":m=!0;break;default:e.checkDeprecations(_,c),g+=e.getModuleSource(r,h)}return g=function(e,t,n,r){const i=t===p;for(const t in n){const r=n[t];switch(t){case"vs:#decl":i&&(e=e.replace(F,e=>`${r}\n${e}`));break;case"vs:#main-start":i&&(e=e.replace(F,e=>e+r));break;case"vs:#main-end":i&&(e=e.replace(M,e=>r+e));break;case"fs:#decl":i||(e=e.replace(F,e=>`${r}\n${e}`));break;case"fs:#main-start":i||(e=e.replace(F,e=>e+r));break;case"fs:#main-end":i||(e=e.replace(M,e=>r+e));break;default:e=e.replace(t,e=>e+r)}}return r&&(e=e.replace("}s*$",e=>e+w[t])),e}(g+=_,r,a,m)}const U={boolean:{validate:(e,t)=>!0},number:{validateType:(e,t)=>"value"in t&&(!("max"in t)||Number.isFinite(t.max))&&(!("min"in t)||Number.isFinite(t.min)),validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)}};function k(e,t){switch(G(t)){case"object":return function(e){const{type:t}=e,n=U[t]||{},{typeValidator:r}=n;return e}(t=function(e,t){if(!("type"in t))return"value"in t?Object.assign({name:e,type:G(t.value)},t):{name:e,type:"object",value:t};return Object.assign({name:e},t)}(e,t));case"array":return function(e,t){if(/color/i.test(e)&&(3===t.length||4===t.length))return{name:e,type:"color",value:t};return{name:e,type:"array",value:t}}(e,t);case"boolean":return{name:e,type:"boolean",value:t};case"number":return function(e,t){const n=/radius|scale|width|height|pixel|size|miter/i.test(e)&&/^((?!scale).)*$/.test(e)?100:1;return{name:e,type:"number",max:Math.max(t,n),min:Math.min(t,0),value:t}}(e,t);case"function":return{name:e,type:"function",value:t};default:return{name:e,type:"unknown",value:t}}}function G(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":null===e?"null":typeof e}function j(e){if(!e.normalized){if(e.normalized=!0,e.uniforms){const{propTypes:t}=function(e){const t={},n={};for(const[r,i]of Object.entries(e)){const e=k(r,i);t[r]=e,n[r]=e.value}return{propTypes:t,defaultProps:n}}(e.uniforms);e.uniforms=t}e.uniforms&&!e.getUniforms&&(e.getUniforms=function(e,t){const n={};if(void 0===t){for(const t in e.uniforms)n[t]=e.uniforms[t].value;return n}for(const e in t)n[e]=t[e];return n}.bind(null,e))}return e}const V="void main() {}",H=`#version 300 es\n${V}`;function X(e,t){t=Array.isArray(t)?t:[t];const n=e.replace(/^\s+/,"").split(/\s+/),[r,i,o]=n;return t.includes(r)&&i&&o?{qualifier:r,type:i,name:o.split(";")[0]}:null}function $({version:e=100,input:t,inputType:n,output:r}={}){if(!t)return 300===e?H:V;Y(t,n)}function z(e){switch(e){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return N()(!1),null}}function W(e){switch(e){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return N()(!1),null}}function Y(e,t){switch(t){case"float":return`vec4(${e}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${e}, 0.0, 1.0)`;case"vec3":return`vec4(${e}, 1.0)`;case"vec4":return e;default:return N()(!1),null}}var K={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n\n// All these functions are for substituting tan() function from Intel GPU only\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n\n    // 2pi range reduction\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 0.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 0.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null};function q(e,t=[],n=0){const r=Math.fround(e),i=e-r;return t[n]=r,t[n+1]=i,t}var Q="uniform float ONE;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some 'equivalent' from.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n";const Z=`${Q}\nconst vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);\nconst vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);\nconst vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);\nconst vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);\nconst vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);\nconst vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);\nconst vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);\nconst vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);\nconst vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);\nconst vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);\n\nconst vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);\nconst vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);\nconst vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);\nconst vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);\n\nconst vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);\nconst vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);\nconst vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);\nconst vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);\n\nconst vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09); // 1/3!\nconst vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09); // 1/4!\nconst vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10); // 1/5!\nconst vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11); // 1/6!\nconst vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12); // 1/7!\nconst vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13); // 1/8!\nconst vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14); // 1/9!\nconst vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15); // 1/10!\n\nfloat nint(float d) {\n    if (d == floor(d)) return d;\n    return floor(d + 0.5);\n}\n\nvec2 nint_fp64(vec2 a) {\n    float hi = nint(a.x);\n    float lo;\n    vec2 tmp;\n    if (hi == a.x) {\n        lo = nint(a.y);\n        tmp = quickTwoSum(hi, lo);\n    } else {\n        lo = 0.0;\n        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {\n            hi -= 1.0;\n        }\n        tmp = vec2(hi, lo);\n    }\n    return tmp;\n}\n\n/* k_power controls how much range reduction we would like to have\nRange reduction uses the following method:\nassume a = k_power * r + m * log(2), k and m being integers.\nSet k_power = 4 (we can choose other k to trade accuracy with performance.\nwe only need to calculate exp(r) and using exp(a) = 2^m * exp(r)^k_power;\n*/\n\nvec2 exp_fp64(vec2 a) {\n  // We need to make sure these two numbers match\n  // as bit-wise shift is not available in GLSL 1.0\n  const int k_power = 4;\n  const float k = 16.0;\n\n  const float inv_k = 1.0 / k;\n\n  if (a.x <= -88.0) return vec2(0.0, 0.0);\n  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);\n  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);\n  if (a.x == 1.0 && a.y == 0.0) return E_FP64;\n\n  float m = floor(a.x / LOG2_FP64.x + 0.5);\n  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;\n  vec2 s, t, p;\n\n  p = mul_fp64(r, r);\n  s = sum_fp64(r, p * 0.5);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);\n\n  // s = sum_fp64(s, t);\n  // p = mul_fp64(p, r);\n  // t = mul_fp64(p, INVERSE_FACTORIAL_6_FP64);\n\n  // s = sum_fp64(s, t);\n  // p = mul_fp64(p, r);\n  // t = mul_fp64(p, INVERSE_FACTORIAL_7_FP64);\n\n  s = sum_fp64(s, t);\n\n\n  // At this point, s = exp(r) - 1; but after following 4 recursions, we will get exp(r) ^ 512 - 1.\n  for (int i = 0; i < k_power; i++) {\n    s = sum_fp64(s * 2.0, mul_fp64(s, s));\n  }\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = sum_fp64(s, vec2(ONE, 0.0));\n#else\n  s = sum_fp64(s, vec2(1.0, 0.0));\n#endif\n\n  return s * pow(2.0, m);\n//   return r;\n}\n\nvec2 log_fp64(vec2 a)\n{\n  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n  vec2 x = vec2(log(a.x), 0.0);\n  vec2 s;\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = vec2(ONE, 0.0);\n#else\n  s = vec2(1.0, 0.0);\n#endif\n\n  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);\n  return x;\n}\n\nvec2 sin_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(0.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  s = a;\n  r = a;\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);\n  s = sum_fp64(s, t);\n\n  /* keep the following commented code in case we need them\n  for extra accuracy from the Taylor expansion*/\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_7_FP64);\n  // s = sum_fp64(s, t);\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_9_FP64);\n  // s = sum_fp64(s, t);\n\n  return s;\n}\n\nvec2 cos_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(1.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  r = x;\n  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);\n  s = sum_fp64(s, t);\n\n  /* keep the following commented code in case we need them\n  for extra accuracy from the Taylor expansion*/\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_8_FP64);\n  // s = sum_fp64(s, t);\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_10_FP64);\n  // s = sum_fp64(s, t);\n\n  return s;\n}\n\nvoid sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {\n  if (a.x == 0.0 && a.y == 0.0) {\n    sin_t = vec2(0.0, 0.0);\n    cos_t = vec2(1.0, 0.0);\n  }\n\n  sin_t = sin_taylor_fp64(a);\n  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));\n}\n\nvec2 sin_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n\n    // 2pi range reduction\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return sin_taylor_fp64(t);\n        } else if (j == 1) {\n            return cos_taylor_fp64(t);\n        } else if (j == -1) {\n            return -cos_taylor_fp64(t);\n        } else {\n            return -sin_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 cos_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(1.0, 0.0);\n    }\n\n    // 2pi range reduction\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return cos_taylor_fp64(t);\n        } else if (j == 1) {\n            return -sin_taylor_fp64(t);\n        } else if (j == -1) {\n            return sin_taylor_fp64(t);\n        } else {\n            return -cos_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 tan_fp64(vec2 a) {\n    vec2 sin_a;\n    vec2 cos_a;\n\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n\n    // 2pi range reduction\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    // We just can't get PI/16 * 3.0 very accurately.\n    // so let's just store it\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n    vec2 sin_t, cos_t;\n    vec2 s, c;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#else\n        if (abs_k == 1) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs_k == 2) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs_k == 3) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs_k == 4) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#endif\n        if (k > 0) {\n            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return div_fp64(sin_a, cos_a);\n}\n\nvec2 radians_fp64(vec2 degree) {\n  return mul_fp64(degree, PI_180_FP64);\n}\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\n// Vector functions\n// vec2 functions\nvoid vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sum_fp64(a[0], b[0]);\n    out_val[1] = sum_fp64(a[1], b[1]);\n}\n\nvoid vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sub_fp64(a[0], b[0]);\n    out_val[1] = sub_fp64(a[1], b[1]);\n}\n\nvoid vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = mul_fp64(a[0], b[0]);\n    out_val[1] = mul_fp64(a[1], b[1]);\n}\n\nvoid vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = div_fp64(a[0], b[0]);\n    out_val[1] = div_fp64(a[1], b[1]);\n}\n\nvoid vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {\n  vec2 range[2];\n  vec2_sub_fp64(y, x, range);\n  vec2 portion[2];\n  portion[0] = range[0] * a;\n  portion[1] = range[1] * a;\n  vec2_sum_fp64(x, portion, out_val);\n}\n\nvec2 vec2_length_fp64(vec2 x[2]) {\n  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));\n}\n\nvoid vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {\n  vec2 length = vec2_length_fp64(x);\n  vec2 length_vec2[2];\n  length_vec2[0] = length;\n  length_vec2[1] = length;\n\n  vec2_div_fp64(x, length_vec2, out_val);\n}\n\nvec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {\n  vec2 diff[2];\n  vec2_sub_fp64(x, y, diff);\n  return vec2_length_fp64(diff);\n}\n\nvec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {\n  vec2 v[2];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n\n  return sum_fp64(v[0], v[1]);\n}\n\n// vec3 functions\nvoid vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvec2 vec3_length_fp64(vec2 x[3]) {\n  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),\n    mul_fp64(x[2], x[2])));\n}\n\nvec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {\n  vec2 diff[3];\n  vec3_sub_fp64(x, y, diff);\n  return vec3_length_fp64(diff);\n}\n\n// vec4 functions\nvoid vec4_fp64(vec4 a, out vec2 out_val[4]) {\n  out_val[0].x = a[0];\n  out_val[0].y = 0.0;\n\n  out_val[1].x = a[1];\n  out_val[1].y = 0.0;\n\n  out_val[2].x = a[2];\n  out_val[2].y = 0.0;\n\n  out_val[3].x = a[3];\n  out_val[3].y = 0.0;\n}\n\nvoid vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {\n  out_val[0] = mul_fp64(a[0], b);\n  out_val[1] = mul_fp64(a[1], b);\n  out_val[2] = mul_fp64(a[2], b);\n  out_val[3] = mul_fp64(a[3], b);\n}\n\nvoid vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {\n  for (int i = 0; i < 4; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {\n  vec2 v[4];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n  v[2] = mul_fp64(a[2], b[2]);\n  v[3] = mul_fp64(a[3], b[3]);\n\n  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));\n}\n\nvoid mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {\n  vec2 tmp[4];\n\n  for (int i = 0; i < 4; i++)\n  {\n    for (int j = 0; j < 4; j++)\n    {\n      tmp[j] = b[j + i * 4];\n    }\n    vec4_dot_fp64(a, tmp, out_val[i]);\n  }\n}\n`,J={ONE:1};var ee={name:"fp64",vs:Z,fs:null,fp64ify:q,fp64LowPart:function(e){return e-Math.fround(e)},fp64ifyMatrix4:function(e){const t=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=4*n+r;q(e[4*r+n],t,2*i)}return t},getUniforms:function(){return Object.assign({},J)}};var te=n(4);const ne=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],re={modelMatrix:ne,viewMatrix:ne,projectionMatrix:ne,cameraPositionWorld:[0,0,0]};const ie="varying vec4 project_vPositionWorld;\nvarying vec3 project_vNormalWorld;\n\nvec4 project_getPosition_World() {\n  return project_vPositionWorld;\n}\n\nvec3 project_getNormal_World() {\n  return project_vNormalWorld;\n}\n";var oe={name:"project",getUniforms:function(e=re,t={}){const n={};return void 0!==e.modelMatrix&&(n.modelMatrix=e.modelMatrix),void 0!==e.viewMatrix&&(n.viewMatrix=e.viewMatrix),void 0!==e.projectionMatrix&&(n.projectionMatrix=e.projectionMatrix),void 0!==e.cameraPositionWorld&&(n.cameraPositionWorld=e.cameraPositionWorld),void 0===e.projectionMatrix&&void 0===e.viewMatrix||(n.viewProjectionMatrix=new te.Matrix4(e.projectionMatrix).multiplyRight(e.viewMatrix)),n},vs:`${ie}\n\n// Unprefixed uniforms\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewProjectionMatrix;\nuniform vec3 cameraPositionWorld;\n\nstruct World {\n  vec3 position;\n  vec3 normal;\n};\n\nWorld world;\n\nvoid project_setPosition(vec4 position) {\n  project_vPositionWorld = position;\n}\n\nvoid project_setNormal(vec3 normal) {\n  project_vNormalWorld = normal;\n}\n\nvoid project_setPositionAndNormal_World(vec3 position, vec3 normal) {\n  world.position = position;\n  world.normal = normal;\n}\n\nvoid project_setPositionAndNormal_Model(vec3 position, vec3 normal) {\n  world.position = (modelMatrix * vec4(position, 1.)).xyz;\n  world.normal = mat3(modelMatrix) * normal;\n}\n\nvec4 project_model_to_clipspace(vec4 position) {\n  return viewProjectionMatrix * modelMatrix * position;\n}\n\nvec4 project_model_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * modelMatrix * vec4(position, 1.);\n}\n\nvec4 project_world_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_view_to_clipspace(vec3 position) {\n  return projectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n`,fs:`\n${ie}`};var se={name:"lighting",vs:"  // empty\n\n#define LIGHT_MAX 4\n\n/*\n// lighting configuration\nuniform bool enableLights;\nuniform vec3 ambientColor;\nuniform vec3 directionalColor;\nuniform vec3 lightingDirection;\n\n// point lights configuration\nuniform vec3 pointLocation[LIGHT_MAX];\nuniform vec3 pointColor[LIGHT_MAX];\nuniform int numberPoints;\n\n// reflection / refraction configuration\nuniform bool useReflection;\n*/\n\nuniform bool lighting_uEnableLights;\nuniform vec3 lighting_uAmbientColor;\nuniform vec3 lighting_uDirection;\nuniform vec3 lighting_uDirectionalColor;\n\n// point lights configuration\nuniform int  lighting_uPointCount;\nuniform vec3 lighting_uPointLocation[LIGHT_MAX];\nuniform vec3 lighting_uPointColor[LIGHT_MAX];\n\n// reflection / refraction configuration\nuniform bool lighting_uEnableReflections;\n\n// varyings\nvarying vec4 lighting_vPosition;\nvarying vec4 lighting_vNormal;\nvarying vec3 lighting_vColor;\nvarying vec3 lighting_vLightWeighting;\nvarying vec3 lighting_vReflection;\n\nvoid lighting_setPositionAndNormal(vec3 position, vec3 normal) {\n  lighting_vPosition = worldMatrix * vec4(position, 1.);\n  lighting_vNormal = worldInverseTransposeMatrix * vec4(normal, 1.);;\n}\n\nvoid lighting__getLightWeigting() {\n  float directionalLightWeighting = max(dot(lighting_vNormal.xyz, lighting_uDirection), 0.);\n  vec3 pointWeight = vec3(0., 0., 0.);\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec4 mvLightPosition = viewMatrix * vec4(lighting_uPointLocation[i], 1.);\n      vec3 pointLightDirection = normalize(mvLightPosition.xyz - lighting_vPosition.xyz);\n      pointWeight += max(dot(lighting_vNormal.xyz, pointLightDirection), 0.) * pointColor[i];\n     } else {\n       break;\n     }\n   }\n   return ambientColor + (directionalColor * directionalLightWeighting) + pointWeight;\n}\n\nvoid lighting_apply(vec3 position, vec3 normal) {\n  lighting_setPositionAndNormal(position, normal);\n\n  // lighting code\n  if(!lighting_uEnableLights) {\n    lighting_vLightWeighting = vec3(1., 1., 1.);\n  } else {\n    lighting_vLightWeighting = lighting__getLightWeighting();\n  }\n}\n\nvoid lighting_set_reflection(vec3 position) {\n    // refraction / reflection code\n  if (lighting_uEnableReflections) {\n    lighting_vReflection = (viewInverseMatrix[3] - (worldMatrix * vec4(position, 1.))).xyz;\n  } else {\n    lighting_vReflection = vec3(1., 1., 1.);\n  }\n}\n\n",fs:"  // empty\n\nprecision highp float;\n\n#define LIGHT_MAX 4\n\nvarying vec3 lighting_vLightWeighting;\n\nvec4 lighting_apply(vec4 color) {\n  // set color from texture\n  return vec4(color.rgb * lighting_vLightWeighting, color.a);\n}\n\n// spec-map.fs\n\nuniform mat4 viewMatrix;\n\n\nvarying vec4 lighting_vColor;\nvarying vec4 lighting_vTransformedNormal;\nvarying vec4 lighting_vPosition;\n\nuniform float shininess;\nuniform bool enableSpecularMap;\nuniform bool enableLights;\n\nuniform vec3 ambientColor;\nuniform vec3 directionalColor;\nuniform vec3 lightingDirection;\n\nuniform vec3 lighting_uPointLocation[LIGHT_MAX];\nuniform vec3 lighting_uPointColor[LIGHT_MAX];\nuniform float lighting_uPointSpecularEnable[LIGHT_MAX];\nuniform vec3 lighting_uPointSpecularColor[LIGHT_MAX];\nuniform int numberPoints;\n\n\nvec3 lighting__calculate_light_weighting() {\n\treturn lighting__calculate_light_weighting(shininess);\n}\n\nvec3 lighting__calculate_light_weighting(shininess) {\n  vec3 normal = vTransformedNormal.xyz;\n  vec3 eyeDirection = normalize(-vPosition.xyz);\n\n  vec3 specularLight = vec3(0., 0., 0.);\n  vec3 diffuseLight = vec3(0., 0., 0.);\n\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec3 transformedPointLocation = (viewMatrix * vec4(lighting_uPointLocation[i], 1.0)).xyz;\n      vec3 lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n      if (lighting_uPointSpecularEnable > 0.) {\n        vec3 reflectionDirection = reflect(-lightDirection, normal);\n        float specularLightWeighting =\n          pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininessVal);\n        specularLight += specularLightWeighting * lighting_uPointSpecularColor[i];\n      }\n\n      float diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n      diffuseLight += diffuseLightWeighting * lighting_uPointColor[i];\n    } else {\n      break;\n    }\n  }\n\n  return ambientColor + diffuseLight + specularLight;\n}\n\nvoid lighting_filterColor(fragmentColor) {\n  if (!lighting_enable) {\n  \treturn fragmentColor;\n  } else {\n  \tvec3 lightWeighting = lighting__calculate_light_weighting();\n  \treturn vec4(fragmentColor.rgb * lightWeighting, fragmentColor.a);\n  }\n}\n\n// render-tex.fs\n\nuniform vec3 material_uAmbientColor;\nuniform vec3 material_uDiffuseColor;\nuniform vec3 material_uSpecularColor;\nuniform vec3 material_uEmissiveColor;\n\nuniform bool hasTexture1;\nuniform sampler2D sampler1;\n\nuniform mat4 viewMatrix;\n\nvoid apply_lighting(color) {\n  vec3 ambientLightWeighting = ambientColor;\n\n  vec3 normal = vTransformedNormal.xyz;\n  vec3 eyeDirection = normalize(-vPosition.xyz);\n\n  vec3 specularLight = vec3(0.0, 0.0, 0.0);\n  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec3 transformedPointLocation = (viewMatrix * vec4(pointLocation[i], 1.0)).xyz;\n      vec3 lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n      if (enableSpecularHighlights) {\n        vec3 reflectionDirection = reflect(-lightDirection, normal);\n        float specularLightWeighting =\n          pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);\n        specularLight += specularLightWeighting * pointSpecularColor[i];\n      }\n\n      float diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n      diffuseLight += diffuseLightWeighting * pointColor[i];\n    } else {\n        break;\n    }\n  }\n\n  vec3 matAmbientColor = material_uAmbientColor * color.rgb;\n  vec3 matDiffuseColor = material_uDiffuseColor * color.rgb;\n  vec3 matSpecularColor = material_uSpecularColor * color.rgb;\n  vec3 matEmissiveColor = material_uEmissiveColor * color.rgb;\n  gl_FragColor = vec4(\n    matAmbientColor * ambientLightWeighting\n    + matDiffuseColor * diffuseLightWeighting\n    + matSpecularColor * specularLightWeighting\n    + matEmissiveColor,\n    color.a\n  );\n}\n\n/// frag-lighting\n\n  vec3 lightWeighting;\n  if (!enableLights) {\n    lightWeighting = vec3(1.0, 1.0, 1.0);\n  } else {\n    vec3 lightDirection;\n    float specularLightWeighting = 0.0;\n    float diffuseLightWeighting = 0.0;\n    vec3  specularLight = vec3(0.0, 0.0, 0.0);\n    vec3  diffuseLight = vec3(0.0, 0.0, 0.0);\n\n    vec3 transformedPointLocation;\n    vec3 normal = vTransformedNormal.xyz;\n\n    vec3 eyeDirection = normalize(-vPosition.xyz);\n    vec3 reflectionDirection;\n\n    vec3 pointWeight = vec3(0.0, 0.0, 0.0);\n\n    for (int i = 0; i < LIGHT_MAX; i++) {\n      if (i < numberPoints) {\n        transformedPointLocation = (viewMatrix * vec4(pointLocation[i], 1.0)).xyz;\n        lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n        if (enableSpecular[i] > 0.0) {\n          reflectionDirection = reflect(-lightDirection, normal);\n          specularLightWeighting = pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);\n          specularLight += specularLightWeighting * pointSpecularColor[i];\n        }\n\n        diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n        diffuseLight += diffuseLightWeighting * pointColor[i];\n      } else {\n        break;\n      }\n    }\n\n    lightWeighting = ambientColor + diffuseLight + specularLight;\n  }\n\n// reflection / refraction configs\nuniform float reflection;\nuniform float refraction;\n\n///\n  // has cube texture then apply reflection\n  // if (hasTextureCube1) {\n  //   vec3 nReflection = normalize(vReflection);\n  //   vec3 reflectionValue;\n  //   if (refraction > 0.0) {\n  //    reflectionValue = refract(nReflection, vNormal.xyz, refraction);\n  //   } else {\n  //    reflectionValue = -reflect(nReflection, vNormal.xyz);\n  //   }\n\n  //   // TODO(nico): check whether this is right.\n  //   vec4 cubeColor = textureCube(samplerCube1,\n  //       vec3(-reflectionValue.x, -reflectionValue.y, reflectionValue.z));\n  //   gl_FragColor = vec4(mix(gl_FragColor.xyz, cubeColor.xyz, reflection), 1.0);\n  // }\n\n",getUniforms:function({lightingEnable:e=!1,lightingAmbientColor:t=[.2,.2,.2],lightingDirection:n=[1,1,1],lightingDirectionalColor:r=[0,0,0],lightingPointLights:i=[]}){return Object.assign({lightingEnable:e,lightingAmbientColor:t},function({color:e,direction:t}){const n=new te.Vector3(t.x,t.y,t.z).normalize().scale(-1,-1,-1);return{directionalColor:[e.r,e.g,e.b],lightingDirection:[n.x,n.y,n.z]}}(n),function(e){const t=(e=e instanceof Array?e:[e]).length,n=[],r=[],i=[],o=[];for(const t of e){const{position:e,color:s,diffuse:a,specular:u}=t,c=s||a;n.push(e.x,e.y,e.z),r.push(c.r,c.g,c.b),i.push(Number(Boolean(u))),u?o.push(u.r,u.g,u.b):o.push(0,0,0)}return{numberPoints:t,pointLocation:n,pointColor:r,enableSpecular:i,pointSpecularColor:o}}(i))}};const ae={lightDirection:new Float32Array([1,1,2])};var ue={name:"dirlight",vs:null,fs:"uniform vec3 dirlight_uLightDirection;\n\n/*\n * Returns color attenuated by angle from light source\n */\nvec4 dirlight_filterColor(vec4 color) {\n  vec3 normal = project_getNormal_World();\n  float d = abs(dot(normalize(normal), normalize(dirlight_uLightDirection)));\n  return vec4(color.rgb * d, color.a);\n}\n",getUniforms:function(e=ae){const t={};return e.lightDirection&&(t.dirlight_uLightDirection=e.lightDirection),t},dependencies:[oe]};const ce={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingThreshold:1,pickingActive:!1};var le={name:"picking",vs:"uniform vec3 picking_uSelectedColor;\nuniform float picking_uThreshold;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Aselected;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    abs(vertexColor.r - picking_uSelectedColor.r) < picking_uThreshold &&\n    abs(vertexColor.g - picking_uSelectedColor.g) < picking_uThreshold &&\n    abs(vertexColor.b - picking_uSelectedColor.b) < picking_uThreshold;\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  // Do the comparison with selected item color in vertex shader as it should mean fewer compares\n  picking_vRGBcolor_Aselected.a =\n    float(isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  picking_vRGBcolor_Aselected.rgb = pickingColor * COLOR_SCALE;\n}\n",fs:"uniform bool picking_uActive; // true during rendering to offscreen picking buffer\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Aselected;\n\nconst float COLOR_SCALE = 1. / 255.;\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 picking_filterHighlightColor(vec4 color) {\n  bool selected = bool(picking_vRGBcolor_Aselected.a);\n\n  if (selected) {\n    vec4 highLightColor = picking_uHighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 picking_filterPickingColor(vec4 color) {\n  vec3 pickingColor = picking_vRGBcolor_Aselected.rgb;\n  if (picking_uActive && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return picking_uActive ? vec4(pickingColor, 1.0) : color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(e=ce){const t={};if(void 0!==e.pickingSelectedColor)if(null===e.pickingSelectedColor)t.picking_uSelectedColorValid=0;else{const n=[e.pickingSelectedColor[0],e.pickingSelectedColor[1],e.pickingSelectedColor[2]];t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=n}return void 0!==e.pickingHighlightColor&&(t.picking_uHighlightColor=e.pickingHighlightColor),void 0!==e.pickingThreshold&&(t.picking_uThreshold=e.pickingThreshold),void 0!==e.pickingActive&&(t.picking_uActive=e.pickingActive?1:0),t}};const fe={diffuseTexture:null,diffuseColor:[.5,.5,.5,1]};var he={name:"diffuse",getUniforms:function(e=fe){const t={};return void 0!==e.diffuseTexture&&(t.diffuse_uHasTexture=Boolean(e.diffuseTexture),t.diffuse_uTexture=e.diffuseTexture),void 0!==e.diffuseColor&&(t.diffuse_uColor=e.diffuseColor),t},vs:"out vec2 diffuse_vTexCoord;\n\n/* Set the UV coordinate from attributes */\nvoid diffuse_setTextureCoordinate(vec2 uv) {\n  diffuse_vTexCoord = uv;\n}\n",fs:"uniform vec4 diffuse_uColor;\nuniform bool diffuse_uHasTexture;\nuniform sampler2D diffuse_uTexture;\n\nin vec2 diffuse_vTexCoord;\n\n// Gets diffuse color of material from uniform\n// If we have a standard (diffuse) texture, set color to texture\n// return (vec4) - rgba\n//\nvec4 diffuse_getColor() {\n  vec2 texCoord = diffuse_vTexCoord;\n  return diffuse_uHasTexture ?\n    texture2D(diffuse_uTexture, vec2(texCoord.s, texCoord.t)) :\n    diffuse_uColor;\n}\n\nvec4 diffuse_filterColor(vec4 color) {\n  return diffuse_getColor();\n}\n"},de={name:"lighting",vs:"#define MAX_LIGHTS 5\n\nstruct AmbientLight {\n vec3 color;\n float intensity;\n};\n\nstruct PointLight {\n vec3 color;\n float intensity;\n vec3 position;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  float intensity;\n  vec3 direction;\n};\n \nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nuniform bool lighting_uEnabled;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, float intensity) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * intensity;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.intensity;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.intensity);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.intensity);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.intensity);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.intensity);\n    }\n  }\n  return lightColor;\n}\n",getUniforms:function(e=pe){if(!("lightSources"in e&&"material"in e))return{};const{ambientLight:t,pointLights:n,directionalLights:r}=e.lightSources,{material:i}=e;if(!(t||n&&n.length>0||r&&r.length>0)||!i)return{lighting_uEnabled:!1};return Object.assign({},function({ambientLight:e,pointLights:t,directionalLights:n}){const r={};e?(r["lighting_uAmbientLight.color"]=e.color,r["lighting_uAmbientLight.intensity"]=e.intensity):(r["lighting_uAmbientLight.color"]=[0,0,0],r["lighting_uAmbientLight.intensity"]=0);let i=0;for(const e in t){const n=t[e];r[`lighting_uPointLight[${i}].color`]=n.color,r[`lighting_uPointLight[${i}].intensity`]=n.intensity,r[`lighting_uPointLight[${i}].position`]=n.position,i++}r.lighting_uPointLightCount=t.length,i=0;for(const e in n){const t=n[e];r[`lighting_uDirectionalLight[${i}].color`]=t.color,r[`lighting_uDirectionalLight[${i}].intensity`]=t.intensity,r[`lighting_uDirectionalLight[${i}].direction`]=t.direction,i++}return r.lighting_uDirectionalLightCount=n.length,r}({ambientLight:t,pointLights:n,directionalLights:r}),function(e){const t={};return t.lighting_uAmbient=e.ambient,t.lighting_uDiffuse=e.diffuse,t.lighting_uShininess=e.shininess,t.lighting_uSpecularColor=e.specularColor,t}(i),{lighting_uEnabled:!0})}};const pe={};var _e="uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n",ge={name:"pbr",vs:"varying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else // HAS_TANGENTS != 1\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#extension GL_EXT_shader_texture_lod: enable\n#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n\nuniform vec3 u_LightDirection;\nuniform vec3 u_LightColor;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n\n// debugging flags used for shader output of intermediate PBR variables\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n// Encapsulate the various inputs used by the various functions in the shading equation\n// We store values in this struct to simplify the integration of alternative implementations\n// of the shading terms, outlined in the Readme.MD Appendix.\nstruct PBRInfo\n{\n  float NdotL;                  // cos angle between normal and light direction\n  float NdotV;                  // cos angle between normal and view direction\n  float NdotH;                  // cos angle between normal and half vector\n  float LdotH;                  // cos angle between light direction and half vector\n  float VdotH;                  // cos angle between view direction and half vector\n  float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\n  float metalness;              // metallic value at the surface\n  vec3 reflectance0;            // full reflectance color (normal incidence angle)\n  vec3 reflectance90;           // reflectance color at grazing angle\n  float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\n  vec3 diffuseColor;            // color contribution from diffuse lighting\n  vec3 specularColor;           // color contribution from specular lighting\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else //SRGB_FAST_APPROXIMATION\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif //SRGB_FAST_APPROXIMATION\n  return vec4(linOut,srgbIn.w);;\n#else //MANUAL_SRGB\n  return srgbIn;\n#endif //MANUAL_SRGB\n}\n\n// Find the normal for this fragment, pulling either from a predefined normal map\n// or from the interpolated mesh normal and tangent attributes.\nvec3 getNormal()\n{\n  // Retrieve the tangent space matrix\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else // HAS_TANGENTS\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  // The tbn matrix is linearly interpolated, so we need to re-normalize\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n// Calculation of the lighting contribution from an optional Image Based Light source.\n// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].\n// See our README.md on Environment Maps [3] for additional discussion.\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0; // resolution of 512x512\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  // retrieve a scale and bias to F0. See [1], Figure 3\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLodEXT(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n\n  // For presentation, this allows us to disable IBL terms\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n// Basic Lambertian diffuse\n// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\n// See also [1], Equation 1\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\n// Implementation of fresnel from [4], Equation 15\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n// This calculates the specular geometric attenuation (aka G()),\n// where rougher material will reflect less light back to the viewer.\n// This implementation is based on [1] Equation 4, and we adopt their modifications to\n// alphaRoughness as input as originally proposed in [2].\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n// The following equation(s) model the distribution of microfacet normals across\n// the area being drawn (aka D())\n// Implementation from \"Average Irregularity Representation of a Roughened Surface\n// for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes\n// from EPIC Games [1], Equation 3.\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n  // Metallic and Roughness material properties are packed together\n  // In glTF, these factors can be specified by fixed scalar values\n  // or from a metallic-roughness map\n  float perceptualRoughness = u_MetallicRoughnessValues.y;\n  float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n  // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\n  // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\n  vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n  perceptualRoughness = mrSample.g * perceptualRoughness;\n  metallic = mrSample.b * metallic;\n#endif\n  perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n  metallic = clamp(metallic, 0.0, 1.0);\n  // Roughness is authored as perceptual roughness; as is convention,\n  // convert to material roughness by squaring the perceptual roughness [2].\n  float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n  // The albedo may be defined from a base texture or a flat color\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n  vec3 f0 = vec3(0.04);\n  vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n  diffuseColor *= 1.0 - metallic;\n  vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n\n  // Compute reflectance.\n  float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n  // For typical incident reflectance range (between 4% to 100%) set the grazing\n  // reflectance to 100% for typical fresnel effect.\n  // For very low reflectance range on highly diffuse objects (below 4%),\n  // incrementally reduce grazing reflecance to 0%.\n  float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n  vec3 specularEnvironmentR0 = specularColor.rgb;\n  vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n  vec3 n = getNormal();                             // normal at surface point\n  vec3 v = normalize(u_Camera - pbr_vPosition);        // Vector from surface point to camera\n  vec3 l = normalize(u_LightDirection);             // Vector from surface point to light\n  vec3 h = normalize(l+v);                          // Half vector between both l and v\n  vec3 reflection = -normalize(reflect(v, n));\n\n  float NdotL = clamp(dot(n, l), 0.001, 1.0);\n  float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n  float NdotH = clamp(dot(n, h), 0.0, 1.0);\n  float LdotH = clamp(dot(l, h), 0.0, 1.0);\n  float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n  PBRInfo pbrInputs = PBRInfo(\n    NdotL,\n    NdotV,\n    NdotH,\n    LdotH,\n    VdotH,\n    perceptualRoughness,\n    metallic,\n    specularEnvironmentR0,\n    specularEnvironmentR90,\n    alphaRoughness,\n    diffuseColor,\n    specularColor\n  );\n\n  // Calculate the shading terms for the microfacet specular shading model\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n\n  // Calculation of analytical lighting contribution\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\n  // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\n  vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\n\n  // Calculate lighting contribution from image based lighting source (IBL)\n#ifdef USE_IBL\n  color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n\n  // Apply optional PBR terms for additional (optional) shading\n#ifdef HAS_OCCLUSIONMAP\n  float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n  color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n  vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n  color += emissive;\n#endif\n\n  // This section uses mix to override final color for reference app visualization\n  // of various parameters in the lighting equation.\n#ifdef PBR_DEBUG\n  color = mix(color, F, u_ScaleFGDSpec.x);\n  color = mix(color, vec3(G), u_ScaleFGDSpec.y);\n  color = mix(color, vec3(D), u_ScaleFGDSpec.z);\n  color = mix(color, specContrib, u_ScaleFGDSpec.w);\n\n  color = mix(color, diffuseContrib, u_ScaleDiffBaseMR.x);\n  color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n  color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n  color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",dependencies:[{name:"project2",vs:_e,fs:_e}]};var me={name:"transform",vs:"attribute float transform_elementID;\n\n// returns half of pixel size, used to move the pixel position to center of the pixel.\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\n// returns current elements pixel indeces [x, y],\n// where x ranges in [0 to texSize-1] and y ranges in [0 to texSize-1]\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  // Add safe offset (half of pixel height) before doing floor\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\n\n// returns current elementID's texture co-ordianate\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\n\n// returns current elementID's position\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  // Change from [0 1] range to [-1 1]\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\n\n// returns current elementID's pixel value\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null};n.d(t,"MODULAR_SHADERS",function(){return Ee}),n.d(t,"registerShaderModules",function(){return l}),n.d(t,"setDefaultShaderModules",function(){return c}),n.d(t,"assembleShaders",function(){return B}),n.d(t,"combineInjects",function(){return O}),n.d(t,"normalizeShaderModule",function(){return j}),n.d(t,"getQualifierDetails",function(){return X}),n.d(t,"getPassthroughFS",function(){return $}),n.d(t,"typeToChannelSuffix",function(){return z}),n.d(t,"typeToChannelCount",function(){return W}),n.d(t,"convertToVec4",function(){return Y}),n.d(t,"fp32",function(){return K}),n.d(t,"fp64",function(){return ee}),n.d(t,"project",function(){return oe}),n.d(t,"lighting",function(){return se}),n.d(t,"dirlight",function(){return ue}),n.d(t,"picking",function(){return le}),n.d(t,"diffuse",function(){return he}),n.d(t,"phonglighting",function(){return de}),n.d(t,"pbr",function(){return ge}),n.d(t,"_transform",function(){return me});const Ee={vs:"#define SHADER_NAME luma_modular_vertex\n\n// object attributes\nattribute vec3 positions;\nattribute vec3 normals;\nattribute vec4 colors;\nattribute vec2 texCoords;\nattribute vec3 pickingColors;\n\nvoid main(void) {\n\n  // Set up position\n#ifdef MODULE_GEOMETRY\n  geometry_setPosition(positions);\n  geometry_setNormal(normals);\n#endif\n\n#ifdef MODULE_PROJECT\n  project_setPositionAndNormal_Model(positions, normals);\n  gl_Position = project_model_to_clipspace(positions);\n#endif\n\n  // Set up depth\n#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n\n#ifdef MODULE_DIFFUSE\n  diffuse_setTextureCoordinate(texCoords);\n#endif\n\n  // Set up color calculations\n#ifdef MODULE_MATERIAL\n  material_setDiffuseColor(colors);\n  material_setDiffuseTextureCoordinates(texCoords);\n#endif\n\n#ifdef MODULE_LIGHTING\n  lighting_setPositionAndNormal(positions, normals);\n  lighting_apply_light(positions);\n  lighting_apply_reflection(positions);\n#endif\n\n#ifdef MODULE_PICKING\n  picking_setPickingColor(pickingColors);\n#endif\n\n}\n",fs:"#define SHADER_NAME luma-modular-fragment\n\nprecision highp float;\n\n// varyings\nvarying vec4 vColor;\n\nvoid main(){\n  gl_FragColor = vec4(1., 0., 1., 1.);\n\n#ifdef MODULE_DIFFUSE\n  gl_FragColor = diffuse_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth(gl_Position);\n#endif\n}\n",defaultUniforms:{}}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",function(){return i})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";n.r(t);var r=n(3),i=n(2),o=n(10);function s(e,t){return!t||"object"!==Object(o.a)(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}var l={};function f(e){"epsilon"in e&&(l.EPSILON=e.epsilon),"debug"in e&&(l.debug=e.debug)}function h(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function d(e){return Math.round(e/l.EPSILON)*l.EPSILON}function p(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,n=void 0===t?l.precision||4:t;return e=d(e),parseFloat(e.toPrecision(n))}function _(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&void 0!==e.length}function g(e){return e.clone?e.clone():new Array(e)}function m(e,t){if(_(e)){for(var n=g(e),r=0;r<n.length;++r)n[r]=t(n[r],r,n);return n}return t(e)}function E(e){return m(e,function(e){return e/180*Math.PI})}function v(e){return m(e,function(e){return 180*e/Math.PI})}function y(e){return m(e,function(e){return Math.sin(e)})}function b(e){return m(e,function(e){return Math.cos(e)})}function A(e){return m(e,function(e){return Math.tan(e)})}function T(e){return m(e,function(e){return Math.asin(e)})}function R(e){return m(e,function(e){return Math.acos(e)})}function x(e){return m(e,function(e){return Math.atan(e)})}function S(e,t,n){return m(e,function(e){return Math.max(t,Math.min(n,e))})}function I(e,t,n){return _(e)?e.map(function(e,r){return I(e,t[r],n)}):n*t+(1-n)*e}function C(e,t){if(_(e)&&_(t)){if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!C(e[n],t[n]))return!1;return!0}return Math.abs(e-t)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}function N(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}l.EPSILON=1e-12,l.debug=!0,l.precision=4,l.printTypes=!1,l.printDegrees=!1,l.printRowMajor=!0;var w=function(e){function t(){return Object(r.a)(this,t),s(this,a(t).apply(this,arguments))}return c(t,N(Array)),Object(i.a)(t,[{key:"clone",value:function(){return(new this.constructor).copy(this).check()}},{key:"copy",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=e[t];return this.check()}},{key:"set",value:function(){for(var e=0;e<this.ELEMENTS;++e)this[e]=(e<0||arguments.length<=e?void 0:arguments[e])||0;return this.check()}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}},{key:"toString",value:function(){return this.formatString(l)}},{key:"formatString",value:function(e){for(var t="",n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+p(this[n],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"equals",value:function(e){if(!e||this.length!==e.length)return!1;for(var t=0;t<this.ELEMENTS;++t)if(!C(this[t],e[t]))return!1;return!0}},{key:"exactEquals",value:function(e){if(!e||this.length!==e.length)return!1;for(var t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}},{key:"negate",value:function(){for(var e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}},{key:"inverse",value:function(){for(var e=0;e<this.ELEMENTS;++e)this[e]=1/this[e];return this.check()}},{key:"lerp",value:function(e,t,n){void 0===n&&(n=t,t=e,e=this);for(var r=0;r<this.ELEMENTS;++r){var i=e[r];this[r]=i+n*(t[r]-i)}return this.check()}},{key:"min",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}},{key:"max",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}},{key:"clamp",value:function(e,t){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}},{key:"validate",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=e&&e.length===this.ELEMENTS,n=0;n<this.ELEMENTS;++n)t=t&&Number.isFinite(e[n]);return t}},{key:"check",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;if(l.debug&&!this.validate(e))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"sub",value:function(e){return this.subtract(e)}},{key:"setScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}},{key:"addScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}},{key:"subScalar",value:function(e){return this.addScalar(-e)}},{key:"multiplyScalar",value:function(e){return this.scale(e)}},{key:"divideScalar",value:function(e){return this.scale(1/e)}},{key:"clampScalar",value:function(e,t){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}}]),t}(),F=function(e,t){if(!e)throw new Error(t)},M=function(e){function t(){return Object(r.a)(this,t),s(this,a(t).apply(this,arguments))}return c(t,w),Object(i.a)(t,[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"lengthSquared",value:function(){for(var e=0,t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}},{key:"distance",value:function(e){return Math.sqrt(this.distanceSquared(e))}},{key:"distanceSquared",value:function(e){for(var t=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-e[n];t+=r*r}return h(t)}},{key:"dot",value:function(e){for(var t=0,n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return h(t)}},{key:"normalize",value:function(){var e=this.magnitude();if(0!==e)for(var t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++)for(var i=t[r],o=0;o<this.ELEMENTS;++o)this[o]+=i[o];return this.check()}},{key:"subtract",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++)for(var i=t[r],o=0;o<this.ELEMENTS;++o)this[o]-=i[o];return this.check()}},{key:"multiply",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++)for(var i=t[r],o=0;o<this.ELEMENTS;++o)this[o]*=i[o];return this.check()}},{key:"divide",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++)for(var i=t[r],o=0;o<this.ELEMENTS;++o)this[o]/=i[o];return this.check()}},{key:"scale",value:function(e){if(Array.isArray(e))return this.multiply(e);for(var t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}},{key:"scaleAndAdd",value:function(e,t){for(var n=0;n<this.ELEMENTS;++n)this[n]=this[n]*t+e[n];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(e){return this.distance(e)}},{key:"distanceToSquared",value:function(e){return this.distanceSquared(e)}},{key:"getComponent",value:function(e){return F(e>=0&&e<this.ELEMENTS,"index is out of range"),h(this[e])}},{key:"setComponent",value:function(e,t){return F(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}},{key:"addVectors",value:function(e,t){return this.copy(e).add(t)}},{key:"subVectors",value:function(e,t){return this.copy(e).subtract(t)}},{key:"multiplyVectors",value:function(e,t){return this.copy(e).multiply(t)}},{key:"addScaledVector",value:function(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}},{key:"x",get:function(){return this[0]},set:function(e){return this[0]=h(e)}},{key:"y",get:function(){return this[1]},set:function(e){return this[1]=h(e)}}]),t}(),O=n(64),L=n.n(O),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(r.a)(this,t),e=s(this,a(t).call(this)),Array.isArray(n)&&1===arguments.length?e.copy(n):e.set(n,i),e}return c(t,M),Object(i.a)(t,[{key:"cross",value:function(e){return L()(this,this,e),this.check()}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"operation",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),t}(),B=n(65),D=n.n(B),U=n(40),k=n.n(U),G=n(66),j=n.n(G),V=n(67),H=n.n(V),X=n(68),$=n.n(X),z=[0,0,0],W=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(r.a)(this,t),e=s(this,a(t).call(this)),Array.isArray(n)&&1===arguments.length?e.copy(n):e.set(n,i,o),e}return c(t,M),Object(i.a)(t,[{key:"angle",value:function(e){return D()(this,e)}},{key:"cross",value:function(e){return k()(this,this,e),this.check()}},{key:"rotateX",value:function(e){var t=e.radians,n=e.origin,r=void 0===n?z:n;return j()(this,this,r,t),this.check()}},{key:"rotateY",value:function(e){var t=e.radians,n=e.origin,r=void 0===n?z:n;return H()(this,this,r,t),this.check()}},{key:"rotateZ",value:function(e){var t=e.radians,n=e.origin,r=void 0===n?z:n;return $()(this,this,r,t),this.check()}},{key:"operation",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(e){return this[2]=h(e)}}]),t}(),Y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(r.a)(this,t),e=s(this,a(t).call(this)),Array.isArray(n)&&1===arguments.length?e.copy(n):e.set(n,i,o,u),e}return c(t,M),Object(i.a)(t,[{key:"applyMatrix4",value:function(e){return e.transformVector(this,this),this}},{key:"ELEMENTS",get:function(){return 4}},{key:"z",get:function(){return this[2]},set:function(e){return this[2]=h(e)}},{key:"w",get:function(){return this[3]},set:function(e){return this[3]=h(e)}}]),t}();function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var q=n(21),Q=n(69),Z=n.n(Q),J=n(70),ee=n.n(J),te=n(71),ne=n.n(te),re=n(72),ie=n.n(re),oe=n(73),se=n.n(oe),ae=n(74),ue=n.n(ae),ce=n(75),le=n.n(ce),fe=n(76),he=n.n(fe),de=n(45),pe=n.n(de),_e=n(77),ge=n.n(_e),me=n(78),Ee=n.n(me),ve=n(79),ye=n.n(ve),be=n(80),Ae=n.n(be),Te=n(81),Re=n.n(Te),xe=n(26),Se=n.n(xe),Ie=n(82),Ce=n.n(Ie),Ne=n(83),we=n.n(Ne),Fe=n(84),Me=n.n(Fe),Oe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function Le(e,t){return e.length===t&&e.every(Number.isFinite)}var Pe=function(e){function t(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Object(r.a)(this,t),e=s(this,a(t).call(this)),Array.isArray(i[0])&&1===arguments.length?e.copy(i[0]):e.identity(),e}return c(t,w),Object(i.a)(t,[{key:"setRowMajor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,d=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,_=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=e,this[1]=i,this[2]=u,this[3]=h,this[4]=t,this[5]=o,this[6]=c,this[7]=d,this[8]=n,this[9]=s,this[10]=l,this[11]=p,this[12]=r,this[13]=a,this[14]=f,this[15]=_,this.check()}},{key:"setColumnMajor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,d=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,_=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=u,this[9]=c,this[10]=l,this[11]=f,this[12]=h,this[13]=d,this[14]=p,this[15]=_,this.check()}},{key:"copy",value:function(e){return this.setColumnMajor.apply(this,Object(q.a)(e))}},{key:"set",value:function(){return this.setColumnMajor.apply(this,arguments)}},{key:"getElement",value:function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this[e][t]:this[t][e]}},{key:"setElement",value:function(e,t,n){return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?this[e][t]=h(n):this[t][e]=h(n),this}},{key:"determinant",value:function(){return Z()(this)}},{key:"identity",value:function(){return this.copy(Oe)}},{key:"fromQuaternion",value:function(e){return ee()(this,e),this.check()}},{key:"frustum",value:function(e){var t=e.left,n=e.right,r=e.bottom,i=e.top,o=e.near,s=e.far;return ne()(this,t,n,r,i,o,s),this.check()}},{key:"lookAt",value:function(e){var t=e.eye,n=e.center,r=void 0===n?[0,0,0]:n,i=e.up,o=void 0===i?[0,1,0]:i;return ie()(this,t,r,o),this.check()}},{key:"ortho",value:function(e){var t=e.left,n=e.right,r=e.bottom,i=e.top,o=e.near,s=void 0===o?.1:o,a=e.far,u=void 0===a?500:a;return se()(this,t,n,r,i,s,u),this.check()}},{key:"orthographic",value:function(e){var n=e.fovy,r=void 0===n?45*Math.PI/180:n,i=e.aspect,o=void 0===i?1:i,s=e.focalDistance,a=void 0===s?1:s,u=e.near,c=void 0===u?.1:u,l=e.far,f=void 0===l?500:l;if(r>2*Math.PI)throw Error("radians");var h=r/2,d=a*Math.tan(h),p=d*o;return(new t).ortho({left:-p,right:p,bottom:-d,top:d,near:c,far:f})}},{key:"perspective",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fovy,n=e.fov,r=void 0===n?45*Math.PI/180:n,i=e.aspect,o=void 0===i?1:i,s=e.near,a=void 0===s?.1:s,u=e.far,c=void 0===u?500:u;if((t=t||r)>2*Math.PI)throw Error("radians");return ue()(this,t,o,a,c),this.check()}},{key:"transpose",value:function(){return le()(this,this),this.check()}},{key:"invert",value:function(){return he()(this,this),this.check()}},{key:"multiplyLeft",value:function(e){return pe()(this,e,this),this.check()}},{key:"multiplyRight",value:function(e){return pe()(this,this,e),this.check()}},{key:"rotateX",value:function(e){return Ce()(this,this,e),this.check()}},{key:"rotateY",value:function(e){return we()(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return Me()(this,this,e),this.check()}},{key:"rotateXYZ",value:function(e){var t=K(e,3),n=t[0],r=t[1],i=t[2];return this.rotateX(n).rotateY(r).rotateZ(i)}},{key:"rotateAxis",value:function(e,t){return ge()(this,this,e,t),this.check()}},{key:"scale",value:function(e){return Ee()(this,this,e),this.check()}},{key:"translate",value:function(e){return ye()(this,this,e),this.check()}},{key:"transformVector2",value:function(e,t){return t=t||new P,Ae()(t,e,this),Le(t,2),t}},{key:"transformVector3",value:function(e,t){return t=t||new W,Re()(t,e,this),Le(t,3),t}},{key:"transformVector4",value:function(e,t){return t=t||new Y,Se()(t,e,this),Le(t,4),t.check()}},{key:"transformVector",value:function(e,t){switch(e.length){case 2:return this.transformVector2(e,t);case 3:return this.transformVector3(e,t);case 4:return this.transformVector4(e,t);default:throw new Error("Illegal vector")}}},{key:"transformDirection",value:function(e,t){return this._transformVector(e,t,0)}},{key:"transformPoint",value:function(e,t){return this._transformVector(e,t,1)}},{key:"_transformVector",value:function(e,t,n){switch(e.length){case 2:t=t||new P,Se()(t,[e[0],e[1],0,n],this),t.length=2,Le(t,2);break;case 3:t=t||new W,Se()(t,[e[0],e[1],e[2],n],this),t.length=3,Le(t,3);break;case 4:if(Boolean(n)!==Boolean(e[3]))throw new Error("math.gl: Matrix4.transformPoint - invalid vector");t=t||new Y,Se()(t,e,this),Le(t,4);break;default:throw new Error("Illegal vector")}return t}},{key:"makeRotationX",value:function(e){return this.identity().rotateX(e)}},{key:"makeTranslation",value:function(e,t,n){return this.identity().translate([e,t,n])}},{key:"ELEMENTS",get:function(){return 16}}]),t}(),Be=n(85),De=n.n(Be),Ue=n(86),ke=n.n(Ue),Ge=n(87),je=n.n(Ge),Ve=n(88),He=n.n(Ve),Xe=n(89),$e=n.n(Xe),ze=n(90),We=n.n(ze),Ye=n(91),Ke=n.n(Ye),qe=n(92),Qe=n.n(qe),Ze=n(93),Je=n.n(Ze),et=n(94),tt=n.n(et),nt=n(95),rt=n.n(nt),it=n(96),ot=n.n(it),st=n(42),at=n.n(st),ut=n(97),ct=n.n(ut),lt=n(98),ft=n.n(lt),ht=n(99),dt=n.n(ht),pt=n(100),_t=n.n(pt),gt=n(101),mt=n.n(gt),Et=n(43),vt=n.n(Et),yt=n(102),bt=n.n(yt),At=[0,0,0,1];var Tt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(r.a)(this,t),e=s(this,a(t).call(this)),Array.isArray(n)&&1===arguments.length?e.copy(n):e.set(n,i,o,u),e}return c(t,w),Object(i.a)(t,[{key:"fromMatrix3",value:function(e){return De()(this,e),this.check()}},{key:"fromValues",value:function(e,t,n,r){return this.set(e,t,n,r)}},{key:"identity",value:function(){return ke()(this),this.check()}},{key:"length",value:function(){return je()(this)}},{key:"squaredLength",value:function(e){return He()(this)}},{key:"dot",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return $e()(this,e)}},{key:"rotationTo",value:function(e,t){return We()(this,e,t),this.check()}},{key:"add",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return Ke()(this,e),this.check()}},{key:"calculateW",value:function(){return Qe()(this,this),this.check()}},{key:"conjugate",value:function(){return Je()(this,this),this.check()}},{key:"invert",value:function(){return tt()(this,this),this.check()}},{key:"lerp",value:function(e,t,n){return rt()(this,e,t,n),this.check()}},{key:"multiply",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.multiply only takes one argument");return ot()(this,this,t),this.check()}},{key:"normalize",value:function(){return at()(this,this),this.check()}},{key:"rotateX",value:function(e){return ct()(this,this,e),this.check()}},{key:"rotateY",value:function(e){return ft()(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return dt()(this,this,e),this.check()}},{key:"scale",value:function(e){return _t()(this,this,e),this.check()}},{key:"set",value:function(e,t,n,r){return mt()(this,e,t,n,r),this.check()}},{key:"setAxisAngle",value:function(e,t){return vt()(this,e,t),this.check()}},{key:"slerp",value:function(e){var t=e.start,n=void 0===t?At:t,r=e.target,i=e.ratio;return bt()(this,n,r,i),this.check()}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(e){return this[0]=h(e)}},{key:"y",get:function(){return this[1]},set:function(e){return this[1]=h(e)}},{key:"z",get:function(){return this[2]},set:function(e){return this[2]=h(e)}},{key:"w",get:function(){return this[3]},set:function(e){return this[3]=h(e)}}]),t}(),Rt=n(41),xt=n.n(Rt),St=6371e3,It=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.phi,i=t.theta,o=t.radius,s=t.bearing,a=t.pitch,u=(t.altitude,t.radiusScale),c=void 0===u?St:u;Object(r.a)(this,e),0===arguments.length?(this.phi=0,this.theta=0,this.radius=1):Number.isFinite(n)||Number.isFinite(i)?(this.phi=n||0,this.theta=i||0):(Number.isFinite(s)||Number.isFinite(a))&&(this.bearing=s||0,this.pitch=a||0),this.radius=o||1,this.radiusScale=c||1,this.check()}return Object(i.a)(e,[{key:"toString",value:function(){return this.formatString(l)}},{key:"formatString",value:function(e){var t=e.printTypes,n=(e.printDegrees,p);return"".concat(t?"Spherical":"","[rho:").concat(n(this.radius),",theta:").concat(n(this.theta),",phi:").concat(n(this.phi),"]")}},{key:"equals",value:function(e){return C(this.radius,e.radius)&&C(this.theta,e.theta)&&C(this.phi,e.phi)}},{key:"exactEquals",value:function(e){return this.radius===e.radius&&this.theta===e.theta&&this.phi===e.phi}},{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this.check()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this.check()}},{key:"fromLngLatZ",value:function(e){var t=K(e,3),n=t[0],r=t[1],i=t[2];this.radius=1+i/this.radiusScale,this.phi=E(r),this.theta=E(n)}},{key:"fromVector3",value:function(e){return this.radius=xt()(e),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e[0],e[1]),this.phi=Math.acos(S(e[2]/this.radius,-1,1))),this.check()}},{key:"toVector3",value:function(){return new W(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}},{key:"makeSafe",value:function(){this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi))}},{key:"check",value:function(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}},{key:"bearing",get:function(){return 180-v(this.phi)},set:function(e){this.phi=Math.PI-E(e)}},{key:"pitch",get:function(){return v(this.theta)},set:function(e){this.theta=E(e)}},{key:"longitude",get:function(){return v(this.phi)}},{key:"latitude",get:function(){return v(this.theta)}},{key:"lng",get:function(){return v(this.phi)}},{key:"lat",get:function(){return v(this.theta)}},{key:"z",get:function(){return(this.radius-1)*this.radiusScale}}]),e}(),Ct="Unknown Euler angle order";var Nt=function(e){function t(){var e,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.DefaultOrder;(Object(r.a)(this,t),e=s(this,a(t).call(this)),arguments.length>0&&Array.isArray(arguments[0]))?(n=e).fromVector3.apply(n,arguments):e.set(i,o,u,c);return e}return c(t,w),Object(i.a)(t,[{key:"ELEMENTS",get:function(){return 4}}],[{key:"rotationOrder",value:function(e){return t.RotationOrders[e]}},{key:"ZYX",get:function(){return 0}},{key:"YXZ",get:function(){return 1}},{key:"XZY",get:function(){return 2}},{key:"ZXY",get:function(){return 3}},{key:"YZX",get:function(){return 4}},{key:"XYZ",get:function(){return 5}},{key:"RollPitchYaw",get:function(){return 0}},{key:"DefaultOrder",get:function(){return t.ZYX}},{key:"RotationOrders",get:function(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}}]),Object(i.a)(t,[{key:"copy",value:function(e){for(var t=0;t<3;++t)this[t]=e[t];return this[3]=Number.isFinite(e[3])||this.order,this.check()}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;return this[0]=e,this[1]=t,this[2]=n,this[3]=Number.isFinite(r)?r:this[3],this.check()}},{key:"validate",value:function(){return function(e){return e>=0&&e<6}(this[3])&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2])}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}},{key:"toArray4",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e}},{key:"toVector3",value:function(e){return e?e.set(this[0],this[1],this[2]):new W(this[0],this[1],this[2])}},{key:"fromVector3",value:function(e,t){return this.set(e[0],e[1],e[2],Number.isFinite(t)?t:this[3])}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this[0]=e[0+t],this[1]=e[1+t],this[2]=e[2+t],void 0!==e[3]&&(this[3]=e[3]),this.check()}},{key:"fromRollPitchYaw",value:function(e,n,r){return this.set(e,n,r,t.ZYX)}},{key:"fromQuaternion",value:function(e,t){return this._fromRotationMatrix(Pe.fromQuaternion(e),t),this.check()}},{key:"fromRotationMatrix",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.DefaultOrder;return this._fromRotationMatrix(e,n),this.check()}},{key:"getRotationMatrix",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pe;return this._getRotationMatrix(e),e}},{key:"getQuaternion",value:function(){var e=new Tt;switch(this[4]){case t.XYZ:return e.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case t.YXZ:return e.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case t.ZXY:return e.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case t.ZYX:return e.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case t.YZX:return e.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case t.XZY:return e.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(Ct)}}},{key:"_fromRotationMatrix",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.DefaultOrder,r=e.elements,i=r[0],o=r[4],s=r[8],a=r[1],u=r[5],c=r[9],l=r[2],f=r[6],h=r[10];switch(n=n||this[3]){case t.XYZ:this[1]=Math.asin(S(s,-1,1)),Math.abs(s)<.99999?(this[0]=Math.atan2(-c,h),this[2]=Math.atan2(-o,i)):(this[0]=Math.atan2(f,u),this[2]=0);break;case t.YXZ:this[0]=Math.asin(-S(c,-1,1)),Math.abs(c)<.99999?(this[1]=Math.atan2(s,h),this[2]=Math.atan2(a,u)):(this[1]=Math.atan2(-l,i),this[2]=0);break;case t.ZXY:this[0]=Math.asin(S(f,-1,1)),Math.abs(f)<.99999?(this[1]=Math.atan2(-l,h),this[2]=Math.atan2(-o,u)):(this[1]=0,this[2]=Math.atan2(a,i));break;case t.ZYX:this[1]=Math.asin(-S(l,-1,1)),Math.abs(l)<.99999?(this[0]=Math.atan2(f,h),this[2]=Math.atan2(a,i)):(this[0]=0,this[2]=Math.atan2(-o,u));break;case t.YZX:this[2]=Math.asin(S(a,-1,1)),Math.abs(a)<.99999?(this[0]=Math.atan2(-c,u),this[1]=Math.atan2(-l,i)):(this[0]=0,this[1]=Math.atan2(s,h));break;case t.XZY:this[2]=Math.asin(-S(o,-1,1)),Math.abs(o)<.99999?(this[0]=Math.atan2(f,u),this[1]=Math.atan2(s,i)):(this[0]=Math.atan2(-c,h),this[1]=0);break;default:throw new Error(Ct)}return this[3]=n,this}},{key:"_getRotationMatrix",value:function(){var e=new Pe,n=this.x,r=this.y,i=this.z,o=Math.cos(n),s=Math.cos(r),a=Math.cos(i),u=Math.sin(n),c=Math.sin(r),l=Math.sin(i);switch(this[3]){case t.XYZ:var f=o*a,h=o*l,d=u*a,p=u*l;e[0]=s*a,e[4]=-s*l,e[8]=c,e[1]=h+d*c,e[5]=f-p*c,e[9]=-u*s,e[2]=p-f*c,e[6]=d+h*c,e[10]=o*s;break;case t.YXZ:var _=s*a,g=s*l,m=c*a,E=c*l;e[0]=_+E*u,e[4]=m*u-g,e[8]=o*c,e[1]=o*l,e[5]=o*a,e[9]=-u,e[2]=g*u-m,e[6]=E+_*u,e[10]=o*s;break;case t.ZXY:var v=s*a,y=s*l,b=c*a,A=c*l;e[0]=v-A*u,e[4]=-o*l,e[8]=b+y*u,e[1]=y+b*u,e[5]=o*a,e[9]=A-v*u,e[2]=-o*c,e[6]=u,e[10]=o*s;break;case t.ZYX:var T=o*a,R=o*l,x=u*a,S=u*l;e[0]=s*a,e[4]=x*c-R,e[8]=T*c+S,e[1]=s*l,e[5]=S*c+T,e[9]=R*c-x,e[2]=-c,e[6]=u*s,e[10]=o*s;break;case t.YZX:var I=o*s,C=o*c,N=u*s,w=u*c;e[0]=s*a,e[4]=w-I*l,e[8]=N*l+C,e[1]=l,e[5]=o*a,e[9]=-u*a,e[2]=-c*a,e[6]=C*l+N,e[10]=I-w*l;break;case t.XZY:var F=o*s,M=o*c,O=u*s,L=u*c;e[0]=s*a,e[4]=-l,e[8]=c*a,e[1]=F*l+L,e[5]=o*a,e[9]=M*l-O,e[2]=O*l-M,e[6]=u*a,e[10]=L*l+F;break;default:throw new Error(Ct)}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}},{key:"x",get:function(){return this[0]},set:function(e){return this[0]=h(e)}},{key:"y",get:function(){return this[1]},set:function(e){return this[1]=h(e)}},{key:"z",get:function(){return this[2]},set:function(e){return this[2]=h(e)}},{key:"alpha",get:function(){return this[0]},set:function(e){return this[0]=h(e)}},{key:"beta",get:function(){return this[1]},set:function(e){return this[1]=h(e)}},{key:"gamma",get:function(){return this[2]},set:function(e){return this[2]=h(e)}},{key:"phi",get:function(){return this[0]},set:function(e){return this[0]=h(e)}},{key:"theta",get:function(){return this[1]},set:function(e){return this[1]=h(e)}},{key:"psi",get:function(){return this[2]},set:function(e){return this[2]=h(e)}},{key:"roll",get:function(){return this[0]},set:function(e){return this[0]=h(e)}},{key:"pitch",get:function(){return this[1]},set:function(e){return this[1]=h(e)}},{key:"yaw",get:function(){return this[2]},set:function(e){return this[2]=h(e)}},{key:"order",get:function(){return this[3]},set:function(e){return this[3]=function(e){if(e<0&&e>=6)throw new Error(Ct);return e}(e)}}]),t}(),wt=function(){function e(t){var n=t.x,i=void 0===n?0:n,o=t.y,s=void 0===o?0:o,a=t.z,u=void 0===a?0:a,c=t.roll,l=void 0===c?0:c,f=t.pitch,h=void 0===f?0:f,d=t.yaw,p=void 0===d?0:d,_=t.position,g=t.orientation;Object(r.a)(this,e),Array.isArray(_)&&3===_.length?this.position=new W(_):this.position=new W(i,s,u),Array.isArray(g)&&4===g.length?this.orientation=new Nt(g,g[3]):this.orientation=new Nt(l,h,p,Nt.RollPitchYaw)}return Object(i.a)(e,[{key:"getPosition",value:function(){return this.position}},{key:"getOrientation",value:function(){return this.orientation}},{key:"equals",value:function(e){return!!e&&(this.position.equals(e.position)&&this.orientation.equals(e.orientation))}},{key:"exactEquals",value:function(e){return!!e&&(this.position.exactEquals(e.position)&&this.orientation.exactEquals(e.orientation))}},{key:"getTransformationMatrix",value:function(){var e=Math.sin(this.roll),t=Math.sin(this.pitch),n=Math.sin(this.yaw),r=Math.cos(this.roll),i=Math.cos(this.pitch),o=Math.cos(this.yaw);return(new Pe).setRowMajor(o*i,-n*r+o*t*e,n*e+o*t*r,this.x,n*i,o*r+n*t*e,-o*e+n*t*r,this.y,-t,i*e,i*r,this.z,0,0,0,1)}},{key:"getTransformationMatrixFromPose",value:function(e){return(new Pe).multiplyRight(this.getTransformationMatrix()).multiplyRight(e.getTransformationMatrix().invert())}},{key:"getTransformationMatrixToPose",value:function(e){return(new Pe).multiplyRight(e.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}},{key:"x",get:function(){return this.position.x},set:function(e){return this.position.x=e}},{key:"y",get:function(){return this.position.y},set:function(e){return this.position.y=e}},{key:"z",get:function(){return this.position.z},set:function(e){return this.position.z=e}},{key:"roll",get:function(){return this.orientation.roll},set:function(e){return this.orientation.roll=e}},{key:"pitch",get:function(){return this.orientation.pitch},set:function(e){return this.orientation.pitch=e}},{key:"yaw",get:function(){return this.orientation.yaw},set:function(e){return this.orientation.yaw=e}}]),e}(),Ft=function(){function e(t){Object(r.a)(this,e),this.points=t,this.isClosed=C(this.points[this.points.length-1],this.points[0]),Object.freeze(this)}return Object(i.a)(e,[{key:"getSignedArea",value:function(){var e=0;return this.forEachSegment(function(t,n){e+=(t[0]+n[0])*(t[1]-n[1])}),e/2}},{key:"getArea",value:function(){return Math.abs(this.getSignedArea())}},{key:"getWindingDirection",value:function(){return Math.sign(this.getSignedArea())}},{key:"forEachSegment",value:function(e){for(var t=this.points.length,n=0;n<t-1;n++)e(this.points[n],this.points[n+1],n,n+1);this.isPolygon&&!this.isClosed()&&e(this.points[t-1],this.points[0],t-1,0)}}]),e}();n.d(t,"Vector2",function(){return P}),n.d(t,"Vector3",function(){return W}),n.d(t,"Vector4",function(){return Y}),n.d(t,"Matrix4",function(){return Pe}),n.d(t,"Quaternion",function(){return Tt}),n.d(t,"config",function(){return l}),n.d(t,"checkNumber",function(){return h}),n.d(t,"configure",function(){return f}),n.d(t,"formatValue",function(){return p}),n.d(t,"isArray",function(){return _}),n.d(t,"clone",function(){return g}),n.d(t,"radians",function(){return E}),n.d(t,"degrees",function(){return v}),n.d(t,"sin",function(){return y}),n.d(t,"cos",function(){return b}),n.d(t,"tan",function(){return A}),n.d(t,"asin",function(){return T}),n.d(t,"acos",function(){return R}),n.d(t,"atan",function(){return x}),n.d(t,"clamp",function(){return S}),n.d(t,"lerp",function(){return I}),n.d(t,"equals",function(){return C}),n.d(t,"_SphericalCoordinates",function(){return It}),n.d(t,"_Pose",function(){return wt}),n.d(t,"_Euler",function(){return Nt}),n.d(t,"_Polygon",function(){return Ft})},function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});const r={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==e&&e,document:"undefined"!=typeof document&&document},i=r.window||r.self||r.global,o=r.global||r.self||r.window}).call(this,n(9))},function(e,t,n){"use strict";(function(e,r){n.d(t,"e",function(){return s}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return u}),n.d(t,"d",function(){return c}),n.d(t,"a",function(){return l});var i=n(10),o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==e&&e,document:"undefined"!=typeof document&&document,process:"object"===(void 0===r?"undefined":Object(i.a)(r))&&r},s=o.window||o.self||o.global,a=o.global||o.self||o.window,u=o.document||{},c=o.process||{},l=console}).call(this,n(9),n(15))},function(e,t,n){"use strict";var r=n(32);t.a=new r.a({id:"luma"}).enable()},function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(23);const o="luma.gl: loaded under Node.js without headless gl installed, meaning that WebGL contexts can not be created. This may not be an error. For example, this is a typical configuration for isorender applications running on the server.";let s=null;function a(...e){const t=n(105);if(!t)throw new Error(o);return t(...e)}if(!i.a)try{s=n(106)}catch(e){}class u{}const{WebGLRenderingContext:c=u,WebGLProgram:l=u,WebGLShader:f=u,WebGLBuffer:h=u,WebGLFramebuffer:d=u,WebGLRenderbuffer:p=u,WebGLTexture:_=u,WebGLUniformLocation:g=u,WebGLActiveInfo:m=u,WebGLShaderPrecisionFormat:E=u}=s||r.a;const v=r.a.WebGL2RenderingContext||class{};r.a.Image;function y(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}const b={};function A(e="id"){return b[e]=b[e]||1,`${e}-${b[e]++}`}function T(e){return y("number"==typeof e,"Input must be a number"),e&&0==(e&e-1)}function R(e){let t=!0;for(const n in e){t=!1;break}return t}var x=n(7);function S(e,t={}){const{isInteger:n=!1}=t;if(Array.isArray(e)||ArrayBuffer.isView(e))return function(e,t){const{maxElts:n=16,size:r=1}=t;let i="[";for(let o=0;o<e.length&&o<n;++o)o>0&&(i+=`,${o%r==0?" ":""}`),i+=S(e[o],t);return`${i}${e.length>n?"...":"]"}`}(e,t);if(!Number.isFinite(e))return String(e);if(Math.abs(e)<1e-16)return n?"0":"0.";if(n)return e.toFixed(0);if(Math.abs(e)>100&&Math.abs(e)<1e4)return e.toFixed(0);const r=e.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function I(e,t,n,r){const i=`See luma.gl ${n} Upgrade Guide at http://uber.github.io/luma.gl/#/documentation/overview/upgrade-guide`,o=Object.getPrototypeOf(e);r.forEach(e=>{o.methodName||(o[e]=(()=>{throw x.a.removed(`Calling removed method ${t}.${e}: `,i)(),new Error(e)}))})}function C(e,t,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:o={}}=n;for(const n in r)if(n in t){const t=r[n]?`${e}.${r[n]}`:"N/A";x.a.removed(`${e}.${n}`,t)()}for(const n in i)if(n in t){const t=i[n];x.a.deprecated(`${e}.${n}`,`${e}.${t}`)()}let s=null;for(const n in o)if(n in t){const r=o[n];x.a.deprecated(`${e}.${n}`,`${e}.${r}`)(),(s=s||Object.assign({},t))[r]=t[n],delete s[n]}return s||t}const N=34962,w=32874,F="Invalid WebGLRenderingContext",M="Requires WebGL2";function O(e){return Boolean(e&&(e instanceof c||e.ARRAY_BUFFER===N))}function L(e){return Boolean(e&&(e instanceof v||e.TEXTURE_BINDING_3D===w))}function P(e){y(O(e),F)}function B(e){y(L(e),M)}var D=n(0),U=n.n(D),k=n(33);function G(e){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)}function j(e){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e)}const V=35632,H=35633;function X(e,t="unnamed"){const n=e.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:t}function $(e,t,n,r){const i=e.split(/\r?\n/),o={},s={},a=r||X(t)||"(unnamed)",u=`${function(e){switch(e){case V:return"fragment";case H:return"vertex";default:return"unknown type"}}(n)} shader ${a}`;for(let t=0;t<i.length;t++){const n=i[t];if(n.length<=1)continue;const r=n.split(":"),a=r[0],c=parseInt(r[2],10);if(isNaN(c))throw new Error(`GLSL compilation error in ${u}: ${e}`);"WARNING"!==a?o[c]=n:s[c]=n}const c=function(e,t=1,n=": "){const r=e.split(/\r?\n/),i=String(r.length+t-1).length;return r.map((e,r)=>{const o=r+t,s=String(o).length,a=W(o,i-s);return a+n+e})}(t);return{shaderName:u,errors:z(o,c),warnings:z(s,c)}}function z(e,t){let n="";for(let r=0;r<t.length;r++){const i=t[r];if((e[r+3]||e[r+2]||e[r+1])&&(n+=`${i}\n`,e[r+1])){const t=e[r+1],i=t.split(":",3),o=i[0],s=parseInt(i[1],10)||0;n+=W(`^^^ ${o}: ${t.substring(i.join(":").length+1).trim()}\n\n`,s)}}return n}function W(e,t){let n="";for(let e=0;e<t;++e)n+=" ";return`${n}${e}`}const Y="Failed to deduce GL constant from typed array";function K(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return U.a.FLOAT;case Uint16Array:return U.a.UNSIGNED_SHORT;case Uint32Array:return U.a.UNSIGNED_INT;case Uint8Array:case Uint8ClampedArray:return U.a.UNSIGNED_BYTE;case Int8Array:return U.a.BYTE;case Int16Array:return U.a.SHORT;case Int32Array:return U.a.INT;default:throw new Error(Y)}}function q(e,{clamped:t=!0}={}){switch(e){case U.a.FLOAT:return Float32Array;case U.a.UNSIGNED_SHORT:case U.a.UNSIGNED_SHORT_5_6_5:case U.a.UNSIGNED_SHORT_4_4_4_4:case U.a.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;case U.a.UNSIGNED_INT:return Uint32Array;case U.a.UNSIGNED_BYTE:return t?Uint8ClampedArray:Uint8Array;case U.a.BYTE:return Int8Array;case U.a.SHORT:return Int16Array;case U.a.INT:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Q({data:e,width:t,height:n}){const r=Math.round(t/2),i=Math.round(n/2),o=new Uint8Array(r*i*4);for(let n=0;n<i;n++)for(let i=0;i<r;i++)for(let s=0;s<4;s++)o[4*(n*r+i)+s]=e[4*(2*n*t+2*i)+s];return{data:o,width:r,height:i}}function Z(e,t){if("string"!=typeof t)return t;const n=Number(t);if(!isNaN(n))return n;const r=e[t=t.replace(/^.*\./,"")];return y(void 0!==r,`Accessing undefined constant GL.${t}`),r}function J(e,t){t=Number(t);for(const n in e)if(e[n]===t)return`GL.${n}`;return String(t)}const ee="Resource subclass must define virtual methods";class te{constructor(e,t={}){P(e);const{id:n,userData:r={}}=t;this.gl=e,this.id=n||A(this.constructor.name),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle=null,this._removeStats(),t&&e&&t.filter(Boolean).forEach(e=>{e.delete()}),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){y(e=Z(this.gl,e));const n=(this.constructor.PARAMETERS||{})[e];if(n){const e=L(this.gl);if(!((!("webgl2"in n)||e)&&(!("extension"in n)||this.gl.getExtension(n.extension)))){const t=n.webgl1,r="webgl2"in n?n.webgl2:n.webgl1;return e?r:t}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:n}={},r=this.constructor.PARAMETERS||{},i=L(this.gl),o={},s=t||Object.keys(r);for(const t of s){const s=r[t];if(s&&(!("webgl2"in s)||i)&&(!("extension"in s)||this.gl.getExtension(s.extension))){const r=n?J(this.gl,t):t;o[r]=this.getParameter(t,e),n&&"GLenum"===s.type&&(o[r]=J(this.gl,o[r]))}}return o}setParameter(e,t){y(e=Z(this.gl,e));const n=(this.constructor.PARAMETERS||{})[e];if(n){const e=L(this.gl);if(!((!("webgl2"in n)||e)&&(!("extension"in n)||this.gl.getExtension(n.extension))))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(t=Z(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,n){return I(this,e,t,n)}initialize(e){}_createHandle(){throw new Error(ee)}_deleteHandle(){throw new Error(ee)}_bindHandle(){throw new Error(ee)}_getOptsFromHandle(){throw new Error(ee)}_getParameter(e,t){throw new Error(ee)}_setParameter(e,t){throw new Error(ee)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this.constructor.name,{stats:t}=k.default;t.resourceCount=t.resourceCount||0,t.resourceMap=t.resourceMap||{},t.resourceCount++,t.resourceMap[e]=t.resourceMap[e]||{created:0,active:0},t.resourceMap[e].created++,t.resourceMap[e].active++}_removeStats(){const e=this.constructor.name,{stats:t}=k.default;t.resourceMap[e].active--}}const ne={offset:0,stride:0,type:U.a.FLOAT,size:1,divisor:0,normalized:!1,integer:!1},re={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class ie{static getBytesPerElement(e){return q(e.type||U.a.FLOAT).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return y(e.size),q(e.type||U.a.FLOAT).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new ie(...[ne,...e])}constructor(...e){e.forEach(e=>this._assign(e)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return ie.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return ie.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=C("Accessor",e,re)).type&&(e.type!==this.type&&x.a.warn("accessor type mismatch")(),this.type=e.type,e.type!==U.a.INT&&e.type!==U.a.UNSIGNED_INT||(this.integer=!0)),void 0!==e.size&&(this.size!==e.size&&x.a.warn("accessor size mismatch")(),this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&("boolean"==typeof index?this.index=e.index?1:0:this.index=e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const oe=10,se={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",index:"accessor.index",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},ae={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:se},ue={removedProps:se};class ce extends te{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?U.a.COPY_READ_BUFFER:U.a.ARRAY_BUFFER),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/ie.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/ie.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=C("Buffer",e,ae),this.usage=e.usage||U.a.STATIC_DRAW,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=C("Buffer",e,ue))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new ie(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:n=0,srcOffset:r=0}=e,i=e.byteLength||e.length;y(t);const o=this.gl.webgl2?U.a.COPY_WRITE_BUFFER:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==i?(B(this.gl),this.gl.bufferSubData(this.target,n,t,r,i)):this.gl.bufferSubData(o,n,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:n=0,size:r}){const{gl:i}=this;return B(i),i.bindBuffer(U.a.COPY_READ_BUFFER,e.handle),i.bindBuffer(U.a.COPY_WRITE_BUFFER,this.handle),i.copyBufferSubData(U.a.COPY_READ_BUFFER,U.a.COPY_WRITE_BUFFER,t,n,r),i.bindBuffer(U.a.COPY_READ_BUFFER,null),i.bindBuffer(U.a.COPY_WRITE_BUFFER,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:n=0,length:r=0}={}){B(this.gl);const i=q(this.accessor.type||U.a.FLOAT,{clamped:!1}),o=this._getAvailableElementCount(t),s=n;let a,u;e?a=(u=e.length)-s:u=s+(a=Math.min(o,r||o));const c=Math.min(o,a);return y((r=r||c)<=c),e=e||new i(u),this.gl.bindBuffer(U.a.COPY_READ_BUFFER,this.handle),this.gl.getBufferSubData(U.a.COPY_READ_BUFFER,t,e,n,r),this.gl.bindBuffer(U.a.COPY_READ_BUFFER,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:n=0,size:r}={}){return e===U.a.UNIFORM_BUFFER||e===U.a.TRANSFORM_FEEDBACK_BUFFER?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,n,r):(y(0===n),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return e===U.a.UNIFORM_BUFFER||e===U.a.TRANSFORM_FEEDBACK_BUFFER?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:oe}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=this.usage){y(ArrayBuffer.isView(e));const n=this._getTarget();this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,e,t),this.gl.bindBuffer(n,null),this.usage=t,this.debugData=e.slice(0,oe),this.byteLength=e.byteLength,this.bytesUsed=e.byteLength;const r=K(e);return y(r),this.setAccessor(new ie(this.accessor,{type:r})),this}_setByteLength(e,t=this.usage){y(e>=0);let n=e;0===e&&(n=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.byteLength=e,this.bytesUsed=e,this}_getTarget(){return this.gl.webgl2?U.a.COPY_WRITE_BUFFER:this.target}_getAvailableElementCount(e){const t=e/q(this.accessor.type||U.a.FLOAT,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-t}_inferType(e){this.accessor.type||this.setAccessor(new ie(this.accessor,{type:K(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle)}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return x.a.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return x.a.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return x.a.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return x.a.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new ie(this.accessor,e),this}}const le={[U.a.RGB]:{dataFormat:U.a.RGB,types:[U.a.UNSIGNED_BYTE,U.a.UNSIGNED_SHORT_5_6_5]},[U.a.RGBA]:{dataFormat:U.a.RGBA,types:[U.a.UNSIGNED_BYTE,U.a.UNSIGNED_SHORT_4_4_4_4,U.a.UNSIGNED_SHORT_5_5_5_1]},[U.a.ALPHA]:{dataFormat:U.a.ALPHA,types:[U.a.UNSIGNED_BYTE]},[U.a.LUMINANCE]:{dataFormat:U.a.LUMINANCE,types:[U.a.UNSIGNED_BYTE]},[U.a.LUMINANCE_ALPHA]:{dataFormat:U.a.LUMINANCE_ALPHA,types:[U.a.UNSIGNED_BYTE]},[U.a.R32F]:{dataFormat:U.a.RED,types:[U.a.FLOAT],gl2:!0},[U.a.RG32F]:{dataFormat:U.a.RG,types:[U.a.FLOAT],gl2:!0},[U.a.RGB32F]:{dataFormat:U.a.RGB,types:[U.a.FLOAT],gl2:!0},[U.a.RGBA32F]:{dataFormat:U.a.RGBA,types:[U.a.FLOAT],gl2:!0}};var fe=n(13);function he(e){return Array.isArray(e)||ArrayBuffer.isView(e)}var de={framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(U.a.FRAMEBUFFER,n)},blend:(e,t)=>t?e.enable(U.a.BLEND):e.disable(U.a.BLEND),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{t=he(t)?t:[t,t],e.blendEquationSeparate(...t)},blendFunc:(e,t)=>{t=he(t)&&2===t.length?[...t,...t]:t,e.blendFuncSeparate(...t)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(U.a.CULL_FACE):e.disable(U.a.CULL_FACE),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(U.a.DEPTH_TEST):e.disable(U.a.DEPTH_TEST),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(U.a.DITHER):e.disable(U.a.DITHER),derivativeHint:(e,t)=>{e.hint(U.a.FRAGMENT_SHADER_DERIVATIVE_HINT,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(U.a.GENERATE_MIPMAP_HINT,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(U.a.POLYGON_OFFSET_FILL):e.disable(U.a.POLYGON_OFFSET_FILL),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(U.a.SCISSOR_TEST):e.disable(U.a.SCISSOR_TEST),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(U.a.STENCIL_TEST):e.disable(U.a.STENCIL_TEST),stencilMask:(e,t)=>{t=he(t)?t:[t,t];const[n,r]=t;e.stencilMaskSeparate(U.a.FRONT,n),e.stencilMaskSeparate(U.a.BACK,r)},stencilFunc:(e,t)=>{t=he(t)&&3===t.length?[...t,...t]:t;const[n,r,i,o,s,a]=t;e.stencilFuncSeparate(U.a.FRONT,n,r,i),e.stencilFuncSeparate(U.a.BACK,o,s,a)},stencilOp:(e,t)=>{t=he(t)&&3===t.length?[...t,...t]:t;const[n,r,i,o,s,a]=t;e.stencilOpSeparate(U.a.FRONT,n,r,i),e.stencilOpSeparate(U.a.BACK,o,s,a)},viewport:(e,t)=>e.viewport(...t)};function pe(e,t){Object(fe.f)(e,t);for(const n in t){const r=de[n];r&&r(e,t[n],n)}}var _e=n(17),ge=n(12);function me(e,t,n){if(Object(ge.b)(t))return n(e);const{nocatch:r=!0}=t;let i;if(Object(ge.a)(!t.frameBuffer),Object(_e.c)(e),pe(e,t),r)i=n(e),Object(_e.b)(e);else try{i=n(e)}finally{Object(_e.b)(e)}return i}const Ee="Failed to create WebGL context in Node.js, headless gl not available",ve="Failed to create WebGL context in Node.js, headless gl returned null";const ye=i.a&&"undefined"!=typeof document;let be,Ae=ye&&"complete"===document.readyState;function Te(){return be||(be=ye?new Promise((e,t)=>{if(ye&&"complete"===document.readyState)return Ae=!0,void e(document);window.onload=(()=>{Ae=!0,e(document)})}):Promise.resolve({})),be}function Re({canvas:e,width:t,height:n,onError:r=(()=>{})}){let i;return"string"==typeof e?(Ae||r(`createGLContext called on canvas '${e}' before page was loaded`),i=document.getElementById(e)):i=e||function({width:e=800,height:t=600,id:n="gl-canvas",insert:r=!0}){const i=document.createElement("canvas");if(i.id=n,i.style.width=Number.isFinite(e)?`${e}px`:"100%",i.style.height=Number.isFinite(t)?`${t}px`:"100%",r){const e=document.body;e.insertBefore(i,e.firstChild)}return i}({id:"lumagl-canvas",width:t,height:n,onError:r}),i}function xe(e){const t=e.getParameter(U.a.VENDOR),n=e.getParameter(U.a.RENDERER),r=e.getExtension("WEBGL_debug_renderer_info"),i=r&&e.getParameter(r.UNMASKED_VENDOR_WEBGL||U.a.VENDOR),o=r&&e.getParameter(r.UNMASKED_RENDERER_WEBGL||U.a.RENDERER);return{vendor:i||t,renderer:o||n,vendorMasked:t,rendererMasked:n,version:e.getParameter(U.a.VERSION),shadingLanguageVersion:e.getParameter(U.a.SHADING_LANGUAGE_VERSION)}}const Se="Query was deleted before result was available",Ie="Query was canceled before result was available",Ce=e=>e;var Ne=new class{constructor(){this.pendingQueries=new Set,this.invalidQueryType=null,this.invalidErrorMessage="",this.checkInvalid=(()=>!1)}poll(e){this.cancelInvalidQueries(e);for(const e of this.pendingQueries.values())if(e.isResultAvailable()){const t=e.getResult();this.resolveQuery(e,t)}}setInvalidator({queryType:e,errorMessage:t,checkInvalid:n}){this.invalidQueryType=e,this.invalidErrorMessage=t,this.checkInvalid=n}beginQuery(e,t=Ce,n=Ce){this.cancelInvalidQueries(e.gl),this.cancelQuery(e);const r={};return e.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),Object.assign(e.promise,r),this.pendingQueries.add(e),e.promise.then(t).catch(n)}resolveQuery(e,t){this.pendingQueries.delete(e),e.promise.resolve(t)}rejectQuery(e,t){this.pendingQueries.delete(e),e.promise&&e.promise.reject(new Error(t))}deleteQuery(e){return this.rejectQuery(e,Se)}cancelQuery(e){return this.rejectQuery(e,Ie)}invalidateQuery(e){e instanceof this.invalidQueryType&&this.rejectQuery(e,this.invalidErrorMessage)}cancelInvalidQueries(e){if(this.checkInvalid(e))for(const e of this.pendingQueries.values())this.invalidateQuery(e)}};const we=34962,Fe=32874;function Me(e){return Boolean(e&&(e instanceof c||e.ARRAY_BUFFER===we))}function Oe(e){return Boolean(e&&(e instanceof v||e.TEXTURE_BINDING_3D===Fe))}const Le={webgl2:!0,webgl1:!0,throwOnFailure:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Pe(e={}){Object.assign(Le,{width:1,height:1},e)}function Be(e={}){e=Object.assign({},Le,e);const{canvas:t,width:n,height:o,throwOnError:s,manageState:u,debug:c}=e;function l(e){if(s)throw new Error(e);return null}let f;if(i.a){f=function({canvas:e,opts:t={},onError:n=(e=>null)}){function r(e){n(`WebGL context: ${e.statusMessage||"Unknown error"}`)}e.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:i=!0,webgl2:o=!0}=t;let s=null;return o&&(s=(s=s||e.getContext("webgl2",t))||e.getContext("experimental-webgl2",t)),i&&(s=(s=s||e.getContext("webgl",t))||e.getContext("experimental-webgl",t)),e.removeEventListener("webglcontextcreationerror",r,!1),s||n(`Failed to create ${o&&!i?"WebGL2":"WebGL"} context`)}({canvas:Re({canvas:t,width:n,height:o,onError:l}),opts:e})}else f=function({width:e,height:t,opts:n,onError:r}){const{webgl1:i,webgl2:o}=n;if(o&&!i)return r("headless-gl does not support WebGL2");if(!a)return r(Ee);const s=a(e,t,n);return s||r(ve)}({width:n,height:o,opts:e,onError:l});return f?(u&&Object(_e.a)(f,{copyState:!1,log:(...e)=>x.a.log(1,...e)()}),i.a&&c&&(r.a.makeDebugContext?(f=r.a.makeDebugContext(f,{debug:c}),x.a.priority=Math.max(x.a.priority,1)):x.a.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),function(e){const t=Oe(e)?"WebGL2":"WebGL1",n=xe(e),r=n?`(${n.vendor},${n.renderer})`:"",i=e.debug?" debug":"";x.a.once(1,`${t}${i} context ${r}`)()}(f),f):null}function De(e){const t=e.getExtension("STACKGL_destroy_context");t&&t.destroy()}function Ue(e,t={}){if(e.canvas){const n=t.useDevicePixels&&window.devicePixelRatio||1,r="width"in t?t.width:e.canvas.clientWidth,i="height"in t?t.height:e.canvas.clientHeight;return e.canvas.width=r*n,void(e.canvas.height=i*n)}const n=e.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in t&&"height"in t&&n.resize(t.width,t.height)}function ke(e){Ne.poll(e)}const Ge=[U.a.LINEAR,U.a.NEAREST];class je extends te{static isSupported(e,{format:t,linearFiltering:n}={}){let r=!0;return t&&(r=(r=r&&function(e,t){const n=le[t];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const r=L(e)&&n.gl2||n.gl1;return"string"==typeof r?e.getExtension(r):r}(e,t))&&(!n||function(e,t){const n=le[t];switch(n&&n.types[0]){case U.a.FLOAT:return e.getExtension("OES_texture_float_linear");case U.a.HALF_FLOAT:return e.getExtension("OES_texture_half_float_linear");default:return!0}}(e,t))),r}constructor(e,t){const{id:n=A("texture"),handle:r,target:i}=t;super(e,{id:n,handle:r}),this.target=i,this.hasFloatTexture=e.getExtension("OES_texture_float"),this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(t=>this.initialize(Object.assign({},e,{pixels:t,data:t}))),this;const{pixels:n=null,format:r=U.a.RGBA,type:i=U.a.UNSIGNED_BYTE,border:o=0,recreate:s=!1,parameters:a={},pixelStore:u={},textureUnit:c,unpackFlipY:l=!0}=e;let{mipmaps:f=!0}=e;t||(t=n);let{width:h,height:d,dataFormat:p}=e;({width:h,height:d,dataFormat:p}=this._deduceParameters({format:r,type:i,dataFormat:p,compressed:!1,data:t,width:h,height:d})),this.width=h,this.height=d,this.format=r,this.type=i,this.dataFormat=p,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(U.a.TEXTURE0+this.textureUnit),this.gl.bindTexture(this.target,this.handle));const _={[U.a.UNPACK_FLIP_Y_WEBGL]:l},g=Object.assign({},_,u);return this._isNPOT()&&f&&(x.a.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),f=!1,this._updateForNPOT(a)),this.mipmaps=f,this.setImageData({data:t,width:h,height:d,format:r,type:i,dataFormat:p,border:o,mipmaps:f,parameters:g}),f&&this.generateMipmap(),this.setParameters(a),s&&(this.data=t),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:!1}):this}generateMipmap(e={}){return this.gl.bindTexture(this.target,this.handle),me(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this}setImageData(e){const{target:t=this.target,pixels:n=null,level:r=0,format:i=this.format,border:o=this.border,offset:s=0,parameters:a={}}=e;let{data:u=null,type:c=this.type,width:l=this.width,height:f=this.height,dataFormat:h=this.dataFormat,compressed:d=!1}=e;u||(u=n),({type:c,dataFormat:h,compressed:d,width:l,height:f}=this._deduceParameters({format:i,type:c,dataFormat:h,compressed:d,data:u,width:l,height:f}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let _=null;return({data:u,dataType:_}=this._getDataType({data:u,compressed:d})),me(this.gl,a,()=>{switch(_){case"null":p.texImage2D(t,r,i,l,f,o,h,c,u);break;case"typed-array":p.texImage2D(t,r,i,l,f,o,h,c,u,s);break;case"buffer":B(p),p.bindBuffer(U.a.PIXEL_UNPACK_BUFFER,u.handle||u),p.texImage2D(t,r,i,l,f,o,h,c,s),p.bindBuffer(U.a.PIXEL_UNPACK_BUFFER,null);break;case"browser-object":L(p)?p.texImage2D(t,r,i,l,f,o,h,c,u):p.texImage2D(t,r,i,h,c,u);break;case"compressed":p.compressedTexImage2D(t,r,i,l,f,o,u);break;default:y(!1,"Unknown image data type")}}),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:n=null,x:r=0,y:i=0,width:o=this.width,height:s=this.height,level:a=0,format:u=this.format,type:c=this.type,dataFormat:l=this.dataFormat,compressed:f=!1,offset:d=0,border:p=this.border,parameters:_={}}){if(({type:c,dataFormat:l,compressed:f,width:o,height:s}=this._deduceParameters({format:u,type:c,dataFormat:l,compressed:f,data:n,width:o,height:s})),n||(n=t),n&&n.data){const e=n;n=e.data,o=e.shape[0],s=e.shape[1]}n instanceof ce&&(n=n.handle),this.gl.bindTexture(this.target,this.handle),me(this.gl,_,()=>{f?this.gl.compressedTexSubImage2D(e,a,r,i,o,s,u,n):null===n?this.gl.texSubImage2D(e,a,r,i,o,s,l,c,null):ArrayBuffer.isView(n)?this.gl.texSubImage2D(e,a,r,i,o,s,l,c,n,d):n instanceof h?(B(this.gl),this.gl.bindBuffer(U.a.PIXEL_UNPACK_BUFFER,n),this.gl.texSubImage2D(e,a,r,i,o,s,l,c,d),this.gl.bindBuffer(U.a.PIXEL_UNPACK_BUFFER,null)):L(this.gl)?this.gl.texSubImage2D(e,a,r,i,o,s,l,c,n):this.gl.texSubImage2D(e,a,r,i,l,c,n)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return x.a.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(U.a.ACTIVE_TEXTURE)-U.a.TEXTURE0}bind(e=this.textureUnit){if(void 0===e)throw new Error("Texture.bind: must specify texture unit");return this.textureUnit=e,this.gl.activeTexture(U.a.TEXTURE0+e),this.gl.bindTexture(this.target,this.handle),e}unbind(){if(void 0===this.textureUnit)throw new Error("Texture.unbind: texture unit not specified");return this.gl.activeTexture(U.a.TEXTURE0+this.textureUnit),this.gl.bindTexture(this.target,null),this.textureUnit}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof ce?{data:e.handle,dataType:"buffer"}:e instanceof h?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}setImage3D({level:e=0,internalformat:t=U.a.RGBA,width:n,height:r,depth:i=1,border:o=0,format:s,type:a=U.a.UNSIGNED_BYTE,offset:u=0,pixels:c}){return ArrayBuffer.isView(c)?(this.gl.texImage3D(this.target,e,t,n,r,i,o,s,a,c),this):(c instanceof ce&&(this.gl.bindBuffer(U.a.PIXEL_UNPACK_BUFFER,c.handle),this.gl.texImage3D(this.target,e,t,n,r,i,o,s,a,u)),this)}_deduceParameters(e){const{format:t,data:n}=e;let{width:r,height:i,dataFormat:o,type:s,compressed:a}=e;const u=le[t];return o=o||u&&u.dataFormat,s=s||u&&u.types[0],a=a||u&&u.compressed,({width:r,height:i}=this._deduceImageSize(n,r,i)),{dataFormat:o,type:s,compressed:a,width:r,height:i,format:t,data:n}}_deduceImageSize(e,t,n){let r;return y(r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:n}:{width:t>=0?t:1,height:n>=0?n:1},"Could not deduced texture size"),y(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),y(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle)}_getParameter(e){switch(e){case U.a.TEXTURE_WIDTH:return this.width;case U.a.TEXTURE_HEIGHT:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case U.a.TEXTURE_MIN_LOD:case U.a.TEXTURE_MAX_LOD:this.gl.texParameterf(this.handle,e,t);break;case U.a.TEXTURE_WIDTH:case U.a.TEXTURE_HEIGHT:y(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(L(this.gl)||T(this.width)&&T(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case U.a.TEXTURE_MIN_FILTER:-1===Ge.indexOf(t)&&(t=U.a.LINEAR);break;case U.a.TEXTURE_WRAP_S:case U.a.TEXTURE_WRAP_T:t!==U.a.CLAMP_TO_EDGE&&(t=U.a.CLAMP_TO_EDGE)}return t}}let Ve="";function He(e){Ve=e}function Xe(e,t={}){y("string"==typeof e),e=Ve+e;const n=t.dataType||"text";return fetch(e,t).then(e=>e[n]())}function $e(e,t){return y("string"==typeof e),e=Ve+e,new Promise((n,r)=>{try{const i=new Image;i.onload=(()=>n(i)),i.onerror=(()=>r(new Error(`Could not load image ${e}.`))),i.crossOrigin=t&&t.crossOrigin||"anonymous",i.src=e}catch(e){r(e)}})}class ze extends je{static isSupported(e,t){return je.isSupported(e,t)}constructor(e,t={}){P(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:$e(t.data)})),super(e,Object.assign({},t,{target:e.TEXTURE_2D})),this.initialize(t),Object.seal(this)}bind(e=this.textureUnit){const{gl:t}=this;if(void 0===e)throw new Error("Texture.bind: must specify texture unit");return this.textureUnit=e,t.activeTexture(t.TEXTURE0+e),t.bindTexture(this.target,this.handle),e}unbind(){const{gl:e}=this;if(void 0===this.textureUnit)throw new Error("Texture.unbind: texture unit not specified");return e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(this.target,null),this.textureUnit}getActiveUnit(){return this.gl.getParameter(U.a.ACTIVE_TEXTURE)-U.a.TEXTURE0}}const We=[U.a.TEXTURE_CUBE_MAP_POSITIVE_X,U.a.TEXTURE_CUBE_MAP_NEGATIVE_X,U.a.TEXTURE_CUBE_MAP_POSITIVE_Y,U.a.TEXTURE_CUBE_MAP_NEGATIVE_Y,U.a.TEXTURE_CUBE_MAP_POSITIVE_Z,U.a.TEXTURE_CUBE_MAP_NEGATIVE_Z];class Ye extends je{constructor(e,t={}){super(e,Object.assign({},t,{target:U.a.TEXTURE_CUBE_MAP})),this.initialize(t),Object.seal(this)}initialize(e={}){const{format:t=U.a.RGBA,mipmaps:n=!0}=e;let{width:r=1,height:i=1,type:o=U.a.UNSIGNED_BYTE,dataFormat:s}=e;({type:o,dataFormat:s}=this._deduceParameters({format:t,type:o,dataFormat:s})),({width:r,height:i}=this._deduceImageSize({data:e[U.a.TEXTURE_CUBE_MAP_POSITIVE_X],width:r,height:i})),y(r===i),this.setCubeMapImageData(e),n&&this.generateMipmap(e),this.opts=e}subImage({face:e,data:t,x:n=0,y:r=0,mipmapLevel:i=0}){return this._subImage({target:e,data:t,x:n,y:r,mipmapLevel:i})}setCubeMapImageData({width:e,height:t,pixels:n,data:r,border:i=0,format:o=U.a.RGBA,type:s=U.a.UNSIGNED_BYTE,generateMipmap:a=!1}){const{gl:u}=this,c=n||r,l=(n,r)=>{this.width||this.height?u.texImage2D(n,0,o,e,t,i,o,s,r):u.texImage2D(n,0,o,o,s,r),this.loaded=!0};this.bind();for(const e of We){const t=c[e];t instanceof Promise?t.then(t=>l(e,t)):l(e,t)}this.unbind()}setImageDataForFace(e){const{face:t,width:n,height:r,pixels:i,data:o,border:s=0,format:a=U.a.RGBA,type:u=U.a.UNSIGNED_BYTE}=e,{gl:c}=this,l=i||o;return this.bind(),l instanceof Promise?l.then(n=>this.setImageDataForFace(Object.assign({},e,{face:t,data:n,pixels:n}))):this.width||this.height?c.texImage2D(t,0,a,n,r,s,a,u,l):c.texImage2D(t,0,a,a,u,l),this}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(t.TEXTURE0+e)),t.bindTexture(this.target,this.handle),e}unbind(){return this.gl.bindTexture(U.a.TEXTURE_CUBE_MAP,null),this}}Ye.FACES=We;class Ke extends je{static isSupported(e){return L(e)}constructor(e,t={}){B(e),super(e,Object.assign({},t,{target:t.target||U.a.TEXTURE_3D})),this.width=null,this.height=null,this.depth=null,Object.seal(this),this.setImageData(t),t.generateMipmap&&this.generateMipmap()}initialize(e={}){this.opts=Object.assign({},this.opts,e);const{pixels:t,settings:n}=this.opts;n&&(me(n,()=>{t&&this.setImage3D(this.opts)}),this.setParameters(e))}setImage3D({level:e=0,internalformat:t=U.a.RGBA,width:n,height:r,depth:i=1,border:o=0,format:s,type:a=U.a.UNSIGNED_BYTE,offset:u=0,pixels:c}){ArrayBuffer.isView(c)?this.gl.texImage3D(this.target,e,t,n,r,i,o,s,a,c):c instanceof ce&&(this.gl.bindBuffer(U.a.PIXEL_UNPACK_BUFFER,c.handle),this.gl.texImage3D(this.target,e,t,n,r,i,o,s,a,u),this.gl.bindBuffer(U.a.PIXEL_UNPACK_BUFFER,c.handle))}}const qe="EXT_color_buffer_float";var Qe={[U.a.DEPTH_COMPONENT16]:{},[U.a.DEPTH_COMPONENT24]:{gl2:!0},[U.a.DEPTH_COMPONENT32F]:{gl2:!0},[U.a.STENCIL_INDEX8]:{},[U.a.DEPTH_STENCIL]:{},[U.a.DEPTH24_STENCIL8]:{gl2:!0},[U.a.DEPTH32F_STENCIL8]:{gl2:!0},[U.a.RGBA4]:{},[U.a.RGB565]:{},[U.a.RGB5_A1]:{},[U.a.R8]:{gl2:!0},[U.a.R8UI]:{gl2:!0},[U.a.R8I]:{gl2:!0},[U.a.R16UI]:{gl2:!0},[U.a.R16I]:{gl2:!0},[U.a.R32UI]:{gl2:!0},[U.a.R32I]:{gl2:!0},[U.a.RG8]:{gl2:!0},[U.a.RG8UI]:{gl2:!0},[U.a.RG8I]:{gl2:!0},[U.a.RG16UI]:{gl2:!0},[U.a.RG16I]:{gl2:!0},[U.a.RG32UI]:{gl2:!0},[U.a.RG32I]:{gl2:!0},[U.a.RGB8]:{gl2:!0},[U.a.RGBA8]:{gl2:!0},[U.a.RGB10_A2]:{gl2:!0},[U.a.RGBA8UI]:{gl2:!0},[U.a.RGBA8I]:{gl2:!0},[U.a.RGB10_A2UI]:{gl2:!0},[U.a.RGBA16UI]:{gl2:!0},[U.a.RGBA16I]:{gl2:!0},[U.a.RGBA32I]:{gl2:!0},[U.a.RGBA32UI]:{gl2:!0},[U.a.R16F]:{gl2:qe},[U.a.RG16F]:{gl2:qe},[U.a.RGBA16F]:{gl2:qe},[U.a.R32F]:{gl2:qe},[U.a.RG32F]:{gl2:qe},[U.a.RGBA32F]:{gl2:qe},[U.a.R11F_G11F_B10F]:{gl2:qe}};class Ze extends te{static isSupported(e,{format:t}={}){return!t||function(e,t,n){const r=n[t];if(!r)return!1;const i=L(e)&&r.gl2||r.gl1;return"string"==typeof i?e.getExtension(i):i}(e,t,Qe)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(U.a.RENDERBUFFER,t,U.a.SAMPLES)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:n=1,samples:r=0}){return y(e,"Needs format"),this.gl.bindRenderbuffer(U.a.RENDERBUFFER,this.handle),0!==r&&L(this.gl)?this.gl.renderbufferStorageMultisample(U.a.RENDERBUFFER,r,e,t,n):this.gl.renderbufferStorage(U.a.RENDERBUFFER,e,t,n),this.format=e,this.width=t,this.height=n,this.samples=r,this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle)}_bindHandle(e){this.gl.bindRenderbuffer(U.a.RENDERBUFFER,e)}_syncHandle(e){this.format=this.getParameter(U.a.RENDERBUFFER_INTERNAL_FORMAT),this.width=this.getParameter(U.a.RENDERBUFFER_WIDTH),this.height=this.getParameter(U.a.RENDERBUFFER_HEIGHT),this.samples=this.getParameter(U.a.RENDERBUFFER_SAMPLES)}_getParameter(e){return this.gl.bindRenderbuffer(U.a.RENDERBUFFER,this.handle),this.gl.getRenderbufferParameter(U.a.RENDERBUFFER,e)}}const Je=256,et=1024,tt=16384,nt=6144,rt=6145,it=6146,ot=34041,st="clear: bad arguments";function at(e,{framebuffer:t=null,color:n=null,depth:r=null,stencil:i=null}={}){const o={};t&&(o.framebuffer=t);let s=0;n&&(s|=tt,!0!==n&&(o.clearColor=n)),r&&(s|=Je,!0!==r&&(o.clearDepth=r)),i&&(s|=et,!0!==r&&(o.clearStencil=r)),y(0!==s,st),me(e,o,()=>{e.clear(s)})}function ut(e,{framebuffer:t=null,buffer:n=nt,drawBuffer:r=0,value:i=[0,0,0,0]}={}){B(e),me(e,{framebuffer:t},()=>{switch(n){case nt:switch(i.constructor){case Int32Array:e.clearBufferiv(n,r,i);break;case Uint32Array:e.clearBufferuiv(n,r,i);break;case Float32Array:default:e.clearBufferfv(n,r,i)}break;case rt:e.clearBufferfv(rt,0,[i]);break;case it:e.clearBufferiv(it,0,[i]);break;case ot:const[t,o]=i;e.clearBufferfi(ot,0,t,o);break;default:y(!1,st)}})}function ct(e){switch(e){case U.a.ALPHA:case U.a.R32F:case U.a.RED:return 1;case U.a.RG32F:case U.a.RG:return 2;case U.a.RGB:case U.a.RGB32F:return 3;case U.a.RGBA:case U.a.RGBA32F:return 4;default:return y(!1),0}}function lt(e,{sourceX:t=0,sourceY:n=0,sourceFormat:r=U.a.RGBA,sourceAttachment:i=U.a.COLOR_ATTACHMENT0,target:o=null,sourceWidth:s,sourceHeight:a,sourceType:u}={}){const{framebuffer:c,deleteFramebuffer:l}=gt(e);y(c);const{gl:f,handle:h,attachments:d}=c;s=s||c.width,a=a||c.height,i===U.a.COLOR_ATTACHMENT0&&null===h&&(i=U.a.FRONT),y(d[i]),o=function(e,t,n,r,i){if(e)return e;const o=q(t=t||U.a.UNSIGNED_BYTE,{clamped:!1}),s=ct(n);return new o(r*i*s)}(o,u=u||d[i].type,r,s,a),u=u||K(o);const p=f.bindFramebuffer(U.a.FRAMEBUFFER,h);return f.readPixels(t,n,s,a,r,u,o),f.bindFramebuffer(U.a.FRAMEBUFFER,p||null),l&&c.delete(),o}function ft(e,{sourceX:t=0,sourceY:n=0,sourceFormat:r=U.a.RGBA,target:i=null,targetByteOffset:o=0,sourceWidth:s,sourceHeight:a,sourceType:u}){const{framebuffer:c,deleteFramebuffer:l}=gt(e);y(c);const{gl:f}=c;if(s=s||c.width,a=a||c.height,B(f),u=u||(i?i.type:U.a.UNSIGNED_BYTE),!i){const e=ct(r),t=function(e){switch(e){case U.a.UNSIGNED_BYTE:return 1;case U.a.UNSIGNED_SHORT_5_6_5:case U.a.UNSIGNED_SHORT_4_4_4_4:case U.a.UNSIGNED_SHORT_5_5_5_1:return 2;case U.a.FLOAT:return 4;default:return y(!1),0}}(u);i=new ce(f,{bytes:o+s*a*e*t,type:u,size:e})}return i.bind({target:U.a.PIXEL_PACK_BUFFER}),me(f,{framebuffer:c},()=>{f.readPixels(t,n,s,a,r,u,o)}),i.unbind({target:U.a.PIXEL_PACK_BUFFER}),l&&c.delete(),i}function ht(e,{sourceAttachment:t=U.a.COLOR_ATTACHMENT0,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}={}){let r=lt(e,{sourceAttachment:t}),{width:i,height:o}=e;for(;o>n;)({data:r,width:i,height:o}=Q({data:r,width:i,height:o}));!function({data:e,width:t,height:n,bytesPerPixel:r=4,temp:i}){const o=t*r;i=i||new Uint8Array(o);for(let t=0;t<n/2;++t){const r=t*o,s=(n-t-1)*o;i.set(e.subarray(r,r+o)),e.copyWithin(r,s,s+o),e.set(i,s)}}({data:r,width:i,height:o});const s=document.createElement("canvas");s.width=i,s.height=o;const a=s.getContext("2d"),u=a.createImageData(i,o);return u.data.set(r),a.putImageData(u,0,0),s.toDataURL()}function dt(e,{sourceAttachment:t=U.a.COLOR_ATTACHMENT0,targetImage:n=null}={}){const r=ht(e,{sourceAttachment:t});return(n=n||new Image).src=r,n}function pt(e,t,{sourceX:n=0,sourceY:r=0,targetX:i,targetY:o,targetZ:s,targetMipmaplevel:a=0,targetInternalFormat:u=U.a.RGBA,width:c,height:l}={}){const{framebuffer:f,deleteFramebuffer:h}=gt(e);y(f);const{gl:d,handle:p}=f,_=void 0!==i||void 0!==o||void 0!==s;i=i||0,o=o||0,s=s||0;const g=d.bindFramebuffer(U.a.FRAMEBUFFER,p);y(t);let m=null;if(t instanceof je&&(m=t,c=Number.isFinite(c)?c:m.width,l=Number.isFinite(l)?l:m.height,m.bind(0),t=m.target),_)switch(t){case U.a.TEXTURE_2D:case U.a.TEXTURE_CUBE_MAP:d.copyTexSubImage2D(t,a,i,o,n,r,c,l);break;case U.a.TEXTURE_2D_ARRAY:case U.a.TEXTURE_3D:d.copyTexSubImage3D(t,a,i,o,s,n,r,c,l)}else d.copyTexImage2D(t,a,u,n,r,c,l,0);return m&&m.unbind(),d.bindFramebuffer(U.a.FRAMEBUFFER,g||null),h&&f.delete(),m}function _t(e,t,{sourceAttachment:n=U.a.COLOR_ATTACHMENT0,sourceX0:r=0,sourceY0:i=0,sourceX1:o,sourceY1:s,targetX0:a=0,targetY0:u=0,targetX1:c,targetY1:l,color:f=!0,depth:h=!1,stencil:d=!1,mask:p=0,filter:_=U.a.NEAREST}={}){const{framebuffer:g,deleteFramebuffer:m}=gt(e),{framebuffer:E,deleteFramebuffer:v}=gt(t);y(g),y(E);const{gl:b,handle:A,width:T,height:R,readBuffer:S}=E;B(b),g.handle||n!==U.a.COLOR_ATTACHMENT0||(n=U.a.FRONT),f&&(p|=U.a.COLOR_BUFFER_BIT),h&&(p|=U.a.DEPTH_BUFFER_BIT),d&&(p|=U.a.STENCIL_BUFFER_BIT),(m||v)&&p&(U.a.DEPTH_BUFFER_BIT|U.a.STENCIL_BUFFER_BIT)&&(p=U.a.COLOR_BUFFER_BIT,x.a.warn("Blitting from or into a Texture object, forcing mask to GL.COLOR_BUFFER_BIT")()),y(p),o=void 0===o?g.width:o,s=void 0===s?g.height:s,c=void 0===c?T:c,l=void 0===l?R:l;const I=b.bindFramebuffer(U.a.DRAW_FRAMEBUFFER,A),C=b.bindFramebuffer(U.a.READ_FRAMEBUFFER,g.handle);return b.readBuffer(n),b.blitFramebuffer(r,i,o,s,a,u,c,l,p,_),b.readBuffer(S),b.bindFramebuffer(U.a.READ_FRAMEBUFFER,C||null),b.bindFramebuffer(U.a.DRAW_FRAMEBUFFER,I||null),m&&g.delete(),v&&E.delete(),E}function gt(e){return e instanceof wt?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:function(e,t){const{gl:n,width:r,height:i,id:o}=e;return new wt(n,Object.assign({},t,{id:`framebuffer-for-${o}`,width:r,height:i,attachments:{[U.a.COLOR_ATTACHMENT0]:e}}))}(e),deleteFramebuffer:!0}}var mt={[U.a.ALIASED_LINE_WIDTH_RANGE]:{gl1:new Float32Array([1,1])},[U.a.ALIASED_POINT_SIZE_RANGE]:{gl1:new Float32Array([1,1])},[U.a.MAX_TEXTURE_SIZE]:{gl1:64,gl2:2048},[U.a.MAX_CUBE_MAP_TEXTURE_SIZE]:{gl1:16},[U.a.MAX_TEXTURE_IMAGE_UNITS]:{gl1:8},[U.a.MAX_COMBINED_TEXTURE_IMAGE_UNITS]:{gl1:8},[U.a.MAX_VERTEX_TEXTURE_IMAGE_UNITS]:{gl1:0},[U.a.MAX_RENDERBUFFER_SIZE]:{gl1:1},[U.a.MAX_VARYING_VECTORS]:{gl1:8},[U.a.MAX_VERTEX_ATTRIBS]:{gl1:8},[U.a.MAX_VERTEX_UNIFORM_VECTORS]:{gl1:128},[U.a.MAX_FRAGMENT_UNIFORM_VECTORS]:{gl1:16},[U.a.MAX_VIEWPORT_DIMS]:{gl1:new Int32Array([0,0])},[U.a.MAX_3D_TEXTURE_SIZE]:{gl1:0,gl2:256},[U.a.MAX_ARRAY_TEXTURE_LAYERS]:{gl1:0,gl2:256},[U.a.MAX_CLIENT_WAIT_TIMEOUT_WEBGL]:{gl1:0,gl2:0},[U.a.MAX_COLOR_ATTACHMENTS]:{gl1:0,gl2:4},[U.a.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS]:{gl1:0,gl2:0},[U.a.MAX_COMBINED_UNIFORM_BLOCKS]:{gl1:0,gl2:0},[U.a.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS]:{gl1:0,gl2:0},[U.a.MAX_DRAW_BUFFERS]:{gl1:0,gl2:4},[U.a.MAX_ELEMENT_INDEX]:{gl1:0,gl2:0},[U.a.MAX_ELEMENTS_INDICES]:{gl1:0,gl2:0},[U.a.MAX_ELEMENTS_VERTICES]:{gl1:0,gl2:0},[U.a.MAX_FRAGMENT_INPUT_COMPONENTS]:{gl1:0,gl2:0},[U.a.MAX_FRAGMENT_UNIFORM_BLOCKS]:{gl1:0,gl2:0},[U.a.MAX_FRAGMENT_UNIFORM_COMPONENTS]:{gl1:0,gl2:0},[U.a.MAX_SAMPLES]:{gl1:0,gl2:0},[U.a.MAX_SERVER_WAIT_TIMEOUT]:{gl1:0,gl2:0},[U.a.MAX_TEXTURE_LOD_BIAS]:{gl1:0,gl2:0},[U.a.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS]:{gl1:0,gl2:0},[U.a.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS]:{gl1:0,gl2:0},[U.a.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS]:{gl1:0,gl2:0},[U.a.MAX_UNIFORM_BLOCK_SIZE]:{gl1:0,gl2:0},[U.a.MAX_UNIFORM_BUFFER_BINDINGS]:{gl1:0,gl2:0},[U.a.MAX_VARYING_COMPONENTS]:{gl1:0,gl2:0},[U.a.MAX_VERTEX_OUTPUT_COMPONENTS]:{gl1:0,gl2:0},[U.a.MAX_VERTEX_UNIFORM_BLOCKS]:{gl1:0,gl2:0},[U.a.MAX_VERTEX_UNIFORM_COMPONENTS]:{gl1:0,gl2:0},[U.a.MIN_PROGRAM_TEXEL_OFFSET]:{gl1:0,gl2:-8,negative:!0},[U.a.MAX_PROGRAM_TEXEL_OFFSET]:{gl1:0,gl2:7},[U.a.UNIFORM_BUFFER_OFFSET_ALIGNMENT]:{gl1:0,gl2:0}};function Et(e){if(e.luma=e.luma||{},!e.luma.limits){e.luma.limits={},e.luma.webgl1MinLimits={},e.luma.webgl2MinLimits={};const t=L(e);for(const n in mt){const r=mt[n],i=r.gl1,o="gl2"in r?r.gl2:r.gl1,s=t?o:i,a="gl2"in r&&!t||"extension"in r&&!e.getExtension(r.extension)?s:e.getParameter(n);e.luma.limits[n]=a,e.luma.webgl1MinLimits[n]=i,e.luma.webgl2MinLimits[n]=o}}return e.luma.limits}function vt(e){e.luma=e.luma||{};const t=xe(e);return e.luma.info||(e.luma.info={[U.a.UNMASKED_VENDOR_WEBGL]:t.vendor,[U.a.UNMASKED_RENDERER_WEBGL]:t.renderer,[U.a.VENDOR]:t.vendorMasked,[U.a.RENDERER]:t.rendererMasked,[U.a.VERSION]:t.version,[U.a.SHADING_LANGUAGE_VERSION]:t.shadingLanguageVersion}),e.luma.info}function yt(e){return Object.assign(xe(e),{limits:Et(e),info:vt(e),webgl1MinLimits:e.luma.webgl1MinLimits,webgl2MinLimits:e.luma.webgl2MinLimits})}var bt={VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:["WEBGL_color_buffer_float","EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:[!1,"EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};const At={};function Tt(e,t){const n=bt[t];y(n,t);const r=L(e)&&n[1]||n[0],i="string"==typeof r?Boolean(e.getExtension(r)):r;return y(!1===i||!0===i),i}function Rt(e,t){return xt(e,t)}function xt(e,t){return(t=Array.isArray(t)?t:[t]).every(t=>Tt(e,t))}function St(e){if(e.luma=e.luma||{},!e.luma.caps){e.luma.caps={},e.luma.caps.webgl2=L(e);for(const t in bt)e.luma.caps[t]=Tt(e,t)}return e.luma.caps}Object.keys(bt).forEach(e=>{At[e]=e});const It={};function Ct(e,t,n={}){const r=bt[t];if(y(r,t),!function(e={}){const t="undefined"!=typeof window&&window.navigator||{},n=e.userAgent||t.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(t in It)return It[t];const i=`#extension GL_${r[0]} : enable\nvoid main(void) {}`,o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,i),e.compileShader(o);const s=e.getShaderParameter(o,e.COMPILE_STATUS);return e.deleteShader(o),It[t]=s,s}const Nt="Multiple render targets not supported";class wt extends te{static isSupported(e,{colorBufferFloat:t,colorBufferHalfFloat:n}={}){let r=!0;return r=t&&e.getExtension(L(e)?"EXT_color_buffer_float":"WEBGL.color_buffer_float"),r=n&&e.getExtension(L(e)?"EXT_color_buffer_float":"EXT_color_buffer_half_float")}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new wt(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){return this.gl.getParameter(this.gl.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){return this.gl.getParameter(this.gl.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=U.a.COLOR_ATTACHMENT0,this.drawBuffers=[U.a.COLOR_ATTACHMENT0],this.initialize(t),Object.seal(this)}get color(){return this.attachments[U.a.COLOR_ATTACHMENT0]||null}get texture(){return this.attachments[U.a.COLOR_ATTACHMENT0]||null}get depth(){return this.attachments[U.a.DEPTH_ATTACHMENT]||this.attachments[U.a.DEPTH_STENCIL_ATTACHMENT]||null}get stencil(){return this.attachments[U.a.STENCIL_ATTACHMENT]||this.attachments[U.a.DEPTH_STENCIL_ATTACHMENT]||null}initialize({width:e=1,height:t=1,attachments:n=null,color:r=!0,depth:i=!0,stencil:o=!1,check:s=!0,readBuffer:a,drawBuffers:u}){if(y(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,n)for(const r in n){const i=n[r];(Array.isArray(i)?i[0]:i).resize({width:e,height:t})}else n=this._createDefaultAttachments(r,i,o,e,t);this.update({clearAttachments:!0,attachments:n,readBuffer:a,drawBuffers:u}),n&&s&&this.checkStatus()}update({attachments:e={},readBuffer:t,drawBuffers:n,clearAttachments:r=!1,resizeAttachments:i=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:i});const{gl:o}=this,s=o.bindFramebuffer(U.a.FRAMEBUFFER,this.handle);return t&&this._setReadBuffer(t),n&&this._setDrawBuffers(n),o.bindFramebuffer(U.a.FRAMEBUFFER,s||null),this}resize({width:e,height:t}={}){if(null===this.handle)return y(void 0===e&&void 0===t),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===t&&(t=this.gl.drawingBufferHeight),e!==this.width&&t!==this.height&&x.a.log(2,`Resizing framebuffer ${this.id} to ${e}x${t}`)();for(const n in this.attachments)this.attachments[n].resize({width:e,height:t});return this.width=e,this.height=t,this}attach(e,{clearAttachments:t=!1,resizeAttachments:n=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(e=>{r[e]=null}),Object.assign(r,e);const i=this.gl.bindFramebuffer(U.a.FRAMEBUFFER,this.handle);for(const e in r){y(void 0!==e,"Misspelled framebuffer binding point?");const t=Number(e),i=r[t];let o=i;if(o)if(o instanceof Ze)this._attachRenderbuffer({attachment:t,renderbuffer:o});else if(Array.isArray(i)){const[e,n=0,r=0]=i;o=e,this._attachTexture({attachment:t,texture:e,layer:n,level:r})}else this._attachTexture({attachment:t,texture:o,layer:0,level:0});else this._unattach(t);n&&o&&o.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(U.a.FRAMEBUFFER,i||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(e=>!this.attachments[e]).forEach(e=>{delete this.attachments[e]})}checkStatus(){const{gl:e}=this,t=e.bindFramebuffer(U.a.FRAMEBUFFER,this.handle),n=e.checkFramebufferStatus(U.a.FRAMEBUFFER);if(e.bindFramebuffer(U.a.FRAMEBUFFER,t||null),n!==e.FRAMEBUFFER_COMPLETE)throw new Error(function(e){return(wt.STATUS||{})[e]||`Framebuffer error ${e}`}(n));return this}clear({color:e,depth:t,stencil:n,drawBuffers:r=[]}={}){const i=this.gl.bindFramebuffer(U.a.FRAMEBUFFER,this.handle);return(e||t||n)&&at(this.gl,{color:e,depth:t,stencil:n}),r.forEach((e,t)=>{ut({drawBuffer:t,value:e})}),this.gl.bindFramebuffer(U.a.FRAMEBUFFER,i||null),this}readPixels(e={}){return x.a.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return x.a.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return x.a.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return x.a.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return x.a.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return x.a.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:n=0,width:r,height:i}){const{gl:o}=this;B(o);const s=o.bindFramebuffer(U.a.READ_FRAMEBUFFER,this.handle);return 0===t&&0===n&&void 0===r&&void 0===i?o.invalidateFramebuffer(U.a.READ_FRAMEBUFFER,e):o.invalidateFramebuffer(U.a.READ_FRAMEBUFFER,e,t,n,r,i),o.bindFramebuffer(U.a.READ_FRAMEBUFFER,s),this}getAttachmentParameter(e,t,n){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(U.a.FRAMEBUFFER,this.handle),r=this.gl.getFramebufferAttachmentParameter(U.a.FRAMEBUFFER,e,t),this.gl.bindFramebuffer(U.a.FRAMEBUFFER,null)),n&&r>1e3&&(r=J(this.gl,r)),r}getAttachmentParameters(e=U.a.COLOR_ATTACHMENT0,t,n=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const i of n){r[t?J(this.gl,i):i]=this.getAttachmentParameter(e,i,t)}return r}getParameters(e=!0){const t=Object.keys(this.attachments),n={};for(const r of t){const t=Number(r);n[e?J(this.gl,t):t]=this.getAttachmentParameters(t,e)}return n}show(){return"undefined"!=typeof window&&window.open(ht(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>x.a.priority||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const n=ht(this,{maxHeight:100});return x.a.image({priority:e,message:t,image:n},t)(),this}bind({target:e=U.a.FRAMEBUFFER}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=U.a.FRAMEBUFFER}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,n,r,i){let o=null;return e&&((o=o||{})[U.a.COLOR_ATTACHMENT0]=new ze(this.gl,{id:`${this.id}-color0`,pixels:null,format:U.a.RGBA,type:U.a.UNSIGNED_BYTE,width:r,height:i,mipmaps:!1,parameters:{[U.a.TEXTURE_MIN_FILTER]:U.a.NEAREST,[U.a.TEXTURE_MAG_FILTER]:U.a.NEAREST,[U.a.TEXTURE_WRAP_S]:U.a.CLAMP_TO_EDGE,[U.a.TEXTURE_WRAP_T]:U.a.CLAMP_TO_EDGE}})),t&&n?(o=o||{})[U.a.DEPTH_STENCIL_ATTACHMENT]=new Ze(this.gl,{id:`${this.id}-depth-stencil`,format:U.a.DEPTH24_STENCIL8,width:r,height:111}):t?(o=o||{})[U.a.DEPTH_ATTACHMENT]=new Ze(this.gl,{id:`${this.id}-depth`,format:U.a.DEPTH_COMPONENT16,width:r,height:i}):n&&y(!1),o}_unattach(e){const t=this.attachments[e];t&&(t instanceof Ze?this.gl.framebufferRenderbuffer(U.a.FRAMEBUFFER,e,U.a.RENDERBUFFER,null):this.gl.framebufferTexture2D(U.a.FRAMEBUFFER,e,U.a.TEXTURE_2D,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=U.a.COLOR_ATTACHMENT0,renderbuffer:t}){const{gl:n}=this;n.framebufferRenderbuffer(U.a.FRAMEBUFFER,e,U.a.RENDERBUFFER,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=U.a.COLOR_ATTACHMENT0,texture:t,layer:n,level:r}){const{gl:i}=this;switch(i.bindTexture(t.target,t.handle),t.target){case U.a.TEXTURE_2D_ARRAY:case U.a.TEXTURE_3D:i.framebufferTextureLayer(U.a.FRAMEBUFFER,e,t.target,r,n);break;case U.a.TEXTURE_CUBE_MAP:const o=function(e){return e<U.a.TEXTURE_CUBE_MAP_POSITIVE_X?e+U.a.TEXTURE_CUBE_MAP_POSITIVE_X:e}(n);i.framebufferTexture2D(U.a.FRAMEBUFFER,e,o,t.handle,r);break;case U.a.TEXTURE_2D:i.framebufferTexture2D(U.a.FRAMEBUFFER,e,U.a.TEXTURE_2D,t.handle,r);break;default:y(!1,"Illegal texture type")}i.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e,t){L(e)?e.readBuffer(t):y(t===U.a.COLOR_ATTACHMENT0||t===U.a.BACK,Nt),this.readBuffer=t}_setDrawBuffers(e,t){if(L(e))e.drawBuffers(t);else{const n=e.getExtension("WEBGL.draw_buffers");n?n.drawBuffersWEBGL(t):y(1===t.length&&(t[0]===U.a.COLOR_ATTACHMENT0||t[0]===U.a.BACK),Nt)}this.drawBuffers=t}_getAttachmentParameterFallback(e){const t=St(this.gl);switch(e){case U.a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:return t.webgl2?null:0;case U.a.FRAMEBUFFER_ATTACHMENT_RED_SIZE:case U.a.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:case U.a.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:case U.a.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:case U.a.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:case U.a.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:return t.webgl2?null:8;case U.a.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:return t.webgl2?null:U.a.UNSIGNED_INT;case U.a.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:return t.webgl2||t.EXT_sRGB?null:U.a.LINEAR;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(U.a.FRAMEBUFFER,e)}}const Ft=[U.a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME,U.a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE,U.a.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING,U.a.FRAMEBUFFER_ATTACHMENT_RED_SIZE,U.a.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE,U.a.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE,U.a.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE,U.a.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE,U.a.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE];wt.ATTACHMENT_PARAMETERS=Ft;var Mt=n(14),Ot=n.n(Mt);function Lt(e,t){Ot()(e instanceof ze||e instanceof Ye||e instanceof Ke);const n=e.constructor,{gl:r,width:i,height:o,format:s,type:a,dataFormat:u,border:c,mipmaps:l}=e;return new n(r,Object.assign({width:i,height:o,format:s,type:a,dataFormat:u,border:c,mipmaps:l},t))}const Pt="Shader: GLSL source code must be a JavaScript string";class Bt extends te{static getTypeName(e){switch(e){case U.a.VERTEX_SHADER:return"vertex-shader";case U.a.FRAGMENT_SHADER:return"fragment-shader";default:return y(!1),"unknown"}}constructor(e,t){P(e),y("string"==typeof t.source,Pt),super(e,{id:X(t.source,null)||t.id||A(`unnamed ${Bt.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=X(e,null);t&&(this.id=A(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${Bt.getTypeName(this.shaderType)}:${this.id}`}getName(){return X(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL.debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL.debug_shaders not implemented"}_compile(){if(this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(U.a.COMPILE_STATUS)){const e=this.gl.getShaderInfoLog(this.handle),{shaderName:t,errors:n,warnings:r}=$(e,this.source,this.shaderType,this.id);throw x.a.error(`GLSL compilation errors in ${t}\n${n}`)(),x.a.warn(`GLSL compilation warnings in ${t}\n${r}`)(),new Error(`GLSL compilation errors in ${t}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(U.a.SHADER_TYPE),source:this.getSource()}}}class Dt extends Bt{constructor(e,t){"string"==typeof t&&(x.a.deprecated("new FragmentShader(gl, source)","new FragmentShader(gl, {source})","6.1")(),t={source:t}),super(e,Object.assign({},t,{shaderType:U.a.VERTEX_SHADER}))}_createHandle(){return this.gl.createShader(U.a.VERTEX_SHADER)}}class Ut extends Bt{constructor(e,t){"string"==typeof t&&(x.a.deprecated("new FragmentShader(gl, source)","new FragmentShader(gl, {source})","6.1")(),t={source:t}),super(e,Object.assign({},t,{shaderType:U.a.FRAGMENT_SHADER}))}_createHandle(){return this.gl.createShader(U.a.FRAGMENT_SHADER)}}class kt extends te{static isSupported(e){return L(e)}constructor(e,t){B(e),super(e,t),Object.seal(this)}bind(e){return this.gl.bindSampler(e,this.handle),this}unbind(e){return this.gl.bindSampler(e,null),this}_createHandle(){return this.gl.createSampler()}_deleteHandle(){this.gl.deleteSampler(this.handle)}_getParameter(e){return this.gl.getSamplerParameter(this.handle,e)}_setParameter(e,t){switch(e){case U.a.TEXTURE_MIN_LOD:case U.a.TEXTURE_MAX_LOD:this.gl.samplerParameterf(this.handle,e,t);break;default:this.gl.samplerParameteri(this.handle,e,t)}return this}}const Gt={[U.a.FLOAT]:(e,t,n)=>e.uniform1fv(t,zt(n,1)),[U.a.FLOAT_VEC2]:(e,t,n)=>e.uniform2fv(t,zt(n,2)),[U.a.FLOAT_VEC3]:(e,t,n)=>e.uniform3fv(t,zt(n,3)),[U.a.FLOAT_VEC4]:(e,t,n)=>e.uniform4fv(t,zt(n,4)),[U.a.INT]:(e,t,n)=>e.uniform1iv(t,Wt(n,1)),[U.a.INT_VEC2]:(e,t,n)=>e.uniform2iv(t,Wt(n,2)),[U.a.INT_VEC3]:(e,t,n)=>e.uniform3iv(t,Wt(n,3)),[U.a.INT_VEC4]:(e,t,n)=>e.uniform4iv(t,Wt(n,4)),[U.a.BOOL]:(e,t,n)=>e.uniform1iv(t,Wt(n,1)),[U.a.BOOL_VEC2]:(e,t,n)=>e.uniform2iv(t,Wt(n,2)),[U.a.BOOL_VEC3]:(e,t,n)=>e.uniform3iv(t,Wt(n,3)),[U.a.BOOL_VEC4]:(e,t,n)=>e.uniform4iv(t,Wt(n,4)),[U.a.FLOAT_MAT2]:(e,t,n)=>e.uniformMatrix2fv(t,!1,zt(n,4)),[U.a.FLOAT_MAT3]:(e,t,n)=>e.uniformMatrix3fv(t,!1,zt(n,9)),[U.a.FLOAT_MAT4]:(e,t,n)=>e.uniformMatrix4fv(t,!1,zt(n,16)),[U.a.SAMPLER_2D]:(e,t,n)=>e.uniform1i(t,n),[U.a.SAMPLER_CUBE]:(e,t,n)=>e.uniform1i(t,n),[U.a.UNSIGNED_INT]:(e,t,n)=>e.uniform1uiv(t,Yt(n,1)),[U.a.UNSIGNED_INT_VEC2]:(e,t,n)=>e.uniform2uiv(t,Yt(n,2)),[U.a.UNSIGNED_INT_VEC3]:(e,t,n)=>e.uniform3uiv(t,Yt(n,3)),[U.a.UNSIGNED_INT_VEC4]:(e,t,n)=>e.uniform4uiv(t,Yt(n,4)),[U.a.FLOAT_MAT2x3]:(e,t,n)=>e.uniformMatrix2x3fv(t,!1,zt(n,6)),[U.a.FLOAT_MAT2x4]:(e,t,n)=>e.uniformMatrix2x4fv(t,!1,zt(n,8)),[U.a.FLOAT_MAT3x2]:(e,t,n)=>e.uniformMatrix3x2fv(t,!1,zt(n,6)),[U.a.FLOAT_MAT3x4]:(e,t,n)=>e.uniformMatrix3x4fv(t,!1,zt(n,12)),[U.a.FLOAT_MAT4x2]:(e,t,n)=>e.uniformMatrix4x2fv(t,!1,zt(n,8)),[U.a.FLOAT_MAT4x3]:(e,t,n)=>e.uniformMatrix4x3fv(t,!1,zt(n,12)),[U.a.SAMPLER_3D]:(e,t,n)=>e.uniform1i(t,n),[U.a.SAMPLER_2D_SHADOW]:(e,t,n)=>e.uniform1i(t,n),[U.a.SAMPLER_2D_ARRAY]:(e,t,n)=>e.uniform1i(t,n),[U.a.SAMPLER_2D_ARRAY_SHADOW]:(e,t,n)=>e.uniform1i(t,n),[U.a.SAMPLER_CUBE_SHADOW]:(e,t,n)=>e.uniform1i(t,n),[U.a.INT_SAMPLER_2D]:(e,t,n)=>e.uniform1i(t,n),[U.a.INT_SAMPLER_3D]:(e,t,n)=>e.uniform1i(t,n),[U.a.INT_SAMPLER_CUBE]:(e,t,n)=>e.uniform1i(t,n),[U.a.INT_SAMPLER_2D_ARRAY]:(e,t,n)=>e.uniform1i(t,n),[U.a.UNSIGNED_INT_SAMPLER_2D]:(e,t,n)=>e.uniform1i(t,n),[U.a.UNSIGNED_INT_SAMPLER_3D]:(e,t,n)=>e.uniform1i(t,n),[U.a.UNSIGNED_INT_SAMPLER_CUBE]:(e,t,n)=>e.uniform1i(t,n),[U.a.UNSIGNED_INT_SAMPLER_2D_ARRAY]:(e,t,n)=>e.uniform1i(t,n)},jt={},Vt={},Ht={},Xt=[0];function $t(e,t,n,r){1===t&&"boolean"==typeof e&&(e=e?1:0),Number.isFinite(e)&&(Xt[0]=e,e=Xt);const i=e.length;if(i%t&&x.a.warn(`Uniform size should be multiples of ${t}`,e)(),e instanceof n)return e;let o=r[i];o||(o=new n(i),r[i]=o);for(let t=0;t<i;t++)o[t]=e[t];return o}function zt(e,t){return $t(e,t,Float32Array,jt)}function Wt(e,t){return $t(e,t,Int32Array,Vt)}function Yt(e,t){return $t(e,t,Uint32Array,Ht)}function Kt(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=e.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function qt(e,t,n){const r=Gt[n.type];if(!r)throw new Error(`Unknown GLSL uniform type ${n.type}`);return r.bind(null,e,t)}function Qt(e){return Array.isArray(e)||ArrayBuffer.isView(e)?function(e){if(0===e.length)return!1;const t=Math.min(e.length,16);for(let n=0;n<t;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e):!!isFinite(e)||(!0===e||!1===e||(e instanceof je||e instanceof kt||(e instanceof Ze||e instanceof wt&&Boolean(e.texture))))}function Zt(e,t){if(Array.isArray(e)||ArrayBuffer.isView(e)){if(!t)return!1;const n=e.length;if(t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return e===t}function Jt(e){return Array.isArray(e)||ArrayBuffer.isView(e)?e.slice():e}const en=5120,tn=5121,nn=5122,rn=5123,on=0,sn=1,an=2,un=3,cn=4,ln=5,fn=6,hn=5126,dn={[hn]:[hn,1,"float"],35664:[hn,2,"vec2"],35665:[hn,3,"vec3"],35666:[hn,4,"vec4"],5124:[5124,1,"int"],35667:[5124,2,"ivec2"],35668:[5124,3,"ivec3"],35669:[5124,4,"ivec4"],5125:[5125,1,"uint"],36294:[5125,2,"uvec2"],36295:[5125,3,"uvec3"],36296:[5125,4,"uvec4"],35670:[hn,1,"bool"],35671:[hn,2,"bvec2"],35672:[hn,3,"bvec3"],35673:[hn,4,"bvec4"],35674:[hn,8,"mat2"],35685:[hn,8,"mat2x3"],35686:[hn,8,"mat2x4"],35675:[hn,12,"mat3"],35687:[hn,12,"mat3x2"],35688:[hn,12,"mat3x4"],35676:[hn,16,"mat4"],35689:[hn,16,"mat4x2"],35690:[hn,16,"mat4x3"]};function pn(e){switch(e){case on:return on;case sn:case un:case an:return sn;case cn:case ln:case fn:return cn;default:return y(!1),0}}function _n(e){const t=dn[e];if(!t)return null;const[n,r]=t;return{type:n,components:r}}function gn(e,t){switch(e){case en:case tn:case nn:case rn:e=hn}for(const n in dn){const[r,i,o]=dn[n];if(r===e&&i===t)return{glType:n,name:o}}return null}class mn{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfos[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,n=t.getProgramParameter(e.handle,t.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=t.getActiveAttrib(e.handle,r),s=t.getAttribLocation(e.handle,n);s>=0&&this._addAttribute(s,n,i,o)}this.attributeInfos.sort((e,t)=>e.location-t.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!L(t))return;const n=t.getProgramParameter(e.handle,t.TRANSFORM_FEEDBACK_VARYINGS);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,n,i,o)}this.varyingInfos.sort((e,t)=>e.location-t.location)}_addAttribute(e,t,n,r){const{type:i,components:o}=_n(n),s={type:i,size:r*o};this._inferProperties(e,t,s);const a={location:e,name:t,accessor:new ie(s)};this.attributeInfos.push(a),this.attributeInfosByName[a.name]=a}_inferProperties(e,t,n){/instance/i.test(t)&&(n.divisor=1)}_addVarying(e,t,n,r){const{type:i,components:o}=_n(n),s={location:e,name:t,accessor:new ie({type:i,size:r*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}const En=4,vn=35981,yn=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class bn extends te{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",yn),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{vs:t,fs:n,varyings:r,bufferMode:i=vn}=e;return this.vs="string"==typeof t?new Dt(this.gl,{id:`${e.id}-vs`,source:t}):t,this.fs="string"==typeof n?new Ut(this.gl,{id:`${e.id}-fs`,source:n}):n,y(this.vs instanceof Dt),y(this.fs instanceof Ut),this.uniforms={},this.samplers={},r&&(B(this.gl),this.varyings=r,this.gl.transformFeedbackVaryings(this.handle,r,i)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new mn(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms,e.samplers),this}draw({logPriority:e,drawMode:t=U.a.TRIANGLES,vertexCount:n,offset:r=0,start:i,end:o,isIndexed:s=!1,indexType:a=U.a.UNSIGNED_SHORT,isInstanced:u=!1,instanceCount:c=0,vertexArray:l=null,transformFeedback:f,framebuffer:h,parameters:d={},uniforms:p={},samplers:_={}}){if(void 0!==e){const r=h?h.id:"default",i=`mode=${J(this.gl,t)} verts=${n} `+`instances=${c} indexType=${J(this.gl,a)} `+`isInstanced=${u} isIndexed=${s} `+`Framebuffer=${r}`;x.a.log(e,i)()}return y(l),this.gl.useProgram(this.handle),p&&(x.a.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(p,_)),!!this._areTexturesRenderable()&&(l.bindForDraw(n,c,()=>{if(void 0!==h&&(d=Object.assign({},d,{framebuffer:h})),f){const e=pn(t);f.begin(e)}this._bindTextures(),me(this.gl,d,()=>{s&&u?this.gl.drawElementsInstanced(t,n,a,r,c):s&&L(this.gl)&&!isNaN(i)&&!isNaN(o)?this.gl.drawRangeElements(t,i,o,n,a,r):s?this.gl.drawElements(t,n,a,r):u?this.gl.drawArraysInstanced(t,r,n,c):this.gl.drawArrays(t,r,n)}),f&&f.end()}),!0)}setSamplers(e){Object.assign(this.samplers,e)}setUniforms(e={},t={},n=(()=>{})){let r=!1;const i={};for(const t in e)Zt(this.uniforms[t],e[t])||(r=!0,i[t]=e[t],this.uniforms[t]=Jt(e[t]));return r&&(n(),function(e,t,n){for(const r in e){const i=e[r];if((!n||Boolean(n[r]))&&!Qt(i))throw t=t?`${t} `:"",console.error(`${t} Bad uniform ${r}`,i),new Error(`${t} Bad uniform ${r}`)}}(i,this.id,this._uniformSetters),Object.assign(this.samplers,t),this._setUniforms(i)),this}reset(){}_areTexturesRenderable(){let e=!0;for(const t in this.uniforms){const n=this._uniformSetters[t];if(n&&void 0!==n.textureIndex){let n=this.uniforms[t];if(n instanceof wt){n=n.texture}if(n instanceof je){e=e&&n.loaded}}}return e}_bindTextures(){for(const e in this.uniforms){const t=this._uniformSetters[e];if(t&&void 0!==t.textureIndex){let n=this.uniforms[e];const r=this.samplers[e];if(n instanceof wt&&(n=n.texture),n instanceof je){n.bind(t.textureIndex)}r&&r.bind(t.textureIndex)}}}_setUniforms(e){this.gl.useProgram(this.handle);for(const t in e){let n=e[t];const r=this._uniformSetters[t];if(r)if(n instanceof wt&&(n=n.texture),n instanceof je){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const e=n,{textureIndex:t}=r;e.bind(t),r(t)}else r(n)}return this}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),n={};for(const e of t){switch(this.gl.getShaderParameter(this.handle,U.a.SHADER_TYPE)){case U.a.VERTEX_SHADER:n.vs=new Dt({handle:e});break;case U.a.FRAGMENT_SHADER:n.fs=new Ut({handle:e})}}return n}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const e=this._getName();this.id=A(e)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=(e=e.replace(/shader/i,""))?`${e}-program`:"program"}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),x.a.time(En,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),x.a.timeEnd(En,`linkProgram for ${this._getName()}`)(),e.debug||x.a.priority>0){if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,e.LINK_STATUS))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(U.a.ACTIVE_UNIFORMS);for(let t=0;t<this._uniformCount;t++){const n=this.gl.getActiveUniform(this.handle,t),{name:r,isArray:i}=Kt(n.name),o=e.getUniformLocation(this.handle,r);this._uniformSetters[r]=qt(e,o,n)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl.uniformBlockBinding(this.handle,e,t)}}class An extends te{constructor(e,t){B(e),super(e,t),this.promise=null,Object.seal(this)}wait({flags:e=0,timeout:t=U.a.TIMEOUT_IGNORED}={}){return this.gl.waitSync(this.handle,e,t),this}clientWait({flags:e=U.a.SYNC_FLUSH_COMMANDS_BIT,timeout:t}){const n=this.gl.clientWaitSync(this.handle,e,t);switch(n){case U.a.ALREADY_SIGNALED:case U.a.TIMEOUT_EXPIRED:case U.a.CONDITION_SATISFIED:case U.a.WAIT_FAILED:}return n}cancel(){Ne.cancelQuery(this)}isSignaled(){return this.getParameter(U.a.SYNC_STATUS)===U.a.SIGNALED}isResultAvailable(){return this.isSignaled()}getResult(){return this.isSignaled()}getParameter(e){return this.gl.getSyncParameter(this.handle,e)}_createHandle(){return this.gl.fenceSync(U.a.SYNC_GPU_COMMANDS_COMPLETE,0)}_deleteHandle(){Ne.deleteQuery(this),this.gl.deleteSync(this.handle)}}const Tn=e=>e,Rn='Timer queries require "EXT_disjoint_timer_query" extension',xn=34916,Sn=34918,In=34919,Cn=35007,Nn=36392,wn=35976,Fn=35887,Mn=36202;class On extends te{static isSupported(e,t=[]){const n=L(e),r=xt(e,At.TIMER_QUERY);let i=n||r;for(const o of t)switch(o){case"queries":i=i&&n;break;case"timers":i=i&&r;break;case"timestamps":const t=r?e.getQuery(Nn,xn):0;i=i&&t>0;break;default:y(!1)}return i}constructor(e,t={}){super(e,t);const{onComplete:n=Tn,onError:r=Tn}=t;this.target=null,this.onComplete=n,this.onError=r,this.promise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(Cn)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?Mn:Fn)}beginTransformFeedbackQuery(){return this.begin(wn)}getTimestamp(){Ne.beginQuery(this,this.onComplete,this.onError);try{this.gl.queryCounter(this.handle,Nn)}catch(e){Ne.rejectQuery(this,Rn)}return this}begin(e){Ne.beginQuery(this,this.onComplete,this.onError),this.target=e;try{this.gl.beginQuery(this.target,this.handle)}catch(e){Ne.rejectQuery(this,"Query not supported")}return this}end(){return this.target&&(this.gl.endQuery(this.target),this.target=null),this}cancel(){return this.end(),Ne.cancelQuery(this),this}isResultAvailable(){return this.gl.getQueryParameter(this.handle,In)}getResult(){const e=this.gl.getQueryParameter(this.handle,Sn);return Number.isFinite(e)?e/1e6:0}static poll(e){Ne.poll(e)}_createHandle(){return On.isSupported(this.gl)?this.gl.createQuery():null}_deleteHandle(){Ne.deleteQuery(this),this.gl.deleteQuery(this.handle)}}Ne.setInvalidator({queryType:On,errorMessage:"Disjoint GPU operation invalidated timer queries",checkInvalid:e=>e.getParameter(36795)});class Ln extends je{static isSupported(e){return L(e)}constructor(e,t={}){throw super(e,t),new Error("Texture2DArray not yet implemented")}}class Pn extends te{static isSupported(e){return L(e)}constructor(e,t={}){B(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,R(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:r,byteSize:i,byteOffset:o}=this._getBufferParams(t);return n<0?(this.unused[e]=r,x.a.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[n]=t,this.bindOnUse||this._bindBuffer(n,r,o,i),this)}begin(e=U.a.POINTS){return this.gl.bindTransformFeedback(U.a.TRANSFORM_FEEDBACK,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(U.a.TRANSFORM_FEEDBACK,null),this}_getBufferParams(e){let t,n,r;return e instanceof ce==!1?(r=e.buffer,n=e.byteSize,t=e.byteOffset):r=e,void 0===t&&void 0===n||(t=t||0,n=n||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:n}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:n,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,n)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,n=0,r){const i=t&&t.handle;return i&&void 0!==r?this.gl.bindBufferRange(U.a.TRANSFORM_FEEDBACK_BUFFER,e,i,n,r):this.gl.bindBufferBase(U.a.TRANSFORM_FEEDBACK_BUFFER,e,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(U.a.TRANSFORM_FEEDBACK,this.handle)}}let Bn=null;function Dn(e,t){return new e(function(e){return(!Bn||Bn.byteLength<e)&&(Bn=new ArrayBuffer(e)),Bn}(e.BYTES_PER_ELEMENT*t),0,t)}var Un=n(32);const kn="OES_vertex_array_object",Gn="elements must be GL.ELEMENT_ARRAY_BUFFER";class jn extends te{static isSupported(e,t={}){return t.constantAttributeZero?L(e)||"Chrome"===Object(Un.b)():L(e)||e.getExtension(kn)}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new jn(e,{handle:null})),e.luma.defaultVertexArray}static getMaxAttributes(e){return jn.MAX_ATTRIBUTES=jn.MAX_ATTRIBUTES||e.getParameter(e.MAX_VERTEX_ATTRIBS),jn.MAX_ATTRIBUTES}static setConstant(e,t,n){switch(n.constructor){case Float32Array:jn._setConstantFloatArray(e,t,n);break;case Int32Array:jn._setConstantIntArray(e,t,n);break;case Uint32Array:jn._setConstantUintArray(e,t,n);break;default:y(!1)}}constructor(e,t={}){const n=t.id||t.program&&t.program.id;super(e,Object.assign({},t,{id:n})),this.hasVertexArrays=jn.isSupported(e),this.buffer=null,this.bufferValue=null,this.initialize(t),Object.seal(this)}delete(){super.delete(),this.buffer&&this.buffer.delete()}get MAX_ATTRIBUTES(){return jn.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return y(!e||e.target===U.a.ELEMENT_ARRAY_BUFFER,Gn),this.bind(()=>{this.gl.bindBuffer(U.a.ELEMENT_ARRAY_BUFFER,e?e.handle:null)}),this}setBuffer(e,t,n){if(t.target===U.a.ELEMENT_ARRAY_BUFFER)return this.setElementBuffer(t,n);const{size:r,type:i,stride:o,offset:s,normalized:a,integer:u,divisor:c}=n,{gl:l}=this;return e=Number(e),this.bind(()=>{l.bindBuffer(l.ARRAY_BUFFER,t.handle),u?(y(L(l)),l.vertexAttribIPointer(e,r,i,o,s)):l.vertexAttribPointer(e,r,i,a,o,s),l.enableVertexAttribArray(e),l.vertexAttribDivisor(e,c||0)}),this}enable(e,t=!0){return!t&&0===e&&!jn.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t,n){const r=this._normalizeConstantArrayValue(t,n),i=r.byteLength*e,o=r.length*e;let s=!this.buffer;if(this.buffer=this.buffer||new ce(this.gl,i),s=(s=s||this.buffer.setByteLength(i))||!this._compareConstantArrayValues(r,this.bufferValue)){const e=Dn(t.constructor,o);!function({target:e,source:t,start:n=0,count:r=1}){const i=t.length,o=r*i;let s=0;for(let r=n;s<i;s++)e[r++]=t[s];for(;s<o;)s<o-s?(e.copyWithin(n+s,n,n+s),s*=2):(e.copyWithin(n+s,n,n+o-s),s=o)}({target:e,source:r,start:0,count:o}),this.buffer.subData(e),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e,t){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}static _setConstantFloatArray(e,t,n){switch(n.length){case 1:e.vertexAttrib1fv(t,n);break;case 2:e.vertexAttrib2fv(t,n);break;case 3:e.vertexAttrib3fv(t,n);break;case 4:e.vertexAttrib4fv(t,n);break;default:y(!1)}}static _setConstantIntArray(e,t,n){switch(y(L(e)),n.length){case 1:e.vertexAttribI1iv(t,n);break;case 2:e.vertexAttribI2iv(t,n);break;case 3:e.vertexAttribI3iv(t,n);break;case 4:e.vertexAttribI4iv(t,n);break;default:y(!1)}}static _setConstantUintArray(e,t,n){switch(y(L(e)),n.length){case 1:e.vertexAttribI1uiv(t,n);break;case 2:e.vertexAttribI2uiv(t,n);break;case 3:e.vertexAttribI3uiv(t,n);break;case 4:e.vertexAttribI4uiv(t,n);break;default:y(!1)}}_createHandle(){return this.hasVertexArrays=jn.isSupported(this.gl),this.hasVertexArrays?this.gl.createVertexArray():null}_deleteHandle(e){return this.hasVertexArrays&&this.gl.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.hasVertexArrays&&this.gl.bindVertexArray(e)}_getParameter(e,{location:t}){return y(Number.isFinite(t)),this.bind(()=>{switch(e){case U.a.VERTEX_ATTRIB_ARRAY_POINTER:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const Vn="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Hn=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Xn{constructor(e,t={}){const n=t.id||t.program&&t.program.id;this.id=n,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.vertexArrayObject=jn.isSupported(e)?new jn(e):jn.getDefaultArray(e),I(this,"VertexArray","v6.0",Hn),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(e){return this.drawParams=this.drawParams||this._updateDrawParams(),Object.assign({},this.drawParams,e)}setAttributes(e){return this.vertexArrayObject.bind(()=>{for(const t in e){const n=e[t];this._setAttribute(t,n)}this.gl.bindBuffer(U.a.ARRAY_BUFFER,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,n={}){if(t.target===U.a.ELEMENT_ARRAY_BUFFER)return this.setElementBuffer(t,n);const{location:r,accessor:i}=this._resolveLocationAndAccessor(e,t,t.accessor,n);return r>=0&&(this.values[r]=t,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.setBuffer(r,t,i)),this}setConstant(e,t,n={}){const{location:r,accessor:i}=this._resolveLocationAndAccessor(e,t,n);return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t,i),this.values[r]=t,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(null),this.buffer=this.buffer||new ce(this.gl,{size:4});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ce&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(U.a.ARRAY_BUFFER,this.buffer.handle),this.gl.vertexAttribPointer(e,1,U.a.FLOAT,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof ce&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,n){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),this.vertexArrayObject.hasVertexArrays||this.bindBuffers(),r=n(),this.vertexArrayObject.hasVertexArrays||this.unbindBuffers()}),r}_resolveLocationAndAccessor(e,t,n,r){const i=this._getAttributeIndex(e);if(!Number.isFinite(i)||i<0)return this.unused[e]=t,x.a.once(3,()=>`unused value ${e} in ${this.id}`)(),this;const o=this._getAttributeInfo(e),s=ie.resolve(o.accessor,n,r),{size:a,type:u}=s;return y(Number.isFinite(a)&&Number.isFinite(u)),{location:i,accessor:s}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){if(this.configuration)return this.configuration.getAttributeLocation(e);const t=Number(e);return Number.isFinite(t)?t:-1}_setAttribute(e,t){if(t instanceof ce)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof ce){const n=t[0],r=t[1];this.setBuffer(e,n,r)}else if(ArrayBuffer.isView(t)||Array.isArray(t)){const n=t;this.setConstant(e,n)}else{if(!(t.buffer instanceof ce))throw new Error(Vn);{const n=t;this.setBuffer(e,n.buffer,n)}}}_setConstantAttributes(e,t){const n=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(let e=1;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)r=this.values[e],ArrayBuffer.isView(r)&&this._setConstantAttribute(e,r)}_setConstantAttributeZero(e,t){if(jn.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const n=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(e,t){jn.setConstant(this.gl,e,t),this.vertexArrayObject.isDefault&&this.vertexArrayObject.enable(e,!1)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const n=this.values[t],r=this.accessors[t];if(!n)return;const{divisor:i}=r,o=i>0;if(e.isInstanced=e.isInstanced||o,n instanceof ce){const t=n;if(o){const n=t.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,n)}else{const n=t.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,n)}}}setElements(e=null,t={}){return x.a.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}const $n="UniformBufferLayout illegal argument",zn=5126,Wn=5124,Yn=5125;class Kn{constructor(e){this.layout={},this.size=0;for(const t in e)this._addUniform(t,e[t]);const t=new Float32Array(this.size);this.typedArray={[zn]:t,[Wn]:new Int32Array(t.buffer),[Yn]:new Uint32Array(t.buffer)}}getBytes(){return 4*this.size}getData(){return this.typedArray[zn]}getSubData(e){let t,n;if(void 0===e)t=this.data,n=0;else{const r=this.offsets[e],i=r+this.sizes[e];t=this.data.subarray(r,i),n=4*r}return{data:t,offset:n}}setUniforms(e){for(const t in e)this._setValue(t,e[t]);return this}_setValue(e,t){const n=this.layout[e];y(n,"UniformLayoutStd140 illegal argument");const r=this.typedArray[n.type];1===n.size?r[n.offset]=t:r.set(t,n.offset)}_addUniform(e,t){const n=_n(t);y(n,$n);const{type:r,components:i}=n;this.size=this._alignTo(this.size,i);const o=this.size;this.size+=i,this.layout[e]={type:r,size:i,offset:o}}_alignTo(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}}const qn={preserveDrawingBuffer:!0};class Qn{constructor(e={}){const{onCreateContext:t=(e=>Be(e)),onAddHTML:n=null,onInitialize:r=(()=>{}),onRender:i=(()=>{}),onFinalize:o=(()=>{}),gl:s=null,glOptions:a={},debug:u=!1,createFramebuffer:c=!1,autoResizeViewport:l=!0,autoResizeDrawingBuffer:f=!0}=e;let{useDevicePixels:h=!0}=e;return"useDevicePixelRatio"in e&&(x.a.deprecated("useDevicePixelRatio","useDevicePixels")(),h=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:n,onInitialize:r,onRender:i,onFinalize:o,gl:s,glOptions:a,debug:u,createFramebuffer:c},this.gl=s,this.needsRedraw=null,this.setProps({autoResizeViewport:l,autoResizeDrawingBuffer:f,useDevicePixels:h}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._renderFrame=this._renderFrame.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this),this}setNeedsRedraw(e){return y("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){return this._stopped=!1,this._animationFrameId||(this._startPromise=Te().then(()=>this._stopped?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this.onInitialize(this.animationProps))).then(e=>{this._stopped||(this._addCallbackData(e||{}),!1===e||this._animationFrameId||(this._animationFrameId=G(this._renderFrame)))})),this}redraw(){return this._setupFrame(),this._updateCallbackData(),this.onRender(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this}stop(){return this._animationFrameId&&(this._finalizeCallbackData(),j(this._animationFrameId),this._animationFrameId=null,this._stopped=!0),this}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const n=document.getElementById(e);return n?Number(n.value):t}setViewParameters(){return x.a.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._onSetupFrame?this._onSetupFrame(this.animationProps):(this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer())}_renderFrame(){this._stopped||(this.redraw(),this._animationFrameId=G(this._renderFrame))}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),time:0,tick:0,tock:0,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.time=Date.now()-this.animationProps.startTime,this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,qn,this.props.glOptions),this.gl=this.props.gl||this.onCreateContext(e),!O(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Object(fe.d)(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let n=1;const{clientWidth:r,clientHeight:i}=this.gl.canvas;return r>=0&&i>=0?n=t>0?r/i:1:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&Ue(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new wt(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_startEventHandling(){this.gl.canvas.addEventListener("mousemove",this._onMousemove),this.gl.canvas.addEventListener("mouseleave",this._onMouseleave)}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Zn={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};function Jn(e){const t="string"==typeof e?Zn[e]||Zn.TRIANGLES:e;return y(t>=0&&t<=Zn.TRIANGLE_FAN,"Illegal drawMode"),t}class er{constructor(e={}){const{id:t,drawMode:n=Zn.TRIANGLES,vertexCount:r,attributes:i}=e;this.id=t||A(this.constructor.name),this.drawMode=Jn(n),this.vertexCount=r,this.attributes={},this.needsRedraw=!0,this.userData={},Object.seal(this),i&&this.setAttributes(i)}setNeedsRedraw(e=!0){return this.needsRedraw=e,this}getNeedsRedraw({clearRedrawFlags:e=!1}={}){let t=!1;return t=t||this.needsRedraw,this.needsRedraw=this.needsRedraw&&!e,t}setVertexCount(e){this.vertexCount=e}getVertexCount(){return void 0!==this.vertexCount?this.vertexCount:this.attributes.indices?this.attributes.indices.value.length:this.attributes.vertices?this.attributes.vertices.value.length/3:!!this.attributes.positions&&this.attributes.positions.value.length/3}hasAttribute(e){return Boolean(this.attributes[e])}getAttribute(e){const t=this.attributes[e];return y(t),t.value}getArray(e){const t=this.attributes[e];return y(t),t.value}getAttributes(){return this.attributes}setAttributes(e){for(const t in e){let n=e[t];n=ArrayBuffer.isView(n)?{value:n}:n,y(ArrayBuffer.isView(n.value),`${this._print(t)}: must be typed array or object with value as typed array`),this._autoDetectAttribute(t,n),this.attributes[t]=n}return this.setNeedsRedraw(),this}_autoDetectAttribute(e,t){let n;switch(e){case"indices":n=n||"indices";break;case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2;break;case"indices":t.size=t.size||1,t.isIndexed=void 0===t.isIndexed||t.isIndexed,y(t.value instanceof Uint16Array||t.value instanceof Uint32Array,'attribute array for "indices" must be of integer type')}y(t.size,`attribute ${e} needs size`)}_print(e){return`Geometry ${this.id} attribute ${e}`}}class tr{constructor(e={}){e=Array.isArray(e)?{primitives:e}:e;const{primitives:t=[]}=e;this.primitives=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.primitives.push(t);return this}remove(e){const t=this.primitives.indexOf(e);return t>-1&&this.primitives.splice(t,1),this}removeAll(){return this.primitives=[],this}}var nr=n(4);class rr{constructor({id:e,display:t=!0}){this.id=e||A(this.constructor.name),this.display=!0,this.position=new nr.Vector3,this.rotation=new nr.Vector3,this.scale=new nr.Vector3(1,1,1),this.matrix=new nr.Matrix4,this.userData={}}toString(){return`{id: ${this.id}, children: ${this.children})}`}setPosition(e){return y(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return y(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return y(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:n,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),n&&this.setScale(n),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(n),this}update({position:e,rotation:t,scale:n}={}){return e&&this.setPosition(e),t&&this.setRotation(t),n&&this.setScale(n),this.updateMatrix(),this}getCoordinateUniforms(e,t){y(e),t=t||this.matrix;const n=new nr.Matrix4(e).multiplyRight(t),r=n.invert();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:r.transpose()}}transform(){if(this.parent){const e=this.parent;this.endPosition.set(this.position.add(e.endPosition)),this.endRotation.set(this.rotation.add(e.endRotation)),this.endScale.set(this.scale.add(e.endScale))}else this.endPosition.set(this.position),this.endRotation.set(this.rotation),this.endScale.set(this.scale);const e=this.children;for(let t=0;t<e.length;++t)e[t].transform();return this}}class ir extends rr{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;t.every(e=>y(e instanceof rr)),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,n=t.indexOf(e);return n>-1&&t.splice(n,1),this}removeAll(){return this.children=[],this}traverse(e,{worldMatrix:t=new nr.Matrix4}={}){const n=new nr.Matrix4(t).multiplyRight(this.matrix);for(const t of this.children)t instanceof ir?t.traverse(e,{worldMatrix:n}):e(t,{worldMatrix:n})}traverseReverse(e,t){return x.a.warn("traverseReverse is not reverse")(),this.traverse(e,t)}}function or(e,t){const{models:n,position:r,uniforms:i={},parameters:o={},settings:s,useDevicePixels:a=!0,framebuffer:u,context:c}=t;y(Me(e)&&u&&r);const[l,f]=r;u.resize({width:e.canvas.width,height:e.canvas.height});const h=a&&"undefined"!=typeof window?window.devicePixelRatio:1,d=l*h,p=e.canvas.height-f*h;return new ir({children:n}).traverseReverse(n=>{if(n.pickable){at(e,{framebuffer:u,color:!0,depth:!0}),n.setUniforms({picking_uActive:1}),n.draw(Object.assign({},t,{uniforms:i,parameters:o,settings:s,framebuffer:u,context:c})),n.setUniforms({picking_uActive:0});const r=lt(u,{sourceX:d,sourceY:p,sourceWidth:1,sourceHeight:1,sourceFormat:e.RGBA,sourceType:e.UNSIGNED_BYTE});if(0!==r[0]||0!==r[1]||0!==r[2])return{model:n,color:r,x:l,y:f,deviceX:d,deviceY:p}}return null})}const sr=new Uint8Array([0,0,0]);function ar(e){return[e+1&255,e+1>>8&255,e+1>>16&255]}function ur(e){const[t,n,r]=e;return t+256*n+65536*r-1}function cr(){return sr}var lr=n(1),fr=n(22),hr=n.n(fr);const dr={},pr=e=>{dr[e.id]||(dr[e.id]=e,hr.a.listItem("luma.gl",e.id))},_r=(e,t)=>{if(!hr.a.isReady()||hr.a.throttle(`luma.gl:${e.id}`,1e3))return;const n=e.geometry?Object.assign({},e.geometry.attributes,e.attributes):e.attributes,r=Object.assign({},e.uniforms,t);hr.a.multiUpdate("luma.gl",e.id,[{path:"objects.uniforms",data:r},{path:"objects.attributes",data:n}])},gr=e=>{delete dr[e],hr.a.deleteItem("luma.gl",e)},mr=(e,t,n)=>{e&&(t.length>1?mr(e[t[0]],t.slice(1),n):e[t[0]]=n)},Er=new Map,vr=(e,t)=>{if(!r.b.__SEER_INITIALIZED__||!e)return;const n=Er.get(e);n&&n.forEach((e,n)=>{mr(t,n,e)})};function yr({header:e="Uniforms",program:t,uniforms:n,undefinedOnly:r=!1}={}){y(t);const i=t._uniformSetters,o={},s=Object.keys(i).sort();let a=0;for(const t of s)t.match(".*_.*")||t.match(".*Matrix")||br({table:o,header:e,uniforms:n,uniformName:t,undefinedOnly:r})&&a++;for(const t of s)t.match(".*Matrix")&&br({table:o,header:e,uniforms:n,uniformName:t,undefinedOnly:r})&&a++;for(const t of s)o[t]||br({table:o,header:e,uniforms:n,uniformName:t,undefinedOnly:r})&&a++;let u=0;const c={};if(!r)for(const t in n){const r=n[t];o[t]||(u++,c[t]={Type:`NOT USED: ${r}`,[e]:S(r)})}return{table:o,count:a,unusedTable:c,unusedCount:u}}function br({table:e,header:t,uniforms:n,uniformName:r,undefinedOnly:i}){const o=n[r],s=function(e){return void 0!==e&&null!==e}(o);return(!i||!s)&&(e[r]={[t]:s?S(o):"N/A","Uniform Type":s?o:"NOT PROVIDED"},!0)}function Ar(e,t,n,r){const{gl:i}=e;let o,s,a,u="NOT PROVIDED",c="N/A",l="N/A",f="N/A";if(n&&(u=n.type,c=n.size,o=-1!==(u=String(u).replace("Array","")).indexOf("nt")),t instanceof ce){const e=t,{data:h,modified:d}=e.getDebugData();let p;if(s=d?"*":"",a=h,l=(f=e.byteLength)/h.BYTES_PER_ELEMENT/c,n){p=`${n.divisor>0?"I ":"P "} ${l} (x${c}=${f} bytes ${J(i,u)})`}else o=!0,p=`${f} bytes`;return{[r]:`${s}${S(a,{size:c,isInteger:o})}`,"Format ":p}}return{[r]:`${S(a=t,{size:c=t.length,isInteger:o=-1!==(u=String(t.constructor.name).replace("Array","")).indexOf("nt")})} (constant)`,"Format ":`${c}x${u} (constant)`}}function Tr(e,t){const{type:n,size:r}=t,i=gn(n,r);return i?`${e} (${i.name})`:e}function Rr(e){const{type:t,size:n}=e.accessor,r=gn(t,n);return r?`${r.name} ${e.name}`:e.name}hr.a.listenFor("luma.gl",e=>{const t=dr[e.itemKey];if(!t||"edit"!==e.type||"uniforms"!==e.valuePath[0])return;const n=e.valuePath.slice(1);((e,t,n)=>{if(!r.b.__SEER_INITIALIZED__)return;Er.has(e)||Er.set(e,new Map),Er.get(e).set(t,n)})(e.itemKey,n,e.value);const i=t.getUniforms();mr(i,n,e.value),t.setUniforms(i)});const xr=2,Sr=1e4,Ir=["renderPickingBuffer","pickingEnabled"];class Cr extends rr{constructor(e,t={}){super(t),y(O(e)),this.gl=e,this.lastLogTime=0,this.initialize(t)}initialize(e={}){this.props={},this.program=this._createProgram(e),this.vertexArray=new Xn(this.gl,{program:this.program}),this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.animatedUniforms={},this.animated=!1,this.animationLoop=null,this.timerQueryEnabled=!1,this.timeElapsedQuery=void 0,this.lastQueryReturned=!0,this.stats={accumulatedFrameTime:0,averageFrameTime:0,profileFrameCount:0},this.pickable=!0,this.setProps(e),this.setUniforms(Object.assign({},this.getModuleUniforms(),this.getModuleUniforms(e.moduleSettings))),this.onBeforeRender=e.onBeforeRender||(()=>{}),this.onAfterRender=e.onAfterRender||(()=>{})}setProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms,e.samplers),"pickable"in e&&(this.pickable=e.pickable),"timerQueryEnabled"in e&&(this.timerQueryEnabled=e.timerQueryEnabled&&On.isSupported(this.gl,["timers"]),e.timerQueryEnabled&&!this.timerQueryEnabled&&x.a.warn("GPU timer not supported")()),"_animationProps"in e&&this._setAnimationProps(e._animationProps),"_animationLoop"in e&&(this.animationLoop=e._animationLoop)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this.program.delete(),this.vertexArray.delete(),gr(this.id)}destroy(){this.delete()}getNeedsRedraw({clearRedrawFlags:e=!1}={}){let t=!1;return t=t||this.needsRedraw,this.needsRedraw=this.needsRedraw&&!e,this.geometry&&(t=t||this.geometry.getNeedsRedraw({clearRedrawFlags:e})),this.animated&&(t=t||`animated model ${this.id}`),t}getProgram(){return this.program}getUniforms(){return this.program.getUniforms}setNeedsRedraw(e=!0){return this.needsRedraw=e,this}setUniforms(e={},t={}){e=Object.assign({},e),vr(this.id,e),e=this._extractAnimatedUniforms(e),this.program.setUniforms(e,t,()=>{this._checkForDeprecatedUniforms(e),this.setNeedsRedraw()})}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return at(this.program.gl,e),this}drawGeometry(e={}){const{moduleSettings:t=null,framebuffer:n,uniforms:r={},attributes:i={},samplers:o={},transformFeedback:s=this.transformFeedback,parameters:a={},vertexArray:u=this.vertexArray,animationProps:c}=e;pr(this),this.setAttributes(i),this.updateModuleSettings(t),this.setUniforms(r,o),this._refreshAnimationProps(c);const l=this._logDrawCallStart(2),f=this.vertexArray.getDrawParams(this.props);f.isInstanced&&!this.isInstanced&&x.a.warn("Found instanced attributes on non-instanced model",this.id)();const{isIndexed:h,indexType:d,indexOffset:p}=f,{isInstanced:_,instanceCount:g}=this;this.onBeforeRender(),this._timerQueryStart();const m=this.program.draw(Object.assign({},e,{logPriority:l,uniforms:null,framebuffer:n,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:u,transformFeedback:s,isIndexed:h,indexType:d,isInstanced:_,instanceCount:g,offset:h?p:0}));return this._timerQueryEnd(),this.onAfterRender(),m&&this.setNeedsRedraw(!1),this._logDrawCallEnd(l,u,n),m}transform(e={}){const{discard:t=!0,feedbackBuffers:n,unbindModels:r=[]}=e;let{parameters:i}=e;n&&this._setFeedbackBuffers(n),t&&(i=Object.assign({},i,{[U.a.RASTERIZER_DISCARD]:t})),r.forEach(e=>e.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:i}))}finally{r.forEach(e=>e.vertexArray.bindBuffers())}return this}render(e={}){return y(arguments.length<=1),this.draw({uniforms:e})}_createProgram({vs:e=null,fs:t=null,modules:n=null,defines:r={},inject:i={},shaderCache:o=null,varyings:s=null,bufferMode:a=U.a.SEPARATE_ATTRIBS,program:u=null}){this.getModuleUniforms=(e=>{});const c=this.id;if(!u){e=e||lr.MODULAR_SHADERS.vs,t=t||lr.MODULAR_SHADERS.fs;const l=Object(lr.assembleShaders)(this.gl,{vs:e,fs:t,modules:n,inject:i,defines:r,log:x.a});({vs:e,fs:t}=l),u=o?o.getProgram(this.gl,{id:c,vs:e,fs:t}):new bn(this.gl,{id:c,vs:e,fs:t,varyings:s,bufferMode:a}),this.getModuleUniforms=l.getUniforms||(e=>{})}return y(u instanceof bn,"Model needs a program"),u}_checkForDeprecatedUniforms(e){Ir.forEach(t=>{t in e&&x.a.deprecated(t,"use picking shader module and Model class updateModuleSettings()")()})}_refreshAnimationProps(e){(e=e||this.animationLoop&&this.animationLoop.animationProps)&&this._setAnimationProps(e)}_evaluateAnimateUniforms(e){if(!this.animated)return{};const t={};for(const n in this.animatedUniforms){const r=this.animatedUniforms[n];t[n]=r(e)}return t}_extractAnimatedUniforms(e){let t=!1;for(const n in e){const r=e[n];"function"==typeof r?(this.animatedUniforms[n]=r,t=!0):delete this.animatedUniforms[n]}if(this.animated=!R(this.animatedUniforms),!t)return e;const n={};for(const t in e)this.animatedUniforms[t]||(n[t]=e[t]);return n}_timerQueryStart(){!0===this.timerQueryEnabled&&(this.timeElapsedQuery||(this.timeElapsedQuery=new On(this.gl)),this.lastQueryReturned&&(this.lastQueryReturned=!1,this.timeElapsedQuery.beginTimeElapsedQuery()))}_timerQueryEnd(){if(!0===this.timerQueryEnabled&&(this.timeElapsedQuery.end(),this.timeElapsedQuery.isResultAvailable())){this.lastQueryReturned=!0;const e=this.timeElapsedQuery.getResult();this.stats.lastFrameTime=e,this.stats.accumulatedFrameTime+=e,this.stats.profileFrameCount++,this.stats.averageFrameTime=this.stats.accumulatedFrameTime/this.stats.profileFrameCount,x.a.log(xr,`GPU time ${this.program.id}: ${this.stats.lastFrameTime}ms average ${this.stats.averageFrameTime}ms accumulated: ${this.stats.accumulatedFrameTime}ms count: ${this.stats.profileFrameCount}`)()}}_logDrawCallStart(e){const t=e>3?0:Sr;if(!(x.a.priority<e||Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),x.a.group(xr,`>>> DRAWING MODEL ${this.id}`,{collapsed:x.a.priority<=2})(),e}_logDrawCallEnd(e,t,n,r){if(void 0===e)return;const i=function({vertexArray:e,header:t="Attributes"}={}){if(!e.configuration)return{};const n={};e.elements&&(n.ELEMENT_ARRAY_BUFFER=Ar(e,e.elements,null,t));const r=e.values;for(const i in r){const o=e._getAttributeInfo(i);if(o){let s=`${i}: ${o.name}`;const a=e.accessors[o.location];a&&(s=`${i}: ${Tr(o.name,a)}`),n[s]=Ar(e,r[i],a,t)}}return n}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:s,unusedCount:a}=yr({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:u,count:c}=yr({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&x.a.log("MISSING UNIFORMS",Object.keys(u))(),a>0&&x.a.log("UNUSED UNIFORMS",Object.keys(s))();const l=function(e){const t={},n=`Accessors for ${e.id}`;for(const r of e.attributeInfos)r&&(t[`in ${Rr(r)}`]={[n]:JSON.stringify(r.accessor)});for(const r of e.varyingInfos)r&&(t[`out ${Rr(r)}`]={[n]:JSON.stringify(r.accessor)});return t}(this.vertexArray.configuration);x.a.table(e,i)(),x.a.table(e,o)(),x.a.table(e+1,l)(),_r(this,n),r&&r.log({priority:xr,message:`Rendered to ${r.id}`}),x.a.groupEnd(xr,`>>> DRAWING MODEL ${this.id}`)()}}class Nr{constructor(e,t={}){const{id:n=A("attribute"),type:r,isIndexed:i=!1}=t;this.gl=e,this.id=n,this.isIndexed=i,this.target=i?U.a.ELEMENT_ARRAY_BUFFER:U.a.ARRAY_BUFFER,this.type=r,i&&!r&&(this.type=e&&Rt(e,At.ELEMENT_INDEX_UINT32)?U.a.UNSIGNED_INT:U.a.UNSIGNED_SHORT),this.value=null,this.externalBuffer=null,this.buffer=null,this.userData={},this.update(t),Object.seal(this),this._validateAttributeDefinition()}delete(){this.buffer&&(this.buffer.delete(),this.buffer=null)}update(e){const{value:t,buffer:n,constant:r=this.constant||!1}=e;this.constant=r,n?(this.externalBuffer=n,this.constant=!1,this.type=e.type||n.accessor.type,void 0!==n.accessor.divisor&&(this.divisor=n.accessor.divisor),void 0!==e.divisor&&(this.divisor=e.divisor)):t&&(this.externalBuffer=null,this.value=t,!r&&this.gl&&(this.buffer=this.buffer||new ce(this.gl,Object.assign({},e,{id:this.id,target:this.target,type:this.type})),this.buffer.setData({data:t}),this.type=this.buffer.accessor.type)),this._setAccessor(e)}getBuffer(){return this.constant?null:this.externalBuffer||this.buffer}getValue(){if(this.constant)return this.value;const e=this.externalBuffer||this.buffer;return e?[e,this]:null}_setAccessor(e){const{size:t=this.size,offset:n=this.offset||0,stride:r=this.stride||0,normalized:i=this.normalized||!1,integer:o=this.integer||!1,divisor:s=this.divisor||0,instanced:a,isInstanced:u}=e;this.size=t,this.offset=n,this.stride=r,this.normalized=i,this.integer=o,this.divisor=s,void 0!==u&&(x.a.deprecated("Attribute.isInstanced")(),this.divisor=u?1:0),void 0!==a&&(x.a.deprecated("Attribute.instanced")(),this.divisor=a?1:0)}_validateAttributeDefinition(){}}const wr="Model needs drawMode and vertexCount",Fr=2;class Mr extends Cr{constructor(e,t={}){super(e,t)}initialize(e={}){super.initialize(e),this._attributes={},this.attributes={},this.isInstanced=e.isInstanced||e.instanced,y(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),wr)}setProps(e){super.setProps(e),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}destroy(){this.delete()}get vertexCount(){return Number.isFinite(this.props.vertexCount)?this.props.vertexCount:this.geometry&&this.geometry.getVertexCount()}get drawMode(){return Number.isFinite(this.props.drawMode)?this.props.drawMode:this.geometry&&this.geometry.drawMode}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}setDrawMode(e){return this.props.drawMode=Jn(e),this}setVertexCount(e){return y(Number.isFinite(e)),this.props.vertexCount=e,this}setInstanceCount(e){return y(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){this.geometry=e;const t=this._createBuffersFromAttributeDescriptors(this.geometry.getAttributes());return this.vertexArray.setAttributes(t),this.setNeedsRedraw(),this}setAttributes(e={}){if(R(e))return this;Object.assign(this.attributes,e);const t=this._createBuffersFromAttributeDescriptors(e);return this.vertexArray.setAttributes(t),this.setNeedsRedraw(),this}draw(e={}){return this.drawGeometry(e)}transform(e={}){const{discard:t=!0,feedbackBuffers:n,unbindModels:r=[]}=e;let{parameters:i}=e;n&&this._setFeedbackBuffers(n),t&&(i=Object.assign({},i,{[U.a.RASTERIZER_DISCARD]:t})),r.forEach(e=>e.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:i}))}finally{r.forEach(e=>e.vertexArray.bindBuffers())}return this}render(e={}){return y(arguments.length<=1),this.draw({uniforms:e})}_setAnimationProps(e){if(this.animated){y(e,"Model.draw(): animated uniforms but no animationProps");const t=this._evaluateAnimateUniforms(e);this.program.setUniforms(t,{},()=>{this._checkForDeprecatedUniforms(t),this.setNeedsRedraw()})}}_setFeedbackBuffers(e={}){if(R(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new Pn(t,{program:this.program}),this.transformFeedback.setBuffers(e),this.setNeedsRedraw(),this}_timerQueryStart(){!0===this.timerQueryEnabled&&(this.timeElapsedQuery||(this.timeElapsedQuery=new On(this.gl)),this.lastQueryReturned&&(this.lastQueryReturned=!1,this.timeElapsedQuery.beginTimeElapsedQuery()))}_timerQueryEnd(){if(!0===this.timerQueryEnabled&&(this.timeElapsedQuery.end(),this.timeElapsedQuery.isResultAvailable())){this.lastQueryReturned=!0;const e=this.timeElapsedQuery.getResult();this.stats.lastFrameTime=e,this.stats.accumulatedFrameTime+=e,this.stats.profileFrameCount++,this.stats.averageFrameTime=this.stats.accumulatedFrameTime/this.stats.profileFrameCount,x.a.log(Fr,`GPU time ${this.program.id}: ${this.stats.lastFrameTime}ms average ${this.stats.averageFrameTime}ms accumulated: ${this.stats.accumulatedFrameTime}ms count: ${this.stats.profileFrameCount}`)()}}_createBuffersFromAttributeDescriptors(e){const{program:{gl:t}}=this,n={};for(const r in e){const i=e[r];let o=this._attributes[r];i instanceof Nr?o=i:i instanceof ce?(o=o||new Nr(t,Object.assign({},i,i.accessor,{id:r}))).update({buffer:i}):o?o.update(i):o=new Nr(t,Object.assign({},i,{id:r})),this._attributes[r]=o,n[r]=o.getValue()}return n}}const Or="transform_uSampler_",Lr="transform_uSize_",Pr="transform_position";function Br({vs:e,sourceTextureMap:t,targetTextureVarying:n,targetTexture:r}){let i=Object.keys(t).length,o=null;const s={};let a=e,u={};if(i>0||n){const e=a.split("\n"),c=e.slice();if(e.forEach((e,r,a)=>{if(i>0){const n=function(e,t){const n={},r=function(e){return Object(lr.getQualifierDetails)(e,["attribute","in"])}(e);if(!r)return null;const{type:i,name:o}=r;if(o&&t[o]){const t=`// ${e} => Replaced by Transform with a sampler`,{samplerName:r,sizeName:s,uniformDeclerations:a}=function(e){const t=`${Or}${e}`,n=`${Lr}${e}`;return{samplerName:t,sizeName:n,uniformDeclerations:`  uniform sampler2D ${t};\n  uniform vec2 ${n};`}}(o),u=Object(lr.typeToChannelSuffix)(i),c=`  ${i} ${o} = transform_getInput(${r}, ${s}).${u};\n`;n[r]=o;const l={"vs:#decl":a,"vs:#main-start":c};return{updatedLine:t,inject:l,samplerTextureMap:n}}return null}(e,t);if(n){const{updatedLine:e,inject:t}=n;c[r]=e,u=Object(lr.combineInjects)([u,t]),Object.assign(s,n.samplerTextureMap),i--}}n&&!o&&(o=function(e,t){const n=Object(lr.getQualifierDetails)(e,["varying","out"]);if(!n)return null;return n.name===t?n.type:null}(e,n))}),n){Ot()(r);const e=`${Lr}${n}`,t={"vs:#decl":`uniform vec2 ${e};\n`,"vs:#main-start":`     vec2 ${Pr} = transform_getPos(${e});\n     gl_Position = vec4(${Pr}, 0, 1.);\n`};u=Object(lr.combineInjects)([u,t])}a=c.join("\n")}return{vs:a,targetTextureType:o,inject:u,samplerTextureMap:s}}const Dr={[U.a.TEXTURE_MIN_FILTER]:U.a.NEAREST,[U.a.TEXTURE_MAG_FILTER]:U.a.NEAREST,[U.a.TEXTURE_WRAP_S]:U.a.CLAMP_TO_EDGE,[U.a.TEXTURE_WRAP_T]:U.a.CLAMP_TO_EDGE},Ur="transform_output";class kr{static isSupported(e){return L(e)}constructor(e,t={}){B(e),this.gl=e,this.model=null,this.elementCount=0,this.currentIndex=0,this.sourceBuffers=new Array(2),this.sourceTextures=new Array(2),this.feedbackBuffers=new Array(2),this.targetTextures=new Array(2),this.transformFeedbacks=new Array(2),this.framebuffers=new Array(2),this._createdBuffers={},this.elementIDBuffer=null,this._targetRefTexName=null,this._initialize(t),Object.seal(this)}delete(){for(const e in this._createdBuffers)this._createdBuffers[e].delete();this.model.delete()}getBuffer(e=null){const t=e?this.feedbackBuffers[this.currentIndex][e]:null;return t?t instanceof ce?t:t.buffer:null}_getTargetTexture(){return this.framebuffers[this.currentIndex]?this.framebuffers[this.currentIndex].attachments[U.a.COLOR_ATTACHMENT0]:null}getData({varyingName:e=null,packed:t=!1}={}){const n=this.getBuffer(e);if(n)return n.getData();y(!e||e===this.targetTextureVarying);const r=lt(this.framebuffers[this.currentIndex]);if(!t)return r;const i=r.constructor,o=Object(lr.typeToChannelCount)(this.targetTextureType),s=new i(r.length*o/4);let a=0;for(let e=0;e<r.length;e+=4)for(let t=0;t<o;t++)s[a++]=r[e+t];return s}getFramebuffer(){return this.framebuffers[this.currentIndex]}_getInputs(){const e={},t=this.currentIndex,n=Object.assign({},this.sourceBuffers[t]);if(this.hasSourceTextures||this.targetTextureVarying){n.transform_elementID=this.elementIDBuffer;for(const n in this.samplerTextureMap){const r=this.samplerTextureMap[n];e[n]=this.sourceTextures[t][r]}this._setSourceTextureParameters();const r=function({sourceTextureMap:e,targetTextureVarying:t,targetTexture:n}){const r={};let i,o;t&&(({width:i,height:o}=n),r[`${Lr}${t}`]=[i,o]);for(const t in e)({width:i,height:o}=e[t]),r[`${Lr}${t}`]=[i,o];return r}({sourceTextureMap:this.sourceTextures[t],targetTextureVarying:this.targetTextureVarying,targetTexture:this.targetTextures[t]});Object.assign(e,r)}return{attributes:n,uniforms:e}}run(e={}){const{attributes:t,uniforms:n}=this._getInputs();Object.assign(n,e.uniforms);const r=Object.assign({},e.parameters),{clearRenderTarget:i=!0}=e;let o=null,s=!0;this.renderingToTexture&&(s=!1,y(o=this.framebuffers[this.currentIndex]),r.viewport=[0,0,o.width,o.height],i&&this.gl.clear(this.gl.COLOR_BUFFER_BIT)),this.model.setAttributes(t),this.model.transform(Object.assign({},e,{transformFeedback:this.transformFeedbacks[this.currentIndex],uniforms:n,discard:s,framebuffer:o,parameters:r}))}swapBuffers(){x.a.deprecated("swapBuffers()","swap()")(),this.swap()}swap(){y(this.feedbackMap||this._swapTexture),this.currentIndex=(this.currentIndex+1)%2}update(e={}){e.elementCount&&this._setElementCount(e.elementCount);const{sourceBuffers:t=null,feedbackBuffers:n=null}=e,{currentIndex:r}=this;if(t||n){for(const e in n)y(n[e]instanceof ce||n[e].buffer instanceof ce);Object.assign(this.sourceBuffers[r],t),Object.assign(this.feedbackBuffers[r],n),this._createFeedbackBuffers({feedbackBuffers:n}),this.transformFeedbacks[r]&&this.transformFeedbacks[r].setBuffers(this.feedbackBuffers[r]),this._setupSwapBuffers()}const{_sourceTextures:i,_targetTexture:o}=e;(i||o)&&(Object.assign(this.sourceTextures[r],i),this._updateTargetTexture(o||this._targetRefTexName,r),this._setupSwapTextures())}_setSourceTextureParameters(){const e=this.currentIndex;for(const t in this.sourceTextures[e])this.sourceTextures[e][t].setParameters(Dr)}_setElementCount(e){this.elementCount!==e&&(this.elementCount<e&&this._updateElementIDBuffer(e),this.model.setVertexCount(e),this.elementCount=e)}_updateTargetTexture(e,t){const n=this._buildTargetTexture(e);n&&(this.targetTextures[t]=n,this.framebuffers[t]&&(this.framebuffers[t].update({attachments:{[U.a.COLOR_ATTACHMENT0]:this.targetTextures[t]},resizeAttachments:!1}),this.framebuffers[t].resize({width:n.width,height:n.height})))}_initialize(e={}){const{feedbackBuffers:t,feedbackMap:n}=this._validateProps(e),{sourceBuffers:r,varyings:i,_targetTexture:o,_targetTextureVarying:s,_swapTexture:a}=e;let u=i;n&&!Array.isArray(i)&&(u=Object.values(n)),this.varyingsArray=u,this.feedbackMap=n,this._swapTexture=a,o&&(this.targetTextureVarying=s,this.renderingToTexture=!0,y(this.targetTextureVarying)),this._setupBuffers({sourceBuffers:r,feedbackBuffers:t}),this._setupTextures(e),this._setupSwapBuffers(),this._setupSwapTextures(),this._buildModel(Object.assign({},e,{id:e.id||"transform-model",drawMode:e.drawMode||U.a.POINTS,varyings:u}))}_validateProps(e){let{feedbackBuffers:t,feedbackMap:n}=e;const{destinationBuffers:r,sourceDestinationMap:i}=e;r&&(x.a.deprecated("destinationBuffers","feedbackBuffers")(),t=t||r),i&&(x.a.deprecated("sourceDestinationMap","feedbackMap")(),n=n||i);const{vs:o,elementCount:s,varyings:a}=e,{_sourceTextures:u,_targetTexture:c,_targetTextureVarying:l,_swapTexture:f}=e;y(o&&(a||n||c)&&s);for(const e in t||{})y(t[e]instanceof ce||t[e].buffer instanceof ce);for(const e in u||{})y(u[e]instanceof ze);return y(!c||l),y(!f||u[f]),{feedbackBuffers:t,feedbackMap:n}}_setupBuffers({sourceBuffers:e=null,feedbackBuffers:t=null}){this.sourceBuffers[0]=Object.assign({},e),this.feedbackBuffers[0]=Object.assign({},t),this._createFeedbackBuffers({feedbackBuffers:t}),this.sourceBuffers[1]={},this.feedbackBuffers[1]={}}_setupTextures(e={}){const{_sourceTextures:t,_targetTexture:n}=e;if(this.sourceTextures[0]=Object.assign({},t),this.sourceTextures[1]={},this.hasSourceTextures=Object.keys(this.sourceTextures[0]).length>0,this.targetTextureVarying){const e=this._buildTargetTexture(n);y(e),this.targetTextures[0]=e,this.targetTextures[1]=null}}_buildTargetTexture(e){if(e instanceof ze)return e;const t=this.sourceTextures[0][e];return t?(this._targetRefTexName=e,Lt(t,{parameters:{[U.a.TEXTURE_MIN_FILTER]:U.a.NEAREST,[U.a.TEXTURE_MAG_FILTER]:U.a.NEAREST,[U.a.TEXTURE_WRAP_S]:U.a.CLAMP_TO_EDGE,[U.a.TEXTURE_WRAP_T]:U.a.CLAMP_TO_EDGE},pixelStore:{[U.a.UNPACK_FLIP_Y_WEBGL]:!1}})):null}_createFeedbackBuffers({feedbackBuffers:e}){if(!this.feedbackMap)return;const t=this.currentIndex;for(const n in this.feedbackMap){const r=this.feedbackMap[n];if(!(r===this.targetTextureVarying||e&&e[r])){const e=this.sourceBuffers[t][n],{bytes:i,type:o,usage:s,accessor:a}=e,u=new ce(this.gl,{bytes:i,type:o,usage:s,accessor:a});this._createdBuffers[r]&&this._createdBuffers[r].delete(),this._createdBuffers[r]=u,this.feedbackBuffers[t][r]=u}}}_createNewBuffer(e,t){const n=new ce(this.gl,t);return this._createdBuffers[e]&&(this._createdBuffers[e].delete(),this._createdBuffers[e]=n),n}_setupSwapBuffers(){if(!this.feedbackMap)return;const e=this.currentIndex,t=(e+1)%2;Object.assign(this.sourceBuffers[t],this.sourceBuffers[e]),Object.assign(this.feedbackBuffers[t],this.feedbackBuffers[e]);for(const n in this.feedbackMap){const r=this.feedbackMap[n];r!==this.targetTextureVarying&&(this.sourceBuffers[t][n]=this.feedbackBuffers[e][r],this.feedbackBuffers[t][r]=this.sourceBuffers[e][n],y(this.feedbackBuffers[t][r]instanceof ce))}this.transformFeedbacks[t]&&this.transformFeedbacks[t].setBuffers(this.feedbackBuffers[t])}_setupSwapTextures(){if(!this._swapTexture||!this.targetTextureVarying)return;const e=this.currentIndex,t=(e+1)%2;Object.assign(this.sourceTextures[t],this.sourceTextures[e]),this.sourceTextures[t][this._swapTexture]=this.targetTextures[e],this._updateTargetTexture(this.sourceTextures[e][this._swapTexture],t)}_buildModel(e={}){const{vs:t,fs:n,modules:r,uniforms:i,inject:o,samplerTextureMap:s}=this._getShaders(e);this.model=new Mr(this.gl,Object.assign({},e,{vs:t,fs:n,vertexCount:e.elementCount,modules:r,uniforms:i,inject:o})),this.samplerTextureMap=s,this._setupTransformFeedback(),this._setupFramebuffers(),this._setElementCount(e.elementCount)}_setupTransformFeedback(){R(this.feedbackBuffers[0])||(this.transformFeedbacks[0]=new Pn(this.gl,{program:this.model.program,buffers:this.feedbackBuffers[0]}),this.feedbackMap&&(this.transformFeedbacks[1]=new Pn(this.gl,{program:this.model.program,buffers:this.feedbackBuffers[1]})))}_setupFramebuffers(){if(!this.renderingToTexture)return;let{width:e,height:t}=this.targetTextures[0];this.framebuffers[0]=new wt(this.gl,{id:`${this.id||"transform"}-framebuffer-0`,width:e,height:t,attachments:{[U.a.COLOR_ATTACHMENT0]:this.targetTextures[0]}}),this._swapTexture&&(({width:e,height:t}=this.targetTextures[1]),this.framebuffers[1]=new wt(this.gl,{id:`${this.id||"transform"}-framebuffer-1`,width:e,height:t,attachments:{[U.a.COLOR_ATTACHMENT0]:this.targetTextures[1]}}))}_updateElementIDBuffer(e){if(!this.hasSourceTextures&&!this.targetTextureVarying)return;const t=new Float32Array(e);t.forEach((e,t,n)=>{n[t]=t}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new ce(this.gl,{data:t,size:1})}_getShaders(e={}){const{vs:t,uniforms:n,targetTextureType:r,inject:i,samplerTextureMap:o}=this._processVertexShader(e.vs),s=Object(lr.combineInjects)([e.inject||{},i]);return this.targetTextureType=r,{vs:t,fs:Object(lr.getPassthroughFS)({version:function(e){let t=100;const n=e.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}return t}(t),input:this.targetTextureVarying,inputType:r,output:Ur}),modules:this.hasSourceTextures||this.targetTextureVarying?[lr._transform].concat(e.modules||[]):e.modules,uniforms:n,inject:s,samplerTextureMap:o}}_processVertexShader(e){return Br({vs:e,sourceTextureMap:this.sourceTextures[this.currentIndex],targetTextureVarying:this.targetTextureVarying,targetTexture:this.targetTextures[this.currentIndex]})}}class Gr{constructor({gl:e,_cachePrograms:t=!1}={}){y(e),this.gl=e,this.vertexShaders={},this.fragmentShaders={},this.programs={},this._cachePrograms=t}delete(){return this}getVertexShader(e,t){y("string"==typeof t),y(this._compareContexts(e,this.gl));let n=this.vertexShaders[t];return n||(n=new Dt(e,t),this.vertexShaders[t]=n),n}getFragmentShader(e,t){y("string"==typeof t),y(this._compareContexts(e,this.gl));let n=this.fragmentShaders[t];return n||(n=new Ut(e,t),this.fragmentShaders[t]=n),n}getProgram(e,t){y(this._compareContexts(e,this.gl)),y("string"==typeof t.vs),y("string"==typeof t.fs),y("string"==typeof t.id);const n=this._getProgramKey(t);let r=this.programs[n];return r?(this._resetProgram(r),r):(r=this._createNewProgram(e,t),this._cachePrograms&&this._checkProgramProp(r)&&(r._isCached=!0,this.programs[n]=r),r)}_getProgramKey(e){return`${e.id}-${e.vs}-${e.fs}`}_checkProgramProp(e){return!e.varyings}_createNewProgram(e,t){const{vs:n,fs:r}=t,i=this.getVertexShader(e,n),o=this.getFragmentShader(e,r);return new bn(this.gl,Object.assign({},t,{vs:i,fs:o}))}_resetProgram(e,t){e.reset()}_compareContexts(e,t){return(e.gl||e)===(t.gl||t)}}class jr{static createWorker(e){return t=>{e.setProps({useDevicePixels:!1,autoResizeDrawingBuffer:!1}),t.canvas=null,t.addEventListener("message",n=>{switch(n.data.command){case"start":!function(e){const n=new Map;e.addEventListener=((e,r)=>{t.postMessage({command:"addEventListener",type:e}),n.has(e)||n.set(e,[]),n.get(e).push(r)}),e.removeEventListener=((e,r)=>{t.postMessage({command:"removeEventListener",type:e});const i=n.get(e);i&&i.splice(i.indexOf(r),1)}),e.dispatchEvent=((e,t)=>{const r=n.get(e);r&&r.forEach(e=>e(t))}),t.canvas=e}(n.data.opts.canvas),e.start(n.data.opts);break;case"stop":e.stop();break;case"resize":t.canvas.width=n.data.width,t.canvas.height=n.data.height;break;case"event":t.canvas.dispatchEvent(n.data.type,n.data.event)}})}}constructor(e,t={}){const{onInitialize:n=(()=>{}),onFinalize:r=(()=>{}),useDevicePixels:i=!0,autoResizeDrawingBuffer:o=!0}=t;this.props={onInitialize:n,onFinalize:r},this.setProps({autoResizeDrawingBuffer:o,useDevicePixels:i}),y(e instanceof Worker),this.worker=e,this.canvas=null,this.width=null,this.height=null,this._stopped=!0,this._animationFrameId=null,this._startPromise=null,this._onMessage=this._onMessage.bind(this),this._onEvent=this._onEvent.bind(this),this._updateFrame=this._updateFrame.bind(this)}setProps(e){return"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){return this._stopped=!1,this._animationFrameId||(this.worker.onmessage=this._onMessage,this._startPromise=Te().then(()=>(this._createAndTransferCanvas(e),this.props.onInitialize(this))).then(()=>{this._stopped||(this._animationFrameId=G(this._updateFrame))})),this}stop(){return this._animationFrameId&&(j(this._animationFrameId),this._animationFrameId=null,this._stopped=!0,this.props.onFinalize(this)),this.worker.postMessage({command:"stop"}),this}_onMessage(e){switch(e.data.command){case"addEventListener":this.canvas.addEventListener(e.data.type,this._onEvent);break;case"removeEventListener":this.canvas.removeEventListener(e.data.type,this._onEvent)}}_onEvent(e){const t=this.useDevicePixels&&window.devicePixelRatio||1,n=e.type,r={};for(const n in e){let i=e[n];const o=typeof i;"offsetX"!==n&&"offsetY"!==n||(i*=t),"number"!==o&&"boolean"!==o&&"string"!==o||(r[n]=i)}this.worker.postMessage({command:"event",type:n,event:r})}_updateFrame(){this._resizeCanvasDrawingBuffer(),this._animationFrameId=G(this._updateFrame)}_createAndTransferCanvas(e){const t=Re(e);t.transferControlToOffscreen||x.a.error("OffscreenCanvas is not available in your browser.")();const n=t.transferControlToOffscreen();this.worker.postMessage({command:"start",opts:Object.assign({},e,{canvas:n})},[n]),this.canvas=t}_resizeCanvasDrawingBuffer(){if(this.autoResizeDrawingBuffer){const e=this.useDevicePixels&&window.devicePixelRatio||1,t=this.canvas.clientWidth*e,n=this.canvas.clientHeight*e;this.width===t&&this.height===n||(this.width=t,this.height=n,this.worker.postMessage({command:"resize",width:t,height:n}))}}}class Vr extends rr{constructor(e={}){super(e),this.projectionMatrix=e.projectionMatrix}}const Hr="\n  attribute vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    attribute vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    attribute vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    attribute vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n",Xr="\n  void main(void) {\n    gl_FragColor = pbr_filterColor(gl_FragColor);\n  }\n";class $r{constructor(e){this.gl=e}getTexUrl(e,t,n,r=0){return`https://raw.githubusercontent.com/KhronosGroup/glTF-WebGL-PBR/master/textures/${e}/${t}/${t}_${n}_${r}.jpg`}getBrdfUrl(){return"https://raw.githubusercontent.com/KhronosGroup/glTF-WebGL-PBR/master/textures/brdfLUT.png"}makeCube(e,t){return Promise.all([t("right"),t("top"),t("front"),t("left"),t("bottom"),t("back")]).then(t=>new Ye(this.gl,{id:e,pixels:{[this.gl.TEXTURE_CUBE_MAP_POSITIVE_X]:t[0],[this.gl.TEXTURE_CUBE_MAP_POSITIVE_Y]:t[1],[this.gl.TEXTURE_CUBE_MAP_POSITIVE_Z]:t[2],[this.gl.TEXTURE_CUBE_MAP_NEGATIVE_X]:t[3],[this.gl.TEXTURE_CUBE_MAP_NEGATIVE_Y]:t[4],[this.gl.TEXTURE_CUBE_MAP_NEGATIVE_Z]:t[5]}}))}getDiffuseEnvSampler(){return this._DiffuseEnvSampler||(this._DiffuseEnvSampler=this.makeCube("DiffuseEnvSampler",e=>$e(this.getTexUrl("papermill","diffuse",e)))),this._DiffuseEnvSampler}getSpecularEnvSampler(){return this._SpecularEnvSampler||(this._SpecularEnvSampler=this.makeCube("SpecularEnvSampler",e=>$e(this.getTexUrl("papermill","specular",e)))),this._SpecularEnvSampler}getBrdfTex(){return this._BrdfTex||(this._BrdfTex=new ze(this.gl,{id:"brdfLUT",parameters:{},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},data:$e(this.getBrdfUrl())})),this._BrdfTex}}class zr{constructor(e,{attributes:t,material:n,debug:r}){this.gl=e,this.env=new $r(e),this.defines={USE_IBL:1,USE_TEX_LOD:1,MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},this.uniforms={u_Camera:[0,0,0],u_LightDirection:[0,.5,.5],u_LightColor:[1,1,1],u_MetallicRoughnessValues:[1,1],u_brdfLUT:this.env.getBrdfTex(),u_ScaleIBLAmbient:[1,1]},r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(r,"PBR_DEBUG"),n&&this.parseMaterial(n)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,n=null){const r=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},i=new ze(this.gl,{id:e.name||e.id,parameters:r,pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},data:e.texture.source.getImageAsync()});this.uniforms[t]=i,this.defineIfPresent(n,n)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:n=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,n]}parseMaterial(e){if(e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0])}}const Wr={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Yr={modelOptions:{},pbrDebug:!1};class Kr{constructor(e,t={}){this.gl=e,this.options=Object.assign({},Yr,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(e=>this.createScene(e))}createScene(e){const t=(e.nodes||[]).map(e=>this.createNode(e));return new ir({id:e.name||e.id,children:t})}createNode(e){const t=(e.children||[]).map(e=>this.createNode(e));e.mesh&&t.push(this.createMesh(e.mesh));const n=new ir({id:e.name||e.id,children:t});if(e.matrix)n.setMatrix(e.matrix);else{if(n.matrix.identity(),e.translation&&n.matrix.translate(e.translation),e.rotation){const t=(new nr.Matrix4).fromQuaternion(e.rotation);n.matrix.multiplyRight(t)}e.scale&&n.matrix.scale(e.scale)}return n}createMesh(e){if(!e._mesh){const t=(e.primitives||[]).map((t,n)=>this.createPrimitive(t,n,e)),n=new ir({id:e.name||e.id,children:t});e._mesh=n}return e._mesh}getVertexCount(e){x.a.warn("getVertexCount() not found")()}createPrimitive(e,t,n){return function(e,{id:t,drawMode:n,vertexCount:r,attributes:i,material:o,modelOptions:s,debug:a=!1}){const u=new zr(e,{attributes:i,material:o,debug:a});x.a.info(4,"createGLTFModel defines: ",u.defines)();const c=new Mr(e,Object.assign({id:t,drawMode:n,vertexCount:r,modules:[lr.pbr],defines:u.defines,vs:Hr,fs:Xr},s));return c.setProps({attributes:i}),c.setUniforms(u.uniforms),u.env.getDiffuseEnvSampler().then(e=>{c.setUniforms({u_DiffuseEnvSampler:e})}),u.env.getSpecularEnvSampler().then(e=>{c.setUniforms({u_SpecularEnvSampler:e})}),c}(this.gl,{id:e.name||`${n.name||n.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material,modelOptions:this.options.modelOptions,debug:this.options.pbrDebug})}createAttributes(e,t){const n={};return Object.keys(e).forEach(t=>{n[t]=this.createAccessor(e[t],this.createBuffer(e[t].bufferView,this.gl.ARRAY_BUFFER))}),t&&(n.indices=this.createAccessor(t,this.createBuffer(t.bufferView,this.gl.ELEMENT_ARRAY_BUFFER))),x.a.info(4,"glTF Attributes",{attributes:e,indices:t,generated:n})(),n}createBuffer(e,t){return e.lumaBuffers||(e.lumaBuffers={}),e.lumaBuffers[t]||(e.lumaBuffers[t]=new ce(this.gl,{id:`from-${e.id}`,data:e.data,target:t})),e.lumaBuffers[t]}createAccessor(e,t){return new ie({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Wr[e.type]})}createSampler(e){return e}needsPOT(){return!1}}class qr{constructor(e,t){const{id:n="pass"}=t;this.id=n,this.gl=e,this.props={enabled:!0,screen:!1,swap:!1},Object.assign(this.props,t)}setProps(e){Object.assign(this.props,e)}render(e,t){if(!this.props.enabled)return;const n=this.gl,r={gl:n,outputBuffer:e.writeBuffer,inputBuffer:e.readBuffer,animationProps:t,swapBuffers:()=>e._swapFramebuffers()};this.props.screen?(r.inputBuffer=r.outputBuffer,r.outputBuffer=wt.getDefaultFramebuffer(n)):this.props.swap&&(r.inputBuffer=e.writeBuffer,r.outputBuffer=e.readBuffer),me(n,{framebuffer:r.outputBuffer},()=>this._renderPass(r)),this.props.debug&&r.outputBuffer.log(1,this.id),this.props.swap&&e._swapFramebuffers()}_renderPass({gl:e,inputBuffer:t,outputBuffer:n,animationProps:r}){}}class Qr extends qr{constructor(e,t){t=Array.isArray(t)?{passes:t}:t,super(e,Object.assign({id:"composite-pass"},t))}render(...e){const{passes:t=[]}=this.props;for(const n of t)n.render(...e)}}class Zr{constructor(e,t={}){this.gl=e,this.framebuffer1=new wt(e,{id:"multi-pass-1",stencil:!0}),this.framebuffer2=new wt(e,{id:"multi-pass-2",stencil:!0}),this.reset()}reset(){this.framebuffer1.resize(),this.framebuffer2.resize(),this.writeBuffer=this.framebuffer1,this.readBuffer=this.framebuffer2,this.maskActive=!1}_swapFramebuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}}class Jr extends Qr{constructor(e,t){t=Array.isArray(t)?{passes:t}:t,super(e,Object.assign({id:"multi-pass"},t)),this.renderState=new Zr(e,t)}render(e){this.renderState.reset();const{passes:t=[]}=this.props;for(const n of t)n.render(this.renderState,e);return this}}class ei extends qr{constructor(e,t={}){super(e,Object.assign({id:"clear-pass"},t))}_renderPass({gl:e}){const{clearBits:t=e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT}=this.props;e.clear(t)}}class ti extends qr{constructor(e,t={}){super(e,Object.assign({id:"render-pass"},t))}_renderPass({animationProps:e}){const{models:t=[],drawParams:n}=this.props;for(const r of t)r.draw(Object.assign({},n,{animationProps:e}))}}const ni={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class ri extends er{constructor(e={}){const{bottomRadius:t=0,topRadius:n=0,height:r=1,nradial:i=10,nvertical:o=10,verticalAxis:s="y",topCap:a=!1,bottomCap:u=!1}=e,c=(a?2:0)+(u?2:0),l=(i+1)*(o+1+c),f=Math.atan2(t-n,r),h=Math.sin,d=Math.cos,p=Math.PI,_=d(f),g=h(f),m=a?-2:0,E=o+(u?2:0),v=i+1,y=new Float32Array(3*l),b=new Float32Array(3*l),A=new Float32Array(2*l),T=new Uint16Array(i*(o+c)*6),R=ni[s];let x=0,S=0;for(let e=m;e<=E;e++){let s,a=e/o,u=r*a;e<0?(u=0,a=1,s=t):e>o?(u=r,a=1,s=n):s=t+e/o*(n-t),-2!==e&&e!==o+2||(s=0,a=0),u-=r/2;for(let t=0;t<v;t++){const n=h(t*p*2/i),r=d(t*p*2/i);y[x+R[0]]=n*s,y[x+R[1]]=u,y[x+R[2]]=r*s,b[x+R[0]]=e<0||e>o?0:n*_,b[x+R[1]]=e<0?-1:e>o?1:g,b[x+R[2]]=e<0||e>o?0:r*_,A[S+0]=t/i,A[S+1]=a,S+=2,x+=3}}for(let e=0;e<o+c;e++)for(let t=0;t<i;t++){const n=6*(e*i+t);T[n+0]=v*(e+0)+0+t,T[n+1]=v*(e+0)+1+t,T[n+2]=v*(e+1)+1+t,T[n+3]=v*(e+0)+0+t,T[n+4]=v*(e+1)+1+t,T[n+5]=v*(e+1)+0+t}super(Object.assign({},e,{attributes:{positions:y,normals:b,texCoords:A,indices:T}}))}}class ii extends ri{constructor(e={}){const{radius:t=1,cap:n=!0}=e;super(Object.assign({},e,{topRadius:0,topCap:Boolean(n),bottomCap:Boolean(n),bottomRadius:t}))}}class oi extends er{constructor(e={}){const{id:t=A("cube-geometry")}=e;super(Object.assign({},e,{id:t,attributes:{indices:new Uint16Array(si),positions:new Float32Array(ai),normals:new Float32Array(ui),texCoords:new Float32Array(ci)}}))}}const si=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ai=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),ui=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),ci=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]);class li extends ri{constructor(e={}){const{radius:t=1}=e;super(Object.assign({},e,{bottomRadius:t,topRadius:t}))}}const fi=[-1,0,0,0,1,0,0,0,-1,0,0,1,0,-1,0,1,0,0],hi=[3,4,5,3,5,1,3,1,0,3,0,4,4,0,2,4,2,5,2,0,1,5,2,1];class di extends er{constructor(e={}){const{iterations:t=0}=e,n=Math.PI,r=2*n,i=[...fi];let o=[...hi];i.push(),o.push();const s=(()=>{const e={};return(t,n)=>{const r=`${(t*=3)<(n*=3)?t:n}|${t>n?t:n}`;if(r in e)return e[r];const o=i[t],s=i[t+1],a=i[t+2];let u=(o+i[n])/2,c=(s+i[n+1])/2,l=(a+i[n+2])/2;const f=Math.sqrt(u*u+c*c+l*l);return u/=f,c/=f,l/=f,i.push(u,c,l),e[r]=i.length/3-1}})();for(let e=0;e<t;e++){const e=[];for(let t=0;t<o.length;t+=3){const n=s(o[t+0],o[t+1]),r=s(o[t+1],o[t+2]),i=s(o[t+2],o[t+0]);e.push(i,o[t+0],n,n,o[t+1],r,r,o[t+2],i,n,r,i)}o=e}const a=new Array(3*o.length),u=new Array(2*o.length);for(let e=o.length-3;e>=0;e-=3){const t=o[e+0],s=o[e+1],c=o[e+2],l=3*t,f=3*s,h=3*c,d=2*t,p=2*s,_=2*c,g=i[l+0],m=i[l+1],E=i[l+2],v=Math.acos(E/Math.sqrt(g*g+m*m+E*E))/n,y=1-(Math.atan2(m,g)+n)/r,b=i[f+0],A=i[f+1],T=i[f+2],R=Math.acos(T/Math.sqrt(b*b+A*A+T*T))/n,x=1-(Math.atan2(A,b)+n)/r,S=i[h+0],I=i[h+1],C=i[h+2],N=Math.acos(C/Math.sqrt(S*S+I*I+C*C))/n,w=1-(Math.atan2(I,S)+n)/r,F=[S-b,I-A,C-T],M=[g-b,m-A,E-T],O=new nr.Vector3(F).cross(M).normalize();let L;(0===y||0===x||0===w)&&(0===y||y>.5)&&(0===x||x>.5)&&(0===w||w>.5)&&(i.push(i[l+0],i[l+1],i[l+2]),L=i.length/3-1,o.push(L),u[2*L+0]=1,u[2*L+1]=v,a[3*L+0]=O.x,a[3*L+1]=O.y,a[3*L+2]=O.z,i.push(i[f+0],i[f+1],i[f+2]),L=i.length/3-1,o.push(L),u[2*L+0]=1,u[2*L+1]=R,a[3*L+0]=O.x,a[3*L+1]=O.y,a[3*L+2]=O.z,i.push(i[h+0],i[h+1],i[h+2]),L=i.length/3-1,o.push(L),u[2*L+0]=1,u[2*L+1]=N,a[3*L+0]=O.x,a[3*L+1]=O.y,a[3*L+2]=O.z),a[l+0]=a[f+0]=a[h+0]=O.x,a[l+1]=a[f+1]=a[h+1]=O.y,a[l+2]=a[f+2]=a[h+2]=O.z,u[d+0]=y,u[d+1]=v,u[p+0]=x,u[p+1]=R,u[_+0]=w,u[_+1]=N}super(Object.assign({},e,{attributes:{positions:new Float32Array(i),normals:new Float32Array(a),texCoords:new Float32Array(u),indices:new Uint16Array(o)}}))}}class pi extends er{constructor(e={}){const{type:t="x,y",offset:n=0,flipCull:r=!1,unpack:i=!1,id:o=A("plane-geometry")}=e,s=t.split(",");let a=e[`${s[0]}len`];const u=e[`${s[1]}len`],c=e[`n${s[0]}`]||1,l=e[`n${s[1]}`]||1,f=(c+1)*(l+1);let h=new Float32Array(3*f),d=new Float32Array(3*f),p=new Float32Array(2*f);r&&(a=-a);let _=0,g=0;for(let e=0;e<=l;e++)for(let i=0;i<=c;i++){const o=i/c,s=e/l;switch(p[_+0]=r?1-o:o,p[_+1]=s,t){case"x,y":h[g+0]=a*o-.5*a,h[g+1]=u*s-.5*u,h[g+2]=n,d[g+0]=0,d[g+1]=0,d[g+2]=r?1:-1;break;case"x,z":h[g+0]=a*o-.5*a,h[g+1]=n,h[g+2]=u*s-.5*u,d[g+0]=0,d[g+1]=r?1:-1,d[g+2]=0;break;case"y,z":h[g+0]=n,h[g+1]=a*o-.5*a,h[g+2]=u*s-.5*u,d[g+0]=r?1:-1,d[g+1]=0,d[g+2]=0}_+=2,g+=3}const m=c+1;let E=new Uint16Array(c*l*6);for(let e=0;e<l;e++)for(let t=0;t<c;t++){const n=6*(e*c+t);E[n+0]=(e+0)*m+t,E[n+1]=(e+1)*m+t,E[n+2]=(e+0)*m+t+1,E[n+3]=(e+1)*m+t,E[n+4]=(e+1)*m+t+1,E[n+5]=(e+0)*m+t+1}if(i){const e=new Float32Array(3*E.length),t=new Float32Array(3*E.length),n=new Float32Array(2*E.length);for(let r=0;r<E.length;++r){const i=E[r];e[3*r+0]=h[3*i+0],e[3*r+1]=h[3*i+1],e[3*r+2]=h[3*i+2],t[3*r+0]=d[3*i+0],t[3*r+1]=d[3*i+1],t[3*r+2]=d[3*i+2],n[2*r+0]=p[2*i+0],n[2*r+1]=p[2*i+1]}h=e,d=t,p=n,E=void 0}const v={positions:h,normals:d,texCoords:p};E&&(v.indices=E),super(Object.assign({},e,{attributes:v,id:o}))}}class _i extends er{constructor(e={}){const{nlat:t=10,nlong:n=10,radius:r=1,id:i=A("sphere-geometry")}=e;super(Object.assign({},e,{id:i,attributes:function(e,t,n){const r=Math.PI-0,i=2*Math.PI-0,o=(e+1)*(t+1);if("number"==typeof n){const e=n;n=((t,n,r,i,o)=>e)}const s=new Float32Array(3*o),a=new Float32Array(3*o),u=new Float32Array(2*o),c=new Uint16Array(e*t*6);for(let o=0;o<=e;o++)for(let c=0;c<=t;c++){const l=c/t,f=o/e,h=c+o*(t+1),d=2*h,p=3*h,_=i*l,g=r*f,m=Math.sin(_),E=Math.cos(_),v=Math.sin(g),y=Math.cos(g),b=E*v,A=y,T=m*v,R=n(b,A,T,l,f);s[p+0]=R*b,s[p+1]=R*A,s[p+2]=R*T,a[p+0]=b,a[p+1]=A,a[p+2]=T,u[d+0]=l,u[d+1]=f}const l=e+1;for(let n=0;n<e;n++)for(let e=0;e<t;e++){const r=6*(n*t+e);c[r+0]=e*l+n,c[r+1]=e*l+n+1,c[r+2]=(e+1)*l+n,c[r+3]=(e+1)*l+n,c[r+4]=e*l+n+1,c[r+5]=(e+1)*l+n+1}return{positions:s,indices:c,normals:a,texCoords:u}}(t,n,r)}))}}class gi extends Mr{constructor(e,t={}){super(e,Object.assign({},t,{geometry:new ii(t)}))}}class mi extends Mr{constructor(e,t={}){const{id:n=A("cube")}=t;super(e,Object.assign({},t,{id:n,geometry:new oi(t)}))}}class Ei extends Mr{constructor(e,t={}){super(e,Object.assign({},t,{geometry:new li(t)}))}}class vi extends Mr{constructor(e,t={}){super(e,Object.assign({},t,{geometry:new di(t)}))}}class yi extends Mr{constructor(e,t={}){const{id:n=A("plane")}=t;super(e,Object.assign({},t,{id:n,geometry:new pi(t)}))}}class bi extends Mr{constructor(e,t={}){const{id:n=A("sphere")}=t;super(e,Object.assign({},t,{id:n,geometry:new _i(t)}))}}class Ai extends Mr{constructor(e,t={}){super(e,Object.assign({},t,{geometry:new ri(t)}))}}const Ti="attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",Ri=[-1,-1,1,-1,-1,1,1,1];class xi extends Mr{constructor(e,t){const n=Ri.map(e=>-1===e?0:e);super(e,Object.assign({},t,{vs:Ti,geometry:new er({drawMode:U.a.TRIANGLE_STRIP,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(Ri)},aTexCoord:{size:2,value:new Float32Array(n)},aCoordinate:{size:2,value:new Float32Array(n)}}})})),this.setVertexCount(4)}}const Si="uniform sampler2D uDiffuseSampler;\nuniform float uOpacity;\n\nvarying vec2 uv;\n\nvoid main() {\n  vec4 texel = texture2D(uDiffuseSampler, uv);\n  gl_FragColor = uOpacity * texel;\n}\n";class Ii extends qr{constructor(e,t={}){super(e,Object.assign({id:"copy-pass",swap:!0},t)),this.clipspace=new xi(e,{id:"copy-pass",fs:Si})}_renderPass({inputBuffer:e}){const{opacity:t=1}=this.props;this.clipspace.draw({uniforms:{uDiffuseSampler:e,uOpacity:t},parameters:{depthWrite:!1,depthTest:!1}})}}const Ci="uniform sampler2D uDiffuseSampler;\nuniform float uOpacity;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 texel = texture2D(uDiffuseSampler, uv);\n  gl_FragColor = uOpacity * texel;\n}\n";class Ni extends qr{constructor(e,t={}){super(e,Object.assign({id:"texture-pass"},t));const{texture:n,opacity:r=1}=t;this.clipspace=new xi(e,{id:"texture-pass",fs:Ci,uniforms:{uDiffuseSampler:n,uOpacity:r}})}_renderPass(){this.clipspace.draw({parameters:{depthWrite:!1,depthTest:!1}})}}class wi extends qr{constructor(e,t={}){super(e,Object.assign({id:"picking-pass"},t))}_renderPass({gl:e,inputBuffer:t,animationProps:n}){const{props:r}=this,i=n?n._mousePosition:r.mousePosition,o=n?n.useDevicePixels:r.useDevicePixels;if(!i){for(const e of this.props.models)e.updateModuleSettings({pickingSelectedColor:null});return}const s=or(e,{models:this.props.models,position:i,useDevicePixels:o,framebuffer:t});for(const e of this.props.models)if(s&&s.model===e){const t=s&&s.color||null;e.updateModuleSettings({pickingSelectedColor:t})}}}class Fi extends qr{constructor(e,t={}){super(e,Object.assign({swap:!0},t))}_renderPass({inputBuffer:e,swapBuffers:t}){this.props.model.setUniforms(this.props),this.props.model.draw({uniforms:{texture:e,texSize:[e.width,e.height]},parameters:{depthWrite:!1,depthTest:!1}})}}class Mi extends Qr{constructor(e,t,n={}){const r=`${t.name}-pass`;Object(lr.normalizeShaderModule)(t);const i=function(e,t,n,r){if(t.filter||t.sampler){const i=Bi(t),o=new Fi(e,{id:n,model:Oi(e,t,i,n,r),uniforms:null});return[o]}const i=t.passes||[];return i.map(o=>{const s=Bi(t,o),a=`${n}-${i.length+1}`;return new Fi(e,Object.assign({id:a,model:Oi(e,t,s,a,r),uniforms:o.uniforms},r))})}(e,t,r,n);super(e,Object.assign({id:r,passes:i},n)),this.module=t}_renderPass({inputBuffer:e,swapBuffers:t}){let n=!0;for(const r of this.module.passes)n||t(),n=!1,r.uniforms&&r.model.setUniforms(r.uniforms),r.model.draw({uniforms:{texture:e,texSize:[e.width,e.height]},parameters:{depthWrite:!1,depthTest:!1}})}}function Oi(e,t,n,r,i){const o=new xi(e,{id:r,fs:n,modules:[t]}),s=Object.assign(t.getUniforms(),t.getUniforms(i));return o.setUniforms(s),o}const Li=e=>`uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ${e}(gl_FragColor, texSize, texCoord);\n}\n`,Pi=e=>`uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ${e}(texture, texSize, texCoord);\n}\n`;function Bi(e,t=e){if(t.filter){const n="string"==typeof t.filter?t.filter:`${e.name}_filterColor`;return Li(n)}if(t.sampler){const n="string"==typeof t.sampler?t.sampler:`${e.name}_sampleColor`;return Pi(n)}return null}const Di="attribute vec2 vertex;\nattribute vec2 _texCoord;\nvarying vec2 texCoord;\nvoid main() {\n  texCoord = _texCoord;\n  gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);\n}\n";class Ui{constructor(){if(this.canvas=document.createElement("canvas"),this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.gl=Be({canvas:this.canvas,opts:{premultipliedAlpha:!1}}),!this.gl)throw new Error("This browser does not support WebGL");this.texture=null,this.spareTexture=null,this.flippedModel=null}installFiltersAsMethods(e){for(const t in e)"canvas"!==t&&(this[t]=(n=>this.filter(e[t],n).bind(this)))}setTexture(e){return this.texture=new ze(this.gl,{pixels:e}),this.resize(this.gl,this.texture.width,this.texture.height),this}resize(e,t,n){if(e.canvas.width!==t||e.canvas.height!==n){e.canvas.width=t,e.canvas.height=n;const r=Math.floor(t/1),i=Math.floor(n/1);e.canvas.style.width=`${r}px`,e.canvas.style.height=`${i}px`,e.viewport(0,0,t,n),this.width=r,this.height=i}}replace(e){return e.parentNode.insertBefore(this.canvas,e),e.parentNode.removeChild(e),this}draw(){return this.multiPassRenderer=new Jr(this.gl,[new ei(this.gl),new Ni(this.gl,{texture:this.texture}),new Ii(this.gl,{screen:!0})]),this.multiPassRenderer.render(),this}update(){return this.multiPassRenderer.render({}),this}filter(e,t){return this.multiPassRenderer=new Jr(this.gl,[new ei(this.gl),new Ni(this.gl,{texture:this.texture}),new Mi(this.gl,e,t),new Ii(this.gl,{screen:!0})]),this.multiPassRenderer.render(),this}getPixelArray(){const e=this.gl,t=this.texture.width,n=this.texture.height,r=new Uint8Array(t*n*4);return this.texture.drawTo(()=>e.readPixels(0,0,t,n,e.RGBA,e.UNSIGNED_BYTE,r)),r}_initialize(e,t){const n=this.gl;let r=n.UNSIGNED_BYTE;if(this.gl.getExtension("OES_texture_float")&&n.getExtension("OES_texture_float_linear")){const e=new ze(this.gl,{width:100,height:100,format:n.RGBA,type:n.FLOAT});try{e.drawTo(()=>{r=n.FLOAT})}catch(e){}e.destroy()}this.spareTexture&&this.spareTexture.destroy(),this.width=e,this.height=t,this.texture=new ze(this.gl,{width:e,height:t,format:n.RGBA,type:r}),this.spareTexture=new ze(this.gl,{width:e,height:t,format:n.RGBA,type:r}),this.extraTexture=this.extraTexture||new ze(this.gl,{width:0,height:0,format:n.RGBA,type:r}),this.flippedModel=this.flippedModel||new Mr(this.gl,{vs:Di,fs:"uniform sampler2D texture;\nvarying vec2 texCoord;\nvoid main() {\n  gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));\n}\n"}),this.isInitialized=!0}}const ki=[0,0,1],Gi=[0,0,-1],ji=1,Vi=[255,255,255];class Hi extends rr{constructor(e){super(e);const{color:t=Vi,intensity:n=ji}=e;this.color=t,this.intensity=n}}class Xi extends Hi{constructor(e){super(e);const{direction:t=Gi}=e;this.direction=new nr.Vector3(t).normalize().toArray()}}class $i extends Hi{}class zi extends Hi{constructor(e){super(e);const{position:t=ki}=e;this.position=t}}class Wi{}const Yi={ambient:.4,diffuse:.6,shininess:32,specularColor:[255,255,255]};class Ki extends Wi{constructor(e){super(e),e=Object.assign({},Yi,e),Object.assign(this,e)}}class qi extends Wi{}n(33),n.d(t,"isWebGL",function(){return O}),n.d(t,"isWebGL2",function(){return L}),n.d(t,"cloneTextureFrom",function(){return Lt}),n.d(t,"getKeyValue",function(){return Z}),n.d(t,"getKey",function(){return J}),n.d(t,"createGLContext",function(){return Be}),n.d(t,"destroyGLContext",function(){return De}),n.d(t,"resizeGLContext",function(){return Ue}),n.d(t,"pollGLContext",function(){return ke}),n.d(t,"setContextDefaults",function(){return Pe}),n.d(t,"getContextInfo",function(){return yt}),n.d(t,"getGLContextInfo",function(){return vt}),n.d(t,"getContextLimits",function(){return Et}),n.d(t,"glGetDebugInfo",function(){return xe}),n.d(t,"FEATURES",function(){return At}),n.d(t,"hasFeature",function(){return Rt}),n.d(t,"hasFeatures",function(){return xt}),n.d(t,"getFeatures",function(){return St}),n.d(t,"canCompileGLGSExtension",function(){return Ct}),n.d(t,"trackContextState",function(){return _e.a}),n.d(t,"resetParameters",function(){return fe.d}),n.d(t,"getParameter",function(){return fe.b}),n.d(t,"getParameters",function(){return fe.c}),n.d(t,"setParameter",function(){return fe.e}),n.d(t,"setParameters",function(){return pe}),n.d(t,"withParameters",function(){return me}),n.d(t,"getModifiedParameters",function(){return fe.a}),n.d(t,"Buffer",function(){return ce}),n.d(t,"Shader",function(){return Bt}),n.d(t,"VertexShader",function(){return Dt}),n.d(t,"FragmentShader",function(){return Ut}),n.d(t,"Program",function(){return bn}),n.d(t,"Framebuffer",function(){return wt}),n.d(t,"Renderbuffer",function(){return Ze}),n.d(t,"Texture2D",function(){return ze}),n.d(t,"TextureCube",function(){return Ye}),n.d(t,"clear",function(){return at}),n.d(t,"clearBuffer",function(){return ut}),n.d(t,"readPixelsToArray",function(){return lt}),n.d(t,"readPixelsToBuffer",function(){return ft}),n.d(t,"copyToDataUrl",function(){return ht}),n.d(t,"copyToImage",function(){return dt}),n.d(t,"copyToTexture",function(){return pt}),n.d(t,"blit",function(){return _t}),n.d(t,"FenceSync",function(){return An}),n.d(t,"Query",function(){return On}),n.d(t,"Sampler",function(){return kt}),n.d(t,"Texture3D",function(){return Ke}),n.d(t,"Texture2DArray",function(){return Ln}),n.d(t,"TransformFeedback",function(){return Pn}),n.d(t,"VertexArrayObject",function(){return jn}),n.d(t,"VertexArray",function(){return Xn}),n.d(t,"UniformBufferLayout",function(){return Kn}),n.d(t,"_Accessor",function(){return ie}),n.d(t,"_clearBuffer",function(){return ut}),n.d(t,"AnimationLoop",function(){return Qn}),n.d(t,"Geometry",function(){return er}),n.d(t,"Mesh",function(){return tr}),n.d(t,"pickModels",function(){return or}),n.d(t,"encodePickingColor",function(){return ar}),n.d(t,"decodePickingColor",function(){return ur}),n.d(t,"getNullPickingColor",function(){return cr}),n.d(t,"Transform",function(){return kr}),n.d(t,"_Attribute",function(){return Nr}),n.d(t,"_ShaderCache",function(){return Gr}),n.d(t,"_AnimationLoopProxy",function(){return jr}),n.d(t,"ScenegraphNode",function(){return rr}),n.d(t,"Group",function(){return ir}),n.d(t,"Camera",function(){return Vr}),n.d(t,"Model",function(){return Mr}),n.d(t,"GLTFInstantiator",function(){return Kr}),n.d(t,"_MultiPassRenderer",function(){return Jr}),n.d(t,"_RenderState",function(){return Zr}),n.d(t,"_Pass",function(){return qr}),n.d(t,"_CompositePass",function(){return Qr}),n.d(t,"_ClearPass",function(){return ei}),n.d(t,"_RenderPass",function(){return ti}),n.d(t,"_CopyPass",function(){return Ii}),n.d(t,"_TexturePass",function(){return Ni}),n.d(t,"_PickingPass",function(){return wi}),n.d(t,"_ShaderModulePass",function(){return Mi}),n.d(t,"_Canvas",function(){return Ui}),n.d(t,"ConeGeometry",function(){return ii}),n.d(t,"CubeGeometry",function(){return oi}),n.d(t,"CylinderGeometry",function(){return li}),n.d(t,"IcoSphereGeometry",function(){return di}),n.d(t,"PlaneGeometry",function(){return pi}),n.d(t,"SphereGeometry",function(){return _i}),n.d(t,"TruncatedConeGeometry",function(){return ri}),n.d(t,"Cone",function(){return gi}),n.d(t,"Cube",function(){return mi}),n.d(t,"Cylinder",function(){return Ei}),n.d(t,"IcoSphere",function(){return vi}),n.d(t,"Plane",function(){return yi}),n.d(t,"Sphere",function(){return bi}),n.d(t,"TruncatedCone",function(){return Ai}),n.d(t,"ClipSpace",function(){return xi}),n.d(t,"setPathPrefix",function(){return He}),n.d(t,"loadFile",function(){return Xe}),n.d(t,"loadImage",function(){return $e}),n.d(t,"DirectionalLight",function(){return Xi}),n.d(t,"AmbientLight",function(){return $i}),n.d(t,"PointLight",function(){return zi}),n.d(t,"Material",function(){return Wi}),n.d(t,"PhongMaterial",function(){return Ki}),n.d(t,"PBRMaterial",function(){return qi}),n.d(t,"registerShaderModules",function(){return lr.registerShaderModules}),n.d(t,"setDefaultShaderModules",function(){return lr.setDefaultShaderModules}),n.d(t,"assembleShaders",function(){return lr.assembleShaders}),n.d(t,"combineInjects",function(){return lr.combineInjects}),n.d(t,"normalizeShaderModule",function(){return lr.normalizeShaderModule}),n.d(t,"fp32",function(){return lr.fp32}),n.d(t,"fp64",function(){return lr.fp64}),n.d(t,"project",function(){return lr.project}),n.d(t,"lighting",function(){return lr.lighting}),n.d(t,"dirlight",function(){return lr.dirlight}),n.d(t,"picking",function(){return lr.picking}),n.d(t,"diffuse",function(){return lr.diffuse}),n.d(t,"phonglighting",function(){return lr.phonglighting}),n.d(t,"_transform",function(){return lr._transform}),n.d(t,"MODULAR_SHADERS",function(){return lr.MODULAR_SHADERS}),n.d(t,"getQualifierDetails",function(){return lr.getQualifierDetails}),n.d(t,"getPassthroughFS",function(){return lr.getPassthroughFS}),n.d(t,"typeToChannelSuffix",function(){return lr.typeToChannelSuffix}),n.d(t,"typeToChannelCount",function(){return lr.typeToChannelCount}),n.d(t,"convertToVec4",function(){return lr.convertToVec4}),n.d(t,"ClipSpaceQuad",function(){return xi}),n.d(t,"log",function(){return x.a}),n.d(t,"global",function(){return r.a})},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)})(e)}n.d(t,"a",function(){return i})},function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return d});var r=n(0),i=n.n(r),o=n(12);const s={[i.a.BLEND]:!1,[i.a.BLEND_COLOR]:new Float32Array([0,0,0,0]),[i.a.BLEND_EQUATION_RGB]:i.a.FUNC_ADD,[i.a.BLEND_EQUATION_ALPHA]:i.a.FUNC_ADD,[i.a.BLEND_SRC_RGB]:i.a.ONE,[i.a.BLEND_DST_RGB]:i.a.ZERO,[i.a.BLEND_SRC_ALPHA]:i.a.ONE,[i.a.BLEND_DST_ALPHA]:i.a.ZERO,[i.a.COLOR_CLEAR_VALUE]:new Float32Array([0,0,0,0]),[i.a.COLOR_WRITEMASK]:[!0,!0,!0,!0],[i.a.CULL_FACE]:!1,[i.a.CULL_FACE_MODE]:i.a.BACK,[i.a.DEPTH_TEST]:!1,[i.a.DEPTH_CLEAR_VALUE]:1,[i.a.DEPTH_FUNC]:i.a.LESS,[i.a.DEPTH_RANGE]:new Float32Array([0,1]),[i.a.DEPTH_WRITEMASK]:!0,[i.a.DITHER]:!0,[i.a.FRAMEBUFFER_BINDING]:null,[i.a.FRONT_FACE]:i.a.CCW,[i.a.GENERATE_MIPMAP_HINT]:i.a.DONT_CARE,[i.a.LINE_WIDTH]:1,[i.a.POLYGON_OFFSET_FILL]:!1,[i.a.POLYGON_OFFSET_FACTOR]:0,[i.a.POLYGON_OFFSET_UNITS]:0,[i.a.SAMPLE_COVERAGE_VALUE]:1,[i.a.SAMPLE_COVERAGE_INVERT]:!1,[i.a.SCISSOR_TEST]:!1,[i.a.SCISSOR_BOX]:new Int32Array([0,0,1024,1024]),[i.a.STENCIL_TEST]:!1,[i.a.STENCIL_CLEAR_VALUE]:0,[i.a.STENCIL_WRITEMASK]:4294967295,[i.a.STENCIL_BACK_WRITEMASK]:4294967295,[i.a.STENCIL_FUNC]:i.a.ALWAYS,[i.a.STENCIL_REF]:0,[i.a.STENCIL_VALUE_MASK]:4294967295,[i.a.STENCIL_BACK_FUNC]:i.a.ALWAYS,[i.a.STENCIL_BACK_REF]:0,[i.a.STENCIL_BACK_VALUE_MASK]:4294967295,[i.a.STENCIL_FAIL]:i.a.KEEP,[i.a.STENCIL_PASS_DEPTH_FAIL]:i.a.KEEP,[i.a.STENCIL_PASS_DEPTH_PASS]:i.a.KEEP,[i.a.STENCIL_BACK_FAIL]:i.a.KEEP,[i.a.STENCIL_BACK_PASS_DEPTH_FAIL]:i.a.KEEP,[i.a.STENCIL_BACK_PASS_DEPTH_PASS]:i.a.KEEP,[i.a.VIEWPORT]:new Int32Array([0,0,1024,1024]),[i.a.PACK_ALIGNMENT]:4,[i.a.UNPACK_ALIGNMENT]:4,[i.a.UNPACK_FLIP_Y_WEBGL]:!1,[i.a.UNPACK_PREMULTIPLY_ALPHA_WEBGL]:!1,[i.a.UNPACK_COLORSPACE_CONVERSION_WEBGL]:i.a.BROWSER_DEFAULT_WEBGL,[i.a.FRAGMENT_SHADER_DERIVATIVE_HINT]:i.a.DONT_CARE,[i.a.READ_FRAMEBUFFER_BINDING]:null,[i.a.RASTERIZER_DISCARD]:!1,[i.a.PACK_ROW_LENGTH]:0,[i.a.PACK_SKIP_PIXELS]:0,[i.a.PACK_SKIP_ROWS]:0,[i.a.UNPACK_ROW_LENGTH]:0,[i.a.UNPACK_IMAGE_HEIGHT]:0,[i.a.UNPACK_SKIP_PIXELS]:0,[i.a.UNPACK_SKIP_ROWS]:0,[i.a.UNPACK_SKIP_IMAGES]:0},a=(e,t,n)=>t?e.enable(n):e.disable(n),u=(e,t,n)=>e.hint(n,t),c=(e,t,n)=>e.pixelStorei(n,t),l={[i.a.BLEND]:a,[i.a.BLEND_COLOR]:(e,t)=>e.blendColor(...t),[i.a.BLEND_EQUATION_RGB]:"blendEquation",[i.a.BLEND_EQUATION_ALPHA]:"blendEquation",[i.a.BLEND_SRC_RGB]:"blendFunc",[i.a.BLEND_DST_RGB]:"blendFunc",[i.a.BLEND_SRC_ALPHA]:"blendFunc",[i.a.BLEND_DST_ALPHA]:"blendFunc",[i.a.COLOR_CLEAR_VALUE]:(e,t)=>e.clearColor(...t),[i.a.COLOR_WRITEMASK]:(e,t)=>e.colorMask(...t),[i.a.CULL_FACE]:a,[i.a.CULL_FACE_MODE]:(e,t)=>e.cullFace(t),[i.a.DEPTH_TEST]:a,[i.a.DEPTH_CLEAR_VALUE]:(e,t)=>e.clearDepth(t),[i.a.DEPTH_FUNC]:(e,t)=>e.depthFunc(t),[i.a.DEPTH_RANGE]:(e,t)=>e.depthRange(...t),[i.a.DEPTH_WRITEMASK]:(e,t)=>e.depthMask(t),[i.a.DITHER]:a,[i.a.FRAGMENT_SHADER_DERIVATIVE_HINT]:u,[i.a.FRAMEBUFFER_BINDING]:(e,t)=>{const n=Object(o.c)(e)?i.a.DRAW_FRAMEBUFFER:i.a.FRAMEBUFFER;return e.bindFramebuffer(n,t)},[i.a.FRONT_FACE]:(e,t)=>e.frontFace(t),[i.a.GENERATE_MIPMAP_HINT]:u,[i.a.LINE_WIDTH]:(e,t)=>e.lineWidth(t),[i.a.POLYGON_OFFSET_FILL]:a,[i.a.POLYGON_OFFSET_FACTOR]:"polygonOffset",[i.a.POLYGON_OFFSET_UNITS]:"polygonOffset",[i.a.RASTERIZER_DISCARD]:a,[i.a.SAMPLE_COVERAGE_VALUE]:"sampleCoverage",[i.a.SAMPLE_COVERAGE_INVERT]:"sampleCoverage",[i.a.SCISSOR_TEST]:a,[i.a.SCISSOR_BOX]:(e,t)=>e.scissor(...t),[i.a.STENCIL_TEST]:a,[i.a.STENCIL_CLEAR_VALUE]:(e,t)=>e.clearStencil(t),[i.a.STENCIL_WRITEMASK]:(e,t)=>e.stencilMaskSeparate(i.a.FRONT,t),[i.a.STENCIL_BACK_WRITEMASK]:(e,t)=>e.stencilMaskSeparate(i.a.BACK,t),[i.a.STENCIL_FUNC]:"stencilFuncFront",[i.a.STENCIL_REF]:"stencilFuncFront",[i.a.STENCIL_VALUE_MASK]:"stencilFuncFront",[i.a.STENCIL_BACK_FUNC]:"stencilFuncBack",[i.a.STENCIL_BACK_REF]:"stencilFuncBack",[i.a.STENCIL_BACK_VALUE_MASK]:"stencilFuncBack",[i.a.STENCIL_FAIL]:"stencilOpFront",[i.a.STENCIL_PASS_DEPTH_FAIL]:"stencilOpFront",[i.a.STENCIL_PASS_DEPTH_PASS]:"stencilOpFront",[i.a.STENCIL_BACK_FAIL]:"stencilOpBack",[i.a.STENCIL_BACK_PASS_DEPTH_FAIL]:"stencilOpBack",[i.a.STENCIL_BACK_PASS_DEPTH_PASS]:"stencilOpBack",[i.a.VIEWPORT]:(e,t)=>e.viewport(...t),[i.a.PACK_ALIGNMENT]:c,[i.a.UNPACK_ALIGNMENT]:c,[i.a.UNPACK_FLIP_Y_WEBGL]:c,[i.a.UNPACK_PREMULTIPLY_ALPHA_WEBGL]:c,[i.a.UNPACK_COLORSPACE_CONVERSION_WEBGL]:c,[i.a.PACK_ROW_LENGTH]:c,[i.a.PACK_SKIP_PIXELS]:c,[i.a.PACK_SKIP_ROWS]:c,[i.a.READ_FRAMEBUFFER_BINDING]:(e,t)=>e.bindFramebuffer(i.a.READ_FRAMEBUFFER,t),[i.a.UNPACK_ROW_LENGTH]:c,[i.a.UNPACK_IMAGE_HEIGHT]:c,[i.a.UNPACK_SKIP_PIXELS]:c,[i.a.UNPACK_SKIP_ROWS]:c,[i.a.UNPACK_SKIP_IMAGES]:c},f={blendEquation:(e,t)=>e.blendEquationSeparate(t[i.a.BLEND_EQUATION_RGB],t[i.a.BLEND_EQUATION_ALPHA]),blendFunc:(e,t)=>e.blendFuncSeparate(t[i.a.BLEND_SRC_RGB],t[i.a.BLEND_DST_RGB],t[i.a.BLEND_SRC_ALPHA],t[i.a.BLEND_DST_ALPHA]),polygonOffset:(e,t)=>e.polygonOffset(t[i.a.POLYGON_OFFSET_FACTOR],t[i.a.POLYGON_OFFSET_UNITS]),sampleCoverage:(e,t)=>e.sampleCoverage(t[i.a.SAMPLE_COVERAGE_VALUE],t[i.a.SAMPLE_COVERAGE_INVERT]),stencilFuncFront:(e,t)=>e.stencilFuncSeparate(i.a.FRONT,t[i.a.STENCIL_FUNC],t[i.a.STENCIL_REF],t[i.a.STENCIL_VALUE_MASK]),stencilFuncBack:(e,t)=>e.stencilFuncSeparate(i.a.BACK,t[i.a.STENCIL_BACK_FUNC],t[i.a.STENCIL_BACK_REF],t[i.a.STENCIL_BACK_VALUE_MASK]),stencilOpFront:(e,t)=>e.stencilOpSeparate(i.a.FRONT,t[i.a.STENCIL_FAIL],t[i.a.STENCIL_PASS_DEPTH_FAIL],t[i.a.STENCIL_PASS_DEPTH_PASS]),stencilOpBack:(e,t)=>e.stencilOpSeparate(i.a.BACK,t[i.a.STENCIL_BACK_FAIL],t[i.a.STENCIL_BACK_PASS_DEPTH_FAIL],t[i.a.STENCIL_BACK_PASS_DEPTH_PASS])},h=(e,t)=>e.isEnabled(t),d={[i.a.BLEND]:h,[i.a.CULL_FACE]:h,[i.a.DEPTH_TEST]:h,[i.a.DITHER]:h,[i.a.POLYGON_OFFSET_FILL]:h,[i.a.SAMPLE_ALPHA_TO_COVERAGE]:h,[i.a.SAMPLE_COVERAGE]:h,[i.a.SCISSOR_TEST]:h,[i.a.STENCIL_TEST]:h,[i.a.RASTERIZER_DISCARD]:h}},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o});n(31);function r(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}function i(e){for(const t in e)return!1;return!0}function o(e){return e&&32874===e.TEXTURE_BINDING_3D}},function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"f",function(){return a}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return f});var r=n(11),i=n(31),o=n(12);function s(e,t,n){const i=r.c[t],s=i?i(e,Number(t)):e.getParameter(Number(t)),a=r.d[t];return Object(o.a)("function"==typeof a),a(e,n,Number(t)),s}function a(e,t){const n={};for(const i in t){const o=Number(i),s=r.d[i];s&&("string"==typeof s?n[s]=!0:s(e,t[i],o))}const i=e.state&&e.state.cache;if(i){const o=Object.assign({},i,t);for(const t in n){(0,r.a[t])(e,o)}}}function u(e,t){const n=r.c[t];return n?n(e,Number(t)):e.getParameter(Number(t))}function c(e,t){t=t||r.b;const n=Array.isArray(t)?t:Object.keys(t),i={};for(const t of n)i[t]=u(e,t);return i}function l(e){a(e,Object.assign({},r.b,{}))}function f(e){const t=c(r.b),n={};for(const e in r.b)Object(i.a)(t[e],r.b[e])||(n[e]=t[e]);return n}},function(e,t,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function r(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function i(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var o=n(107),s=Object.prototype.hasOwnProperty,a=Array.prototype.slice,u="foo"===function(){}.name;function c(e){return Object.prototype.toString.call(e)}function l(e){return!i(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var f=e.exports=m,h=/\s*function\s+([^\(\s]*)\s*/;function d(e){if(o.isFunction(e)){if(u)return e.name;var t=e.toString().match(h);return t&&t[1]}}function p(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function _(e){if(u||!o.isFunction(e))return o.inspect(e);var t=d(e);return"[Function"+(t?": "+t:"")+"]"}function g(e,t,n,r,i){throw new f.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function m(e,t){e||g(e,!0,t,"==",f.ok)}function E(e,t,n,s){if(e===t)return!0;if(i(e)&&i(t))return 0===r(e,t);if(o.isDate(e)&&o.isDate(t))return e.getTime()===t.getTime();if(o.isRegExp(e)&&o.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(l(e)&&l(t)&&c(e)===c(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;var u=(s=s||{actual:[],expected:[]}).actual.indexOf(e);return-1!==u&&u===s.expected.indexOf(t)||(s.actual.push(e),s.expected.push(t),function(e,t,n,r){if(null===e||void 0===e||null===t||void 0===t)return!1;if(o.isPrimitive(e)||o.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=v(e),s=v(t);if(i&&!s||!i&&s)return!1;if(i)return e=a.call(e),t=a.call(t),E(e,t,n);var u,c,l=A(e),f=A(t);if(l.length!==f.length)return!1;for(l.sort(),f.sort(),c=l.length-1;c>=0;c--)if(l[c]!==f[c])return!1;for(c=l.length-1;c>=0;c--)if(u=l[c],!E(e[u],t[u],n,r))return!1;return!0}(e,t,n,s))}return n?e===t:e==t}function v(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function y(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function b(e,t,n,r){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(e){var t;try{e()}catch(e){t=e}return t}(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&g(i,n,"Missing expected exception"+r);var s="string"==typeof r,a=!e&&o.isError(i),u=!e&&i&&!n;if((a&&s&&y(i,n)||u)&&g(i,n,"Got unwanted exception"+r),e&&i&&n&&!y(i,n)||!e&&i)throw i}f.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return p(_(e.actual),128)+" "+e.operator+" "+p(_(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=d(t),o=r.indexOf("\n"+i);if(o>=0){var s=r.indexOf("\n",o+1);r=r.substring(s+1)}this.stack=r}}},o.inherits(f.AssertionError,Error),f.fail=g,f.ok=m,f.equal=function(e,t,n){e!=t&&g(e,t,n,"==",f.equal)},f.notEqual=function(e,t,n){e==t&&g(e,t,n,"!=",f.notEqual)},f.deepEqual=function(e,t,n){E(e,t,!1)||g(e,t,n,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(e,t,n){E(e,t,!0)||g(e,t,n,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(e,t,n){E(e,t,!1)&&g(e,t,n,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function e(t,n,r){E(t,n,!0)&&g(t,n,r,"notDeepStrictEqual",e)},f.strictEqual=function(e,t,n){e!==t&&g(e,t,n,"===",f.strictEqual)},f.notStrictEqual=function(e,t,n){e===t&&g(e,t,n,"!==",f.notStrictEqual)},f.throws=function(e,t,n){b(!0,e,t,n)},f.doesNotThrow=function(e,t,n){b(!1,e,t,n)},f.ifError=function(e){if(e)throw e};var A=Object.keys||function(e){var t=[];for(var n in e)s.call(e,n)&&t.push(n);return t}}).call(this,n(9))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&d())}function d(){if(!l){var e=a(h);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return f}),n.d(t,"c",function(){return h}),n.d(t,"b",function(){return d});var r=n(44),i=n(11),o=n(13),s=n(12);const a=(e,t)=>{const n=Array.isArray(e)||ArrayBuffer.isView(e),r=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&r&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return e===t};function u(e,t){const n=e[t].bind(e);e[t]=function(...t){const r=t[0];return r in e.state.cache||(e.state.cache[r]=n(...t)),e.state.enable?e.state.cache[r]:n(...t)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function c(e,t,n){const r=e[t].bind(e);e[t]=function(...i){const{valueChanged:o,oldValue:s}=n(e.state._updateCache,...i);return o&&(e.state.log(`gl.${t}`,...i),r(...i)),s},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}class l{constructor(e,{copyState:t=!1,log:n=(()=>{})}={}){this.gl=e,this.stateStack=[],this.enable=!0,this.cache=t?Object(o.c)(e):Object.assign({},i.b),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Object(s.a)(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];Object(o.f)(this.gl,e,this.cache),this.stateStack.pop()}_updateCache(e){let t,n=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const i in e)Object(s.a)(void 0!==i),a(e[i],this.cache[i])||(n=!0,t=this.cache[i],!r||i in r||(r[i]=this.cache[i]),this.cache[i]=e[i]);return{valueChanged:n,oldValue:t}}}function f(t,{enable:n=!0,copyState:i}={}){if(Object(s.a)(void 0!==i),!t.state){const o=void 0!==e?e:window;o.polyfillContext&&o.polyfillContext(t),t.state=new l(t,{copyState:i,enable:n});for(const e in r.a){c(t,e,r.a[e])}u(t,"getParameter"),u(t,"isEnabled")}return t.state.enable=n,t}function h(e){e.state||f(e,{copyState:!1}),e.state.push()}function d(e){Object(s.a)(e.state),e.state.pop()}}).call(this,n(9))},function(e,t,n){"use strict";var r=n(29),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=f;var o=n(25);o.inherits=n(16);var s=n(55),a=n(39);o.inherits(f,s);for(var u=i(a.prototype),c=0;c<u.length;c++){var l=u[c];f.prototype[l]||(f.prototype[l]=a.prototype[l])}function f(e){if(!(this instanceof f))return new f(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),f.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return o});var r=n(10),i=n(24);function o(){return!("object"===(void 0===e?"undefined":Object(r.a)(e))&&"[object process]"===String(e)&&!e.browser)||Object(i.a)()}}).call(this,n(15))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return compileShaderModule}),__webpack_require__.d(__webpack_exports__,"c",function(){return compileVertexShader}),__webpack_require__.d(__webpack_exports__,"a",function(){return compileFragmentShader});var glsl_transpiler__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(34),glsl_transpiler__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(glsl_transpiler__WEBPACK_IMPORTED_MODULE_0__),_normalize_uniforms__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(35);function normalize(e){return e.replace(/^(#define \w+) *$/gm,(e,t)=>`${t} 1`)}function getVersion(e){return"#version "===e.slice(0,9)?"300 es":"100 es"}function compileShaderModule(e,t){t=normalize(t);const n=glsl_transpiler__WEBPACK_IMPORTED_MODULE_0___default()({uniform:e=>`uniforms.${e}`,version:getVersion(t)}),r=n(t),{compiler:i}=n;return evalScript(`function vs(uniforms) {\n  ${Object(_normalize_uniforms__WEBPACK_IMPORTED_MODULE_1__.a)(i.uniforms)}\n  ${r}\n  return {\n    ${Object.keys(i.functions).join(",")}\n  };\n}`,e)}function compileVertexShader(e,t){t=normalize(t);const n=glsl_transpiler__WEBPACK_IMPORTED_MODULE_0___default()({uniform:e=>`uniforms.${e}`,attribute:e=>`attributes.${e}`,version:getVersion(t)}),r=n(t),{compiler:i}=n;return evalScript(`function vs(uniforms, attributes) {\n  var gl_Position;\n  ${Object(_normalize_uniforms__WEBPACK_IMPORTED_MODULE_1__.a)(i.uniforms)}\n  ${r}\n  /* End of shader code */\n  main();\n  return {\n    gl_Position,\n    varyings: {${Object.keys(i.varyings).join(", ")}}\n  };\n}`,e)}function compileFragmentShader(e,t){t=normalize(t);const n=glsl_transpiler__WEBPACK_IMPORTED_MODULE_0___default()({uniform:e=>`uniforms.${e}`,attribute:e=>`attributes.${e}`,varying:e=>`varyings.${e}`,version:getVersion(t)}),r=n(t),{compiler:i}=n;return evalScript(`function fs(uniforms, varyings) {\n  var gl_FragColor;\n  var isDiscarded = false;\n  function discard() {\n    isDiscarded = true;\n  }\n  ${Object(_normalize_uniforms__WEBPACK_IMPORTED_MODULE_1__.a)(i.uniforms)}\n  ${r}\n  /* End of shader code */\n  main();\n  return {\n    gl_FragColor,\n    isDiscarded\n  };\n}`,e)}function evalScript(value,name){const script=`(function() { return ${value}; })()\n//# sourceURL=${name}.js`;return eval(script)}},function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i="undefined"!=typeof window&&window.addEventListener,o=new Map,s=function(){return i&&window.__SEER_INITIALIZED__},a=function(e,t){var n=o.get(e),r=Date.now();return!!(n&&r-n<t)||(o.set(e,r),!1)},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i&&s()){var n=new Set,o=JSON.stringify(t,function(e){return function(t,n){if(!n||"object"!==(void 0===n?"undefined":r(n))||!e.has(n))return e.add(n),Object.prototype.toString.call(n).slice(8,-1).includes("Array")?Array.prototype.slice.call(n,0,20):n}}(n));try{window.postMessage({type:e,payload:o,source:"seer-agent"},"*")}catch(e){if(a("seer-log",2e3))return;console.log(e)}}},c=new Map,l=function(e){if(e&&e.data&&"seer-core"===e.data.source){var t=e.data,n=t.type,r=t.payload,i=c.get(n);i&&i.forEach(function(e){return e(r)})}},f=function(){i&&!window.__SEER_LISTENER__&&(window.addEventListener("message",l),window.__SEER_LISTENER__=!0)};t.default={send:u,throttle:a,isReady:s,list:function(e,t){return u("LIST",{key:e,data:t})},listItem:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u("LIST_ITEM",{key:e,itemKey:t,data:n})},updateItem:function(e,t,n,r){return u("UPDATE_ITEM",{key:e,itemKey:t,path:n,data:r})},multiUpdate:function(e,t,n){return u("MULTI_UPDATE_ITEM",{key:e,itemKey:t,array:n})},deleteItem:function(e,t){return u("DELETE_ITEM",{key:e,itemKey:t})},addLog:function(e,t,n){return u("ADD_LOG",{key:e,itemKey:t,msg:n})},listeners:c,listenFor:function(e,t){if(i){if(!e||!t)throw new Error("Please provide a type and callback");c.has(e)||c.set(e,[]),window.__SEER_LISTENER__||f(),c.get(e).push(t)}},removeListener:function(e){c.forEach(function(t,n){c.set(n,t.filter(function(t){return t!==e}))})},init:f,clean:function(){i&&window.__SEER_LISTENER__&&(window.removeEventListener("message",l),delete window.__SEER_LISTENER__)}}},function(e,t,n){"use strict";(function(e){var r=n(62);const i=!("object"==typeof e&&"[object process]"===String(e)&&!e.browser)||r.a;t.a=i}).call(this,n(15))},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return i});var r=n(10);function i(t){if("undefined"!=typeof window&&"object"===Object(r.a)(window.process)&&"renderer"===window.process.type)return!0;if(void 0!==e&&"object"===Object(r.a)(e.versions)&&Boolean(e.versions.electron))return!0;var n="object"===("undefined"==typeof navigator?"undefined":Object(r.a)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,i=t||n;return!!(i&&i.indexOf("Electron")>=0)}}).call(this,n(15))},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,n(58).Buffer)},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,e}},function(e,t,n){"use strict";(function(e){var t=n(0),r=n.n(t),i=n(63);function o(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}function s(e){return e&&e.TEXTURE_BINDING_3D===r.a.TEXTURE_BINDING_3D}const a={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{o(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},ANGLE_instanced_arrays:{meta:{suffix:"ANGLE"},vertexAttribDivisor(e,t){o(0===t,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{o(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{o(!1)},deleteQuery:()=>{o(!1)},beginQuery:()=>{o(!1)},endQuery:()=>{},getQuery(e,t){return this.getQueryObject(e,t)},getQueryParameter(e,t){return this.getQueryObject(e,t)},queryCounter:()=>{},getQueryObject:()=>{}},EXT_disjoint_timer_query_webgl2:{meta:{suffix:"EXT"},queryCounter:null},OVERRIDES:{readBuffer:(e,t,n)=>{s(e)&&t(n)},getVertexAttrib:(e,t,n,i)=>{const{webgl2:o,ext:a}=function(e,t){return{webgl2:s(e),ext:e.getExtension(t)}}(e,"ANGLE_instanced_arrays");let u;switch(i){case r.a.VERTEX_ATTRIB_ARRAY_INTEGER:u=!!o&&void 0;break;case r.a.VERTEX_ATTRIB_ARRAY_DIVISOR:u=o||a?void 0:0}return void 0!==u?u:t(n,i)},getProgramParameter:(e,t,n,i)=>{if(!s(e))switch(i){case r.a.TRANSFORM_FEEDBACK_BUFFER_MODE:return r.a.SEPARATE_ATTRIBS;case r.a.TRANSFORM_FEEDBACK_VARYINGS:case r.a.ACTIVE_UNIFORM_BLOCKS:return 0}return t(n,i)},getInternalformatParameter:(e,t,n,i,o)=>{if(!s(e))switch(o){case r.a.SAMPLES:return new Int32Array([0])}return e.getInternalformatParameter(n,i,o)},getTexParameter(e,t,n,i){switch(i){case r.a.TEXTURE_MAX_ANISOTROPY_EXT:const{extensions:t}=e.luma,n=t.EXT_texture_filter_anisotropic;i=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||r.a.TEXTURE_MAX_ANISOTROPY_EXT}return t(n,i)},getParameter:i.a,hint:(e,t,n,r)=>t(n,r)}};function u(e,{extension:t,target:n,target2:r}){const i=a[t];o(i);const{meta:s={}}=i,{suffix:u=""}=s,c=e.getExtension(t);Object.keys(i).forEach(t=>{const o=`${t}${u}`;let s=null;"meta"===t||"function"==typeof e[t]||(c&&"function"==typeof c[o]?s=((...e)=>c[o](...e)):"function"==typeof i[t]&&(s=i[t].bind(n))),s&&(n[t]=s,r[t]=s)})}(void 0!==e?e:window).polyfillContext=function(e){if(e.luma=e.luma||{},function(e){e.luma.extensions={};const t=e.getSupportedExtensions()||[];for(const n of t)e.luma[n]=e.getExtension(n)}(e),!e.luma.polyfilled){for(const t in a)"overrides"!==t&&u(e,{extension:t,target:e.luma,target2:e});!function(e,{target:t,target2:n}){const{OVERRIDES:r}=a;Object.keys(r).forEach(i=>{if("function"==typeof r[i]){const o=e[i]?e[i].bind(e):()=>{},s=r[i].bind(null,e,o);t[i]=s,n[i]=s}})}(e,{target:e.luma,target2:e}),e.luma.polyfilled=!0}return e}}).call(this,n(9))},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,s,a,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(o(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(i(n))for(a=Array.prototype.slice.call(arguments,1),s=(c=n.slice()).length,u=0;u<s;u++)c[u].apply(this,a);return!0},n.prototype.addListener=function(e,t){var s;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(s=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!r(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var n,o,s,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(n=this._events[e]).length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";(function(t){!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,n)});case 3:return t.nextTick(function(){e.call(null,n,r)});case 4:return t.nextTick(function(){e.call(null,n,r,i)});default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return t.nextTick(function(){e.apply(null,o)})}}}:e.exports=t}).call(this,n(15))},function(e,t,n){var r=n(58),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=s),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),r=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&r&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(19),i=n(6),o="2.0.1",s=Object(r.a)();i.c.probe={};var a=n(24);function u(e){if(!e&&!Object(r.a)())return"Node";if(Object(a.a)(e))return"Electron";var t="undefined"!=typeof navigator?navigator:{},n=e||t.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var o=-1!==n.indexOf("MSIE "),s=-1!==n.indexOf("Trident/");return o||s?"IE":i.e.chrome?"Chrome":i.e.safari?"Safari":i.e.mozInnerScreenX?"Firefox":"Unknown"}var c=n(3),l=n(2);function f(){if(!s){var e=i.d.hrtime();return e[0]+e[1]/1e6}return i.e.performance?i.e.performance.now():Date.now()}f();function h(e){return e<10?"".concat(e.toFixed(2),"ms"):e<100?"".concat(e.toFixed(1),"ms"):e<1e3?"".concat(e.toFixed(0),"ms"):"".concat((e/1e3).toFixed(2),"s")}function d(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>r&&(n=Math.min(n,r/e.width));var o=e.width*n,s=e.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),a]}!function(){function e(t){var n=t.id;Object(c.a)(this,e),this.id=n,this.time=f(),this.counters={},Object.seal(this)}Object(l.a)(e,[{key:"addCounter",value:function(e){return this._getCounter(e),this}},{key:"bump",value:function(e){var t=this._getCounter(e);return t.call++,t.count++,this}},{key:"increment",value:function(e,t){var n=this._getCounter(e);return n.call++,n.count+=t,this}},{key:"addTimer",value:function(e){return this._getCounter(e).time=0,this}},{key:"addTime",value:function(e,t){var n=this._getCounter(e);return n.time+=t,n.count++,this}},{key:"timeStart",value:function(e,t){this._getCounter(e)._startTime=f()}},{key:"timeEnd",value:function(e,t){var n=this._getCounter(e);this.addTime(e,f()-n._startTime)}},{key:"reset",value:function(){for(var e in this.time=f(),this.counters){var t=this.counters[e];t.count=0,t.time=0}return this}},{key:"hasTimeElapsed",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return f()-this.time>1e3}},{key:"getStats",value:function(){var e=(f()-this.time)/1e3,t={};for(var n in this.counters){var r=this.counters[n];t[r.title]={total:r.count,fps:Math.round(r.count/e)},r.time&&(t[r.title].totalTime=h(r.time),t[r.title].avgTime=h(r.time/r.count))}return t}},{key:"getStatsTable",value:function(){var e=this.getStats();for(var t in e)0===e[t].total&&delete e[t];return e}},{key:"getStatNames",value:function(){return Object.keys(this.counters)}},{key:"get",value:function(e){return this._getCounter(e).count}},{key:"getCount",value:function(e){return this._getCounter(e).count}},{key:"getFPS",value:function(e){var t=this._getCounter(e),n=(f()-this.time)/1e3;return Math.round(t.count/n)}},{key:"getTimeString",value:function(){return"".concat(this.id,":").concat(h(this.time),"(").concat(this.count,")")}},{key:"oneSecondPassed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return this.hasTimeElapsed(e)}},{key:"_getCounter",value:function(e){var t=this.counters[e];return t||(t={title:e,unit:"",timer:!1,count:0,time:0,totalTime:0,averageTime:0},this.counters[e]=t),t}},{key:"_incrementTimer",value:function(e,t,n){e.count+=n,e.totalTime+=t,e.averageTime=e.totalTime/n}}])}();var p=n(10),_=n(21);var g=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Object(c.a)(this,e),this.storage=function(e){try{var t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(e){return null}}(r),this.id=t,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return Object(l.a)(e,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(e){return this.config={},this.updateConfiguration(e)}},{key:"updateConfiguration",value:function(e){if(Object.assign(this.config,e),this.storage){var t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}},{key:"_loadConfiguration",value:function(){var e={};if(this.storage){var t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}]),e}(),m={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function E(e){return"string"==typeof e?m[e.toUpperCase()]||m.WHITE:e}function v(e,t){if(!e)throw new Error("Assertion failed. ".concat(t))}var y={debug:s&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},b={enabled:!1,priority:0};function A(){}var T={};var R=function(){function e(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id;Object(c.a)(this,e),this.id=t,this.VERSION=o,this._startTs=f(),this._deltaTs=f(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new g("__probe-".concat(this.id,"__"),b),this.userData={},this.timeStamp("".concat(this.id," started")),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n),i=!0,o=!1,s=void 0;try{for(var a,u=function(){var n=a.value;"function"==typeof e[n]&&(t.find(function(e){return n===e})||(e[n]=e[n].bind(e)))},c=r[Symbol.iterator]();!(i=(a=c.next()).done);i=!0)u()}catch(e){o=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}}(this),Object.seal(this)}return Object(l.a)(e,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getPriority",value:function(){return this._storage.config.priority}},{key:"getLevel",value:function(){return this._storage.config.priority}},{key:"getTotal",value:function(){return Number((f()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((f()-this._deltaTs).toPrecision(10))}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:e}),this}},{key:"setLevel",value:function(e){return this._storage.updateConfiguration({priority:e}),this}},{key:"warn",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this._getLogFunction({message:e,args:n,method:y.warn,once:!0})}},{key:"error",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this._getLogFunction({message:e,args:n,method:y.error})}},{key:"deprecated",value:function(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}},{key:"removed",value:function(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}},{key:"probe",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:e,message:t,args:r,method:y.log,time:!0,once:!0})}},{key:"log",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:e,message:t,args:r,method:y.debug})}},{key:"info",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:e,message:t,args:r,method:console.info})}},{key:"once",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:e,message:t,args:r,method:y.debug||y.info,once:!0})}},{key:"table",value:function(e,t,n){if(t){var r=function(e){for(var t in e)for(var n in e[t])return n||"untitled";return"empty"}(t);return this._getLogFunction({priority:e,message:t,args:n&&[n],tag:r,method:console.table||A})}return A}},{key:"image",value:function(e){var t=e.priority,n=e.image,r=e.message,i=void 0===r?"":r,o=e.scale,a=void 0===o?1:o;return t>this.getPriority()?A:s?this._logImageInBrowser({image:n,message:i,scale:a}):this._logImageInNode({image:n,message:i,scale:a})}},{key:"_logImageInNode",value:function(e){var t=e.image,r=(e.message,e.scale),i=void 0===r?1:r,o=null;try{o=n(104)}catch(e){}return o?function(){return o(t,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then(function(e){return console.log(e)})}:A}},{key:"_logImageInBrowser",value:function(e){var t=e.image,n=e.message,r=void 0===n?"":n,i=e.scale,o=void 0===i?1:i;if("string"==typeof t){var s=new Image;return s.onload=function(){var e,t=d(s,r,o);(e=console).log.apply(e,Object(_.a)(t))},s.src=t,A}var a,u=t.nodeName||"";if("img"===u.toLowerCase())return(a=console).log.apply(a,Object(_.a)(d(t,r,o))),A;if("canvas"===u.toLowerCase()){var c=new Image;return c.onload=function(){var e;return(e=console).log.apply(e,Object(_.a)(d(c,r,o)))},c.src=t.toDataURL(),A}return A}},{key:"time",value:function(e,t){return this._getLogFunction({priority:e,message:t,method:console.time?console.time:console.info})}},{key:"timeEnd",value:function(e,t){return this._getLogFunction({priority:e,message:t,method:console.timeEnd?console.timeEnd:console.info})}},{key:"timeStamp",value:function(e,t){return this._getLogFunction({priority:e,message:t,method:console.timeStamp||A})}},{key:"group",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},r=(n=this._normalizeArguments({priority:e,message:t,opts:n})).collapsed;return this._getLogFunction({priority:e,message:t,opts:n,method:(r?console.groupCollapsed:console.group)||console.info})}},{key:"groupCollapsed",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(e){return this._getLogFunction({priority:e,message:"",method:console.groupEnd||A})}},{key:"withGroup",value:function(e,t,n){var r=this._normalizeArguments({priority:e,message:t});this.group(r);try{n()}finally{this.groupEnd(r.message)}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(e){return 0===(e=this._normalizePriority(e))||this.isEnabled()&&this.getPriority()>=e}},{key:"_getElapsedTime",value:function(){var e=this.getTotal(),t=this.getDelta();return this._deltaTs=f(),{total:e,delta:t}}},{key:"_getLogFunction",value:function(e){if(this._shouldLog(e.priority)){var t=e.method;e=this._parseArguments(e),v(t);var n=e.message,r=e.tag||e.message;if(e.once){if(T[r])return A;T[r]=f()}return n=this._decorateMessage(n,e),t.bind.apply(t,[console,n].concat(Object(_.a)(e.args)))}return A}},{key:"_parseArguments",value:function(e){var t=this._normalizeArguments(e),n=this._getElapsedTime(),r=n.delta,i=n.total;return Object.assign(e,t,{delta:r,total:i})}},{key:"_normalizePriority",value:function(e){var t;switch(Object(p.a)(e)){case"number":t=e;break;case"object":t=e.priority||0;break;default:t=0}return v(Number.isFinite(t)&&t>=0),t}},{key:"_normalizeArguments",value:function(e){var t=e.priority,n=e.message,r=e.args,i=void 0===r?[]:r,o=e.opts,s={priority:this._normalizePriority(t),message:n,args:i};switch(Object(p.a)(t)){case"string":case"function":void 0!==n&&i.unshift(n),Object.assign(s,{message:t});break;case"object":Object.assign(s,t)}return"function"==typeof s.message&&(s.message=this._shouldLog(s.priority)?s.message():""),v("string"==typeof s.message||"object"===Object(p.a)(s.message)),Object.assign(s,o)}},{key:"_decorateMessage",value:function(e,t){if("string"==typeof e){var n="";if(t.time)n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(t-e.length,0);return"".concat(" ".repeat(n)).concat(e)}(h(this._getElapsedTime().total));e=function(e,t,n){return s||"string"!=typeof e||(t&&(t=E(t),e="[".concat(t,"m").concat(e,"[39m")),n&&(t=E(n),e="[".concat(n+10,"m").concat(e,"[49m"))),e}(e=t.time?"".concat(this.id,": ").concat(n,"  ").concat(e):"".concat(this.id,": ").concat(e),t.color,t.background)}return e}},{key:"priority",set:function(e){return this._storage.updateConfiguration({priority:e}),this},get:function(){return this._storage.config.priority}}]),e}();R.VERSION=o;n.d(t,"b",function(){return u}),n.d(t,"a",function(){return R});new R({id:"probe.gl"})},function(e,t,n){"use strict";n.r(t);var r=n(23),i=n(5),o=n(7);n(27);n.d(t,"global",function(){return i.a});const s="untranspiled source";if(i.a.luma&&i.a.luma.VERSION!==s)throw new Error(`luma.gl - multiple VERSIONs detected: ${i.a.luma.VERSION} vs ${s}`);i.a.luma||(r.a&&o.a.log(1,`luma.gl ${s} - set luma.log.priority=1 (or higher) to trace rendering`)(),i.a.luma=i.a.luma||{VERSION:s,version:s,log:o.a,stats:{},globals:{modules:{},nodeIO:{}}});t.default=i.a.luma},function(e,t,n){"use strict";var r=n(48);r.compile=r.string=function(e,t){return r(t).compile(e)},r.stream=n(136),e.exports=r},function(e,t,n){"use strict";n.d(t,"a",function(){return i});const r={vec2:2,vec3:3,vec4:4,bvec2:2,bvec3:3,bvec4:4,ivec2:2,ivec3:3,ivec4:4,mat2:4,mat3:9,mat4:16};function i(e){let t="";for(const n in e)if(e[n].dimensions.length){t+=`uniforms.${n} = normalizeUniform(uniforms.${n}, [${e[n].dimensions[0]}, ${r[e[n].type]}])`}return t&&(t=`${function(e,t){const n=t[1],r=t[0];if(e.length!==r){const t=[];for(let i=0;i<r;i++){t[i]=[];for(let r=0;r<n;r++)t[i][r]=e[i*n+r]}return t}return e}.toString()}\n${t}`),t}},function(e,t){e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty},function(e,t,n){"use strict";var r=n(36),i=n(53),o=n(128);e.exports=function e(t,n){var s;null!=t?(s=new String((t+"").trim())).visible=!0:(s=new String).visible=!1;if(t instanceof String&&r(s,t),n&&r(s,o(n,["type","components","visible","complexity","include","optimize"])),(null==s.complexity||isNaN(s.complexity))&&(s.complexity=Math.max(50,s.length)),void 0===s.type)if(s+"")if(null==s.components)s.type="float",s.components=[s];else{var a=s.components.length;s.type=1===a?"float":a<=4?"vec"+a:"mat"+Math.sqrt(a)|0}else s.type="void",s.components=[];else if(null===s.type);else if(null==s.components)if(s.components=[],a=i[s.type].length,/mat/.test(s.type)&&(a*=i[i[s.type].type].length),1===a)s.components=[s];else for(var u=0;u<a;u++)s.components[u]=e(`${s}[${u}]`,{complexity:1+s.complexity});return null==s.optimize&&s.components&&(s.optimize=s.components.every(function(e){return!!e&&!1!==e.optimize})),s}},function(e,t,n){(t=e.exports=n(55)).Stream=t,t.Readable=t,t.Writable=n(39),t.Duplex=n(18),t.Transform=n(61),t.PassThrough=n(146)},function(e,t,n){"use strict";(function(t,r,i){var o=n(29);function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=E;var a,u=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?r:o.nextTick;E.WritableState=m;var c=n(25);c.inherits=n(16);var l={deprecate:n(145)},f=n(57),h=n(30).Buffer,d=i.Uint8Array||function(){};var p,_=n(59);function g(){}function m(e,t){a=a||n(18),e=e||{};var r=t instanceof a;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,c=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(c||0===c)?c:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var f=!1===e.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(o.nextTick(i,r),o.nextTick(R,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),R(e,t))}(e,n,r,t,i);else{var s=A(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||b(e,n),r?u(y,e,n,s,i):y(e,n,s,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function E(e){if(a=a||n(18),!(p.call(E,this)||this instanceof a))return new E(e);this._writableState=new m(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),f.call(this)}function v(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function y(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),R(e,t)}function b(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var a=0,u=!0;n;)i[a]=n,n.isBuf||(u=!1),n=n.next,a+=1;i.allBuffers=u,v(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,f=n.callback;if(v(e,t,!1,t.objectMode?1:c.length,c,l,f),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function A(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),R(e,t)})}function R(e,t){var n=A(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,o.nextTick(T,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}c.inherits(E,f),m.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(m.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===E&&(e&&e._writableState instanceof m)}})):p=function(e){return e instanceof this},E.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},E.prototype.write=function(e,t,n){var r=this._writableState,i=!1,s=!r.objectMode&&function(e){return h.isBuffer(e)||e instanceof d}(e);return s&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=g),r.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),o.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var i=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),o.nextTick(r,s),i=!1),i}(this,r,e,n))&&(r.pendingcb++,i=function(e,t,n,r,i,o){if(!n){var s=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=h.from(t,n));return t}(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=t.objectMode?1:r.length;t.length+=a;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else v(e,t,!1,a,r,i,o);return u}(this,r,s,e,t,n)),i},E.prototype.cork=function(){this._writableState.corked++},E.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||b(this,e))},E.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),E.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},E.prototype._writev=null,E.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,R(e,t),n&&(t.finished?o.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n)},Object.defineProperty(E.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),E.prototype.destroy=_.destroy,E.prototype._undestroy=_.undestroy,E.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(15),n(143).setImmediate,n(9))},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],a=n[1],u=n[2];return e[0]=i*u-o*a,e[1]=o*s-r*u,e[2]=r*a-i*s,e}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}},function(e,t,n){e.exports=n(114)},function(e,t){e.exports=function(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}},function(e,t,n){"use strict";var r=n(0),i=n.n(r);t.a={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),bindFramebuffer:(e,t,n)=>{switch(t){case i.a.FRAMEBUFFER:return e({[i.a.DRAW_FRAMEBUFFER_BINDING]:n,[i.a.READ_FRAMEBUFFER_BINDING]:n});case i.a.DRAW_FRAMEBUFFER:return e({[i.a.DRAW_FRAMEBUFFER_BINDING]:n});case i.a.READ_FRAMEBUFFER:return e({[i.a.READ_FRAMEBUFFER_BINDING]:n});default:return null}},blendColor:(e,t,n,r,o)=>e({[i.a.BLEND_COLOR]:new Float32Array([t,n,r,o])}),blendEquation:(e,t)=>e({[i.a.BLEND_EQUATION_RGB]:t,[i.a.BLEND_EQUATION_ALPHA]:t}),blendEquationSeparate:(e,t,n)=>e({[i.a.BLEND_EQUATION_RGB]:t,[i.a.BLEND_EQUATION_ALPHA]:n}),blendFunc:(e,t,n)=>e({[i.a.BLEND_SRC_RGB]:t,[i.a.BLEND_DST_RGB]:n,[i.a.BLEND_SRC_ALPHA]:t,[i.a.BLEND_DST_ALPHA]:n}),blendFuncSeparate:(e,t,n,r,o)=>e({[i.a.BLEND_SRC_RGB]:t,[i.a.BLEND_DST_RGB]:n,[i.a.BLEND_SRC_ALPHA]:r,[i.a.BLEND_DST_ALPHA]:o}),clearColor:(e,t,n,r,o)=>e({[i.a.COLOR_CLEAR_VALUE]:new Float32Array([t,n,r,o])}),clearDepth:(e,t)=>e({[i.a.DEPTH_CLEAR_VALUE]:t}),clearStencil:(e,t)=>e({[i.a.STENCIL_CLEAR_VALUE]:t}),colorMask:(e,t,n,r,o)=>e({[i.a.COLOR_WRITEMASK]:[t,n,r,o]}),cullFace:(e,t)=>e({[i.a.CULL_FACE_MODE]:t}),depthFunc:(e,t)=>e({[i.a.DEPTH_FUNC]:t}),depthRange:(e,t,n)=>e({[i.a.DEPTH_RANGE]:new Float32Array([t,n])}),depthMask:(e,t)=>e({[i.a.DEPTH_WRITEMASK]:t}),frontFace:(e,t)=>e({[i.a.FRONT_FACE]:t}),lineWidth:(e,t)=>e({[i.a.LINE_WIDTH]:t}),polygonOffset:(e,t,n)=>e({[i.a.POLYGON_OFFSET_FACTOR]:t,[i.a.POLYGON_OFFSET_UNITS]:n}),sampleCoverage:(e,t,n)=>e({[i.a.SAMPLE_COVERAGE_VALUE]:t,[i.a.SAMPLE_COVERAGE_INVERT]:n}),scissor:(e,t,n,r,o)=>e({[i.a.SCISSOR_BOX]:new Int32Array([t,n,r,o])}),stencilMask:(e,t)=>e({[i.a.STENCIL_WRITEMASK]:t,[i.a.STENCIL_BACK_WRITEMASK]:t}),stencilMaskSeparate:(e,t,n)=>e({[t===i.a.FRONT?i.a.STENCIL_WRITEMASK:i.a.STENCIL_BACK_WRITEMASK]:n}),stencilFunc:(e,t,n,r)=>e({[i.a.STENCIL_FUNC]:t,[i.a.STENCIL_REF]:n,[i.a.STENCIL_VALUE_MASK]:r,[i.a.STENCIL_BACK_FUNC]:t,[i.a.STENCIL_BACK_REF]:n,[i.a.STENCIL_BACK_VALUE_MASK]:r}),stencilFuncSeparate:(e,t,n,r,o)=>e({[t===i.a.FRONT?i.a.STENCIL_FUNC:i.a.STENCIL_BACK_FUNC]:n,[t===i.a.FRONT?i.a.STENCIL_REF:i.a.STENCIL_BACK_REF]:r,[t===i.a.FRONT?i.a.STENCIL_VALUE_MASK:i.a.STENCIL_BACK_VALUE_MASK]:o}),stencilOp:(e,t,n,r)=>e({[i.a.STENCIL_FAIL]:t,[i.a.STENCIL_PASS_DEPTH_FAIL]:n,[i.a.STENCIL_PASS_DEPTH_PASS]:r,[i.a.STENCIL_BACK_FAIL]:t,[i.a.STENCIL_BACK_PASS_DEPTH_FAIL]:n,[i.a.STENCIL_BACK_PASS_DEPTH_PASS]:r}),stencilOpSeparate:(e,t,n,r,o)=>e({[t===i.a.FRONT?i.a.STENCIL_FAIL:i.a.STENCIL_BACK_FAIL]:n,[t===i.a.FRONT?i.a.STENCIL_PASS_DEPTH_FAIL:i.a.STENCIL_BACK_PASS_DEPTH_FAIL]:r,[t===i.a.FRONT?i.a.STENCIL_PASS_DEPTH_PASS:i.a.STENCIL_BACK_PASS_DEPTH_PASS]:o}),viewport:(e,t,n,r,o)=>e({[i.a.VIEWPORT]:new Int32Array([t,n,r,o])})}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],_=t[12],g=t[13],m=t[14],E=t[15],v=n[0],y=n[1],b=n[2],A=n[3];return e[0]=v*r+y*a+b*f+A*_,e[1]=v*i+y*u+b*h+A*g,e[2]=v*o+y*c+b*d+A*m,e[3]=v*s+y*l+b*p+A*E,v=n[4],y=n[5],b=n[6],A=n[7],e[4]=v*r+y*a+b*f+A*_,e[5]=v*i+y*u+b*h+A*g,e[6]=v*o+y*c+b*d+A*m,e[7]=v*s+y*l+b*p+A*E,v=n[8],y=n[9],b=n[10],A=n[11],e[8]=v*r+y*a+b*f+A*_,e[9]=v*i+y*u+b*h+A*g,e[10]=v*o+y*c+b*d+A*m,e[11]=v*s+y*l+b*p+A*E,v=n[12],y=n[13],b=n[14],A=n[15],e[12]=v*r+y*a+b*f+A*_,e[13]=v*i+y*u+b*h+A*g,e[14]=v*o+y*c+b*d+A*m,e[15]=v*s+y*l+b*p+A*E,e}},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o);return e}},function(e,t){e.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},function(e,t,n){"use strict";var r=n(28),i=n(16),o=n(14),s=n(49),a=n(36),u=n(127),c=n(53),l=n(54),f=n(130),h=n(131),d=n(37),p=n(132),_=/^-?[0-9]*(?:.[0-9]+)?(?:e-?[0-9]+)?$/i,g=/^[xyzwstpdrgba]{1,4}$/;function m(e){if(!(this instanceof m))return new m(e);a(this,e),this.reset();var t=this.compile.bind(this);return t.compiler=this,t.compile=t,t}i(m,r),m.prototype.optimize=!0,m.prototype.preprocess=p,m.prototype.debug=!1,m.prototype.version="100 es",m.prototype.operators=l.operators,m.prototype.types=c,m.prototype.builtins=u,m.prototype.parse=s,m.prototype.stdlib=f,m.prototype.reset=function(){this.descriptors?this.descriptors.clear():this.descriptors=new Map,this.scopes={global:{__name:"global",__parentScope:null}},this.structs={},this.uniforms={},this.varyings={},this.attributes={},this.functions={},null!=this.includes&&!0!==this.includes||(this.includes={}),this.currentScope="global"},m.prototype.compile=function(e){this.preprocess&&(e=this.preprocess instanceof Function?this.preprocess(e):p(e)),e=this.parse(e);var t=this.process(e);return t=this.stringifyStdlib(this.includes)+"\n"+t},m.prototype.process=function(e,t){if(e instanceof String)return e;if(this.descriptors.has(e))return this.descriptors.get(e);if(null==e||"number"==typeof e||"string"==typeof e||"boolean"==typeof e)return this.cache(e,d(e,{complexity:0}));if(!e.hasOwnProperty("type"))return this.cache(e,d(null));var n=this.transforms[e.type],r=!1;if(void 0===n)return console.warn(`Unknown node type '${e.type}'`),this.cache(e,null);if(!n)return this.cache(e,null);if("function"!=typeof n)return this.cache(e,n);this.started||(this.emit("start",e),this.started=!0,r=!0);var i=n.call(this,e,t);return this.optimize&&(i=this.optimizeDescriptor(i)),this.cache(i),this.addInclude(i.include),r&&(this.started=!1,this.emit("end",e)),i},m.prototype.optimizeDescriptor=function(e){if(this.optimize&&!1!==e.optimize&&e.components){var t=e.components.reduce(function(e,t){return e+t.complexity||0},0);if(t<e.complexity&&e.components&&e.components.length>1){var n=e.components.map(function(e){return e.include},this).filter(Boolean);return d(`[${e.components.join(", ")}]`,a(e,{include:n,complexity:t}))}}return e},m.prototype.cache=function(e,t){return this.descriptors.has(e)?this.descriptors.get(e):(t instanceof String||(t=d(t)),this.descriptors.set(e,t),this.descriptors.get(e))},m.prototype.transforms={stmtlist:function(e){if(!e.children.length)return d(null);var t=e.children.map(this.process,this).join("\n");return d(t)},stmt:function(e){var t=e.children.map(this.process,this).join("");return t&&";"!==t[t.length-1]&&(t+=";"),d(t)},struct:function(e){var t=e.children[0].data,n=e.children.slice(1),r=h(n.map(function(e){if("decl"!==e.type)throw Error("Struct statements should be declarations.");var t=e.children[e.children.length-1];if("decllist"!==t.type)throw Error("Struct statement declaration has wrong structure.");return t.children.map(function(e){if("ident"===e.type)return e.data;throw"quantifier"===e.type&&console.log(e),Error("Struct statement contains something strange.")})})),i=h(n.map(function(e){var t=e.children[4].token.data;return e.children[e.children.length-1].children.map(function(){return t})})),o=function(){var e=arguments,n=[],o=r.map(function(t,r){if(e[r])var o=this.process(e[r]);else o=this.types[i[r]].call(this,e[r]);return o=this.optimizeDescriptor(o),n=n.concat(o.include),d(`${t}: ${o}`,{type:i[r],optimize:!1,components:o.components})},this);return d(`{\n${o.join(",\n")}\n}`,{type:t,optimize:!1,include:n.filter(Boolean),components:o})}.bind(this);return Object.defineProperty(o,"length",{value:i.length}),this.structs[t]=this.types[t]=o,d(null)},function:function(e){var t="";if(e.children.length<3)return d(null);o.equal(e.children[0].type,"ident","Function should have an identifier.");var n=this.process(e.children[0]);o.equal(e.children[1].type,"functionargs","Function should have arguments.");var r=this.process(e.children[1]),i=e.parent.children[4].token.data,s=r.components.map(function(e){return`${e.type}`}).join("_"),a=[],u=[];r.components.forEach(function(e,t){e.index=t,"in"===e.qualifier.slice(0,2)&&a.push(e),"out"===e.qualifier.slice(-3)&&u.push(e)}),0===u.length&&(u=null),this.functions[n]&&s&&(n=`${n}_${s}`),o.equal(e.children[2].type,"stmtlist","Function should have a body."),t+=`function ${n} (${r}) {\n`,a.forEach(function(e){/^(vec|mat)/.test(e.type)&&(t+=`${e} = ${e}.slice();\n`)});var c=this.scopes[this.currentScope];return c.callName=n,c.outArgs=u,t+=this.process(e.children[2]),u&&"void"===i&&(t+=`\n${n}.__out__ = [${u.join(", ")}];`),t=t.replace(/\n/g,"\n\t"),t+="\n}",this.currentScope=this.scopes[this.currentScope].__parentScope.__name,(t=d(t,{type:i,complexity:999})).outArgs=u,this.functions[n]=t,t},functionargs:function(e){var t=this.currentScope,n=e.parent&&e.parent.children[0].data||"global";this.currentScope=n,this.scopes[n]||(this.scopes[n]={__parentScope:this.scopes[t],__name:n});var r=e.children.map(this.process,this);return d(r.join(", "),{components:r})},decl:function(e){var t,n=e.children[4],r=e.children[5];if("struct"===e.token.data&&(this.process(n),!r))return d(null);if(o("decllist"===r.type||"function"===r.type||"struct"===r.type,"Decl structure is malicious"),"function"===r.type)return this.process(r);if("functionargs"===e.parent.type){t=this.process(r);var i=e.token.data;return i===t.type?t.qualifier="in":t.qualifier=i,t}return(t=this.process(r))&&t.trim()?d(`var ${t}`,{type:t.type,components:t.components,optimize:!1}):d(null,{type:t.type,components:t.components,optimize:!1})},decllist:function(e){var t=[],n=0,r=e.parent.children[4].token.data;"struct"===r&&(r=e.parent.children[4].children[0].data);for(var i=e.parent.children[1].token.data,o=[],s=5,a=e.parent.children.length-1;s<a;s++)o.push(parseInt(e.parent.children[s].children[0].children[0].data));for(s=0,a=e.children.length;s<a;s++){var u=e.children[s];if("ident"===u.type)(c=this.process(u)).type=r,n=t.push(c),this.variable(c,{type:r,binding:i,node:u,dimensions:[]});else if("quantifier"===u.type){(o=this.variable(t[n-1]).dimensions).push(parseInt(u.children[0].children[0].data)),this.variable(t[n-1],{dimensions:o})}else{if("expr"!==u.type)throw Error("Undefined type in decllist: "+u.type);var c=t[n-1],l=this.process(u);this.variable(c,{value:l})}}var f="functionargs"===e.parent.parent.type,h=this[i],p=t.map(function(e,t){if(f)return e;var n=this.variable(e).value;if(void 0!==h&&!h)return"";if(h instanceof Function){var r=h(e,this.variable(e));null!=r&&(n=r)}return n+""||0===n?`${e} = ${n}`:e},this).filter(Boolean);return d(p.join(", "),{type:r})},placeholder:function(e){return e.token.data},suffix:function(e){var t=this.process(e.children[0]);return d(t+e.data,{type:t.type})},forloop:function(e){var t=this.process(e.children[0]),n=this.process(e.children[1]),r=this.process(e.children[2]),i=this.process(e.children[3]);return d(`for (${t}; ${n}; ${r}) {\n${i}\n}`,{})},whileloop:function(e){var t=this.process(e.children[0]),n=this.process(e.children[1]);return d(`while (${t}) {\n${n}\n}`,{})},operator:function(e){if("."===e.data){var t=e.children[0],n=this.process(t),r=n.type,i=e.children[1].data;return g.test(i)?this.unswizzle(e):d(`${n}.${i}`,{type:r})}throw Error("Unknown operator "+e.data)},expr:function(e){var t=0,n=e.children.map(function(e){var n=this.process(e);return t+=n.complexity,n},this).join("");return n=d(n,{complexity:t})},precision:function(){return d(null)},comment:function(e){return d(null)},preprocessor:function(e){return d("/* "+e.token.data+" */")},keyword:function(e){var t;return t="true"===e.data||"false"===e.data?"bool":e.data,d(e.data,{type:t,complexity:0,optimize:!1})},ident:function(e){for(var t=e.token.data,n=this.scopes[this.currentScope];null==n[t]&&(n=n.__parentScope););var r=e.data;if(n){var i=n[t].type;return d(r,{type:i,complexity:0})}return d(r,{type:null,complexity:0})},return:function(e){var t,n=this.process(e.children[0]),r=this.scopes[this.currentScope];if(r.outArgs){var i=`${r.callName}.__out__ = [${r.outArgs.join(", ")}]`;t=n.visible?`${r.callName}.__return__ = ${n};\n${i};\nreturn ${r.callName}.__return__`:`${i};\nreturn`}else t="return"+(n.visible?" "+n:"");return d(t,{type:n.type})},continue:function(){return d("continue")},break:function(){return d("break")},discard:function(){return d("discard()")},"do-while":function(e){var t=this.process(e.children[0]),n=this.process(e.children[1]);return d(`do {\n${t}\n} while (${n})`,{})},binary:function(e){var t=e.children[0],n=e.children[1],r=this.process(t),i=this.process(n),o=r.type,s=(i.type,e.data);if("["===e.data){if(this.types[e.type])return d(`${o}[${i}]`,{type:this.types[o].type,complexity:r.complexity+i.complexity+1});if("binary"===t.type){var a=t.children[0],u=this.process(a),c=this.types[o].length,l=u.type,f=(this.types[l].length,this.process(t.children[1])),h=0|parseFloat(f),p=0|parseFloat(i);return isNaN(h)||isNaN(p)?d(`${u}[${f} * ${c} + ${i}]`,{type:"float",complexity:u.complexity+f.complexity+i.complexity+2}):d(u.components[c*h+p],{type:"float",complexity:u.complexity+i.complexity+1})}if(/mat/.test(o)){var g=this.types[o].length,m=this.processOperation(i,d(g),"*"),E=this.processOperation(m,d(g),"+"),v=_.test(m)&&_.test(E)?r.components.slice(m,E):void 0,y=d(`${r}.slice(${m}, ${E})`,{type:this.types[o].type,complexity:r.complexity+g,components:v});return y=this.optimizeDescriptor(y)}var b=this.variable(r),A=b&&b.dimensions&&b.dimensions.length?o:this.types[o].type;return d(`${r}[${i}]`,{type:A||null,complexity:r.complexity+i.complexity+1})}return this.processOperation(r,i,s)},assign:function(e){var t=e.data,n=this.process(e.children[1]);if("identifier"===e.children[0].type)var r=d(e.children[0].data,{type:n.type,optimize:!1,complexity:0});else r=this.process(e.children[0]);var i=r,o="operator"===e.children[0].type&&g.test(e.children[0].children[1].data);if(!o&&1==this.types[n.type].length&&1==this.types[i.type].length)return d(`${i} ${t} ${n}`,{type:n.type,complexity:i.complexity+1+n.complexity});if(o){for(var s=this.swizzlePositions(e.children[0].children[1].data),a=this.types[this.process(e.children[0].children[0]).type].length,u=Array(a).fill("null"),c=0;c<s.length;c++)u[s[c]]=c;var l=e.children[0].children[0].type;if("ident"!==l&&"builtin"!==l||(i=d(e.children[0].children[0].data,{type:n.type,optimize:!1})),s.length>1){if(t.length>1){var f=t.slice(0,-1);n=this.processOperation(this.unswizzle(e.children[0]),n,f),n=this.optimizeDescriptor(n)}var h=Array(a);for(c=0;c<a;c++)h[c]=d(`${i}[${c}]`,{type:"float",complexity:1});for(c=0;c<s.length;c++)h[s[c]]=n.components[c];return n=d(`[${u.join(", ")}].map(function (idx, i) { return idx == null ? ${i}[i] : this[idx]; }, ${n})`,{type:n.type,complexity:4*a+n.complexity,include:n.include,components:h}),n=this.optimizeDescriptor(n),d(`${i} = ${n}`,{type:n.type,optimize:!1,include:n.include})}return d("builtin"===l||"ident"===l?`${i}[${s[0]}] ${t} ${n}`:`${i} ${t} ${n}`,{type:n.type,optimize:!1})}if(t.length>1){f=t.slice(0,-1);n=this.processOperation(r,n,f),n=this.optimizeDescriptor(n)}return d(`${i} = ${n}`,{type:n.type,complexity:1,include:n.include})},ternary:function(e){var t=this.process(e.children[0]),n=this.process(e.children[1]),r=this.process(e.children[2]);return d(`${t} ? ${n} : ${r}`,{type:n.type})},unary:function(e){var t=this.process(e.children[0]),n=t.complexity+1;return"+"===e.data?"unary"===e.children[0].type?d(e.data+t,{type:t.type,complexity:n}):"unary"===e.children[0].parent.type?d(e.data+t,{type:t.type,complexity:n}):d(t):this.processOperation(null,t,e.data)},builtin:function(e){return d(e.data,{type:this.builtins[e.data],complexity:0})},call:function(e){var t=(f=e.children.slice(1)).map(this.process,this),n=t.map(function(e){return e.type},this);if("."===e.children[0].data){var r=e.children[0].children[1],i=e.children[0].children[0],o=this.process(r),s=this.process(i),a=s.type;if("length"==o&&this.types[a].length>1)return d(this.types[a].length,{type:"int",complexity:0});var u=d(`${s}.${o}`,{type:o.type,complexity:s.complexity+o.complexity})}else u=this.process(e.children[0]);if("["===e.children[0].data){for(var c=[],l=e.children[0];"keyword"!=l.type;)c.push(parseInt(l.children[1].data)),l=l.children[0];return this.types[u]?f.map(this.process,this).join(", "):(u+"(",f.map(this.process,this).join(", "),")"),d(this.wrapDimensions(t,c.reverse()),{type:u.type,complexity:999})}if(this.debug){if("print"==u){var f=t.map(function(e){return e+":"+e.type});return console.log.apply(console,f),d(null)}if("show"==u)return console.log.apply(console,t.map(function(e){return e})),d(null)}if(this.types[u])return this.types[u].apply(this,f);var h=!0,p=null,_=this.functions[u];if(_){var g=n.join("_");g&&this.functions[`${u}_${g}`]?(a=(_=this.functions[`${u}_${g}`]).type,p=_.outArgs,u=d(`${u}_${g}`,{complexity:u.complexity})):(a=_.type,p=_.outArgs)}else this.stdlib[u]&&(this.addInclude(u),this.stdlib[u].name&&(u=this.stdlib[u].name),this.addInclude(this.stdlib[u].include),"function"==typeof(a=this.stdlib[u].type)&&(a=a.call(this,e)));a||(a=null,h=!1);var m=`${u}(${t.join(", ")})`;return p&&(m=`(${m}, [${p.map(function(e){return t[e.index]}).join(", ")}] = ${u}.__out__, ${u}.__return__)`),d(m,{type:a||u.type,complexity:999,optimize:h})},literal:function(e){/^0[0-9]+/.test(e.data)&&(e.data="0o"+e.data.slice(1));var t,n=/^[0-9][xob]/.test(e.data)?Number(e.data):e.data;return/true|false/i.test(e.data)?t="bool":/^[0-9]+$/.test(e.data)>0?t="int":_.test(e.data)&&(t="float"),d(n,{type:t,complexity:0})},if:function(e){var t=`if (${this.process(e.children[0])}) {\n${this.process(e.children[1])}\n}`;if(e.children.length>1){var n=this.process(e.children[2]);n.visible&&(t+=` else {\n${n}\n}`)}return d(t,{type:"float"})},group:function(e){var t=e.children.map(this.process,this),n="("+t.join(", ")+")",r=t[t.length-1];return r.components&&(r.components=r.components.map(function(e){return 1===e.complexity?e:d("("+e+")",e)})),d(n,{type:r.type,components:r.components,complexity:t.reduce(function(e,t){return e+t.complexity||0},0)})}},m.prototype.swizzlePositions=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],o="xyzwstpdrgba".indexOf(i)%4;t.push(o)}return t},m.prototype.unswizzle=function(e){var t=e.children[0],n=this.process(t),r=n.type,i=e.children[1].data,o=this.swizzlePositions(i),s=o.map(function(e){return n.components&&n.components[e]||e});if(1===s.length)return"number"==typeof s[0]?a=d(`${n}[${s[0]}]`,{type:null,complexity:999}):(null==s[0]&&console.warn(`Cannot unswizzle '${n.type}(${n}).${i}': ${i} is outside the type range.`),a=d(s[0]||"undefined",{type:"float",complexity:1})),a;if(r&&s.length===this.types[r].length&&o.every(function(e,t){return e===t}))return n;s.length,n.complexity;var a=d(`[${o.join(", ")}].map(function (x, i) { return this[x]}, ${n})`,{complexity:n.components?2*s.length:999,type:`vec${s.length}`,components:n.components&&s});return a=this.optimizeDescriptor(a)},m.prototype.variable=function(e,t,n){if(n||(n=this.currentScope),t){this.scopes[n][e]||(this.scopes[n][e]={});var r=a(this.scopes[n][e],t);return null==t.value&&(this.types[r.type]?/sampler|image/.test(r.type)?r.value=this.types[r.type].call(this,e):r.value=this.types[r.type].call(this):r.value=r.type+"()",r.value=this.optimizeDescriptor(r.value),r.value=this.wrapDimensions(r.value,r.dimensions)),null==r.id&&(r.id=e),null==r.scope&&(r.scope=this.scopes[n]),"uniform"===r.binding&&(this.uniforms[e]=r),"attribute"===r.binding&&(this.attributes[e]=r),"varying"===r.binding&&(this.varyings[e]=r),r}return this.scopes[n][e]},m.prototype.wrapDimensions=function(e,t){return t.length&&(Array.isArray(e)||(e=[e]),e=t.reduceRight(function(e,t){for(var n,r,i=[],o=0;o<t;o++)n=r=null==e[o]?n:e[o],i.push(r);return`[${i.join(", ")}]`},e)),e},m.prototype.processOperation=l,m.prototype.addInclude=function(e,t){if(e&&this.includes){if(Array.isArray(e))return e.forEach(function(e){this.addInclude(e)},this);if(e instanceof String||"object"!=typeof e)t?(null!=this.includes[e]&&!0!==this.includes[e]||(this.includes[e]={}),this.includes[e][t]=!0):null==this.includes[e]&&(this.includes[e]=!0);else for(var n in e)this.addInclude(n,e[n])}},m.prototype.stringifyStdlib=function(e){e||(e=this.includes);var t=[];for(var n in e)if(e[n]){var r=this.stdlib[n].toString();if(t.push(r),e[n])for(var i in e[n])this.stdlib[n][i]?t.push(`${n}.${i} = ${this.stdlib[n][i].toString()}`):console.warn(`Cannot find '${n}.${i}' in stdlib`)}return t.join("\n")},e.exports=m},function(e,t,n){"use strict";var r=n(119),i=n(50);e.exports=function(e){return"object"==typeof e&&e.children?e:("string"==typeof e&&(e=i(e,{version:this.version||"100 es"})),Array.isArray(e)&&(e=r(e)),e)}},function(e,t,n){var r=n(123);e.exports=function(e,t){var n=r(t),i=[];return i=(i=i.concat(n(e))).concat(n(null))}},function(e,t){e.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},function(e,t){e.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},function(e,t,n){"use strict";var r=n(37);t.null=function(e){};var i=/^-?[0-9]*(?:.[0-9]+)?(?:e-?[0-9]+)?$/i;function o(e){if(null==e)return r(!1,{type:"bool",complexity:0});var t;if("true"==(t=e instanceof String?e.components[0]:"object"==typeof e?this.process(e).components[0]:e)||!0===t)return r(!0,{type:"bool",complexity:0});if("false"==t||!1===t)return r(!1,{type:"bool",complexity:0});var n=i.exec(t);return null==n?r("!!"+t,{type:"bool",complexity:t.complexity+1}):r(!!parseFloat(n),{type:"bool",complexity:0})}function s(e){if(null==e)return r(0,{type:"int",complexity:0});if("object"!=typeof e)return r(0|+e,{type:"int",complexity:0});var t;if("true"==(t=e instanceof String?e.components[0]:"object"==typeof e?this.process(e).components[0]:e)||!0===t)return r(1,{type:"int",complexity:0});if("false"==t||!1===t)return r(0,{type:"int",complexity:0});var n=i.exec(t);return null!=n?r(0|+parseFloat(n),{type:"int",complexity:0}):r(t+"|0",{type:"int",complexity:t.complexity})}function a(e){if(null==e)return r(0,{type:"float",complexity:0});var t;if("true"==(t=e instanceof String?e.components?e.components[0]:e:"object"==typeof e?this.process(e).components[0]:e)||!0===t)return r(1,{type:"float",complexity:0});if("false"==t||!1===t)return r(0,{type:"float",complexity:0});var n=i.exec(t);return null!=n?r(+parseFloat(n),{type:"float",complexity:0}):"int"===t.type||"float"===t.type?r(t,{type:"float",complexity:t.complexity}):r("+"+t,{type:"float",complexity:t.complexity+1})}function u(e,t){function n(n,i){null==n&&(n=0),null==i&&(i=n);n=this.process(n),i=this.process(i);var o,s="";return n.components&&i.components&&(_(n.components[0].type,e)&&_(i.components[0].type,e)||(s=`.map(${e})`,o=e)),2===this.types[n.type].length?n:this.types[n.type].length>2?r(`${n}.slice(0, 2)${s}`,{components:n.components&&n.components.slice(0,2).map(this.types[e],this),type:t,complexity:n.complexity+2,include:o}):n===i?r(`[0, 0].fill(${n})${s}`,{complexity:n.complexity+2,components:[n,i].map(this.types[e],this),type:t,include:o}):r(`[${[n,i].join(", ")}]${s}`,{components:[n,i].map(this.types[e],this),type:t,complexity:n.complexity+i.complexity,include:o})}return n.type=e,n}function c(e,t){function n(n,i,o){null==n&&(n=0),null==i&&(i=n),null==o&&(o=i),n=this.process(n),i=this.process(i),o=this.process(o);var s,a="";return!n.components||_(n.components[0].type,e)&&_(i.components[0].type,e)&&_(o.components[0].type,e)||(a=`.map(${e})`,s=e),3===this.types[n.type].length?n:this.types[n.type].length>3?r(`${n}.slice(0, 3)${a}`,{components:n.components.slice(0,3).map(this.types[e],this),type:t,complexity:n.complexity+3+3,include:s}):2===this.types[n.type].length?r(`${n}.concat(${this.types.float.call(this,i)})${a}`,{components:n.components.concat(i.components[0]).map(this.types[e],this),type:t,complexity:n.complexity+i.complexity+3,include:s}):this.types[i.type].length>1?r(`[${n}].concat(${this.types.vec2.call(this,i,o)})${a}`,{components:[n].concat(i.components.slice(0,2)).map(this.types[e],this),type:t,complexity:n.complexity+i.complexity+o.complexity+3,include:s}):r(`[${[n,i,o].join(", ")}]${a}`,{components:[n,i,o].map(this.types[e],this),type:t,complexity:n.complexity+i.complexity+o.complexity+3,include:s})}return n.type=e,n}function l(e,t){function n(n,i,o,s){null==n&&(n=0),null==i&&(i=n),null==o&&(o=i),null==s&&(s=o);n=this.process(n),i=this.process(i),o=this.process(o),s=this.process(s);var a,u="";return _(n.components[0].type,e)&&_(i.components[0].type,e)&&_(o.components[0].type,e)&&_(s.components[0].type,e)||(u=`.map(${e})`,a=e),/mat/.test(n.type)?r(n,{components:n.components.map(this.types[e],this),type:t,include:a}):this.types[n.type].length>4?r(`${n}.slice(0, 4)${u}`,{components:n.components.slice(0,4).map(this.types[e],this),type:t,include:a}):4===this.types[n.type].length?n:3===this.types[n.type].length?r(`${n}.concat(${this.types.float.call(this,i)})${u}`,{components:n.components.concat(i.components[0]).map(this.types[e],this),type:t,include:a}):2===this.types[n.type].length?this.types[i.type].length>1?r(`${n}.concat(${this.types.vec2.call(this,i)})${u}`,{components:n.components.concat(i.components.slice(0,2)).map(this.types[e],this),type:t,include:a}):r(`${n}.concat(${this.types.vec2.call(this,i,o)})${u}`,{components:n.components.concat(i.components[0],o.components[0]).map(this.types[e],this),type:t,include:a}):2===this.types[i.type].length?r(`[${n}].concat(${this.types.vec2.call(this,i)}, ${this.types.float.call(this,o)})${u}`,{components:n.components.concat(i.components,o.components[0]).map(this.types[e],this),type:t,include:a}):this.types[i.type].length>2?r(`[${n}].concat(${this.types.vec3.call(this,i,o,s)})${u}`,{components:n.components.concat(i.components.slice(0,3)).map(this.types[e],this),type:t,include:a}):this.types[o.type].length>1?r(`[${n}].concat(${i}, ${this.types.vec2.call(this,o)})${u}`,{components:n.components.concat(i.components[0],o.components.slice(0,2)).map(this.types[e],this),type:t,include:a}):r(`[${[n,i,o,s].join(", ")}]${u}`,{components:[n,i,o,s].map(this.types[e],this),type:t,include:a})}return n.type=e,n}function f(e,t){if(arguments.length>=4){var n=this.process(arguments[0]),i=this.process(arguments[1]),o=this.process(arguments[2]),s=this.process(arguments[3]);return r(`[${(u=[n,i,o,s]).join(", ")}]`,{components:u,type:"mat2",complexity:p(u)})}null==e&&(e=1);e=this.process(e),t=this.process(t);if(1===this.types[e.type].length)return r(`mat2(${e})`,{components:[e,0,0,e].map(a,this),type:"mat2",complexity:2*e.complexity+2,include:"mat2"});if("mat2"===e.type)return e;var u=e.components.slice(0,2).concat(t.components.slice(0,2));return r(`${this.types.vec2.call(this,e)}.concat(${this.types.vec2.call(this,t)})`,{components:u.map(a,this),complexity:p(u),type:"mat2"})}function h(e,t,n){if(arguments.length>=9){var i=this.process(arguments[0]),o=this.process(arguments[1]),s=this.process(arguments[2]),u=this.process(arguments[3]),c=this.process(arguments[4]),l=this.process(arguments[5]),f=this.process(arguments[6]),h=this.process(arguments[7]),d=this.process(arguments[8]);return r(`[${(g=[i,o,s,u,c,l,f,h,d]).join(", ")}]`,{components:g,type:"mat3",complexity:p(g)})}null==e&&(e=1);e=this.process(e),t=this.process(t),n=this.process(n);if(1===this.types[e.type].length)return r(`mat3(${e})`,{components:[e,0,0,0,e,0,0,0,e].map(a,this),type:"mat3",include:"mat3",complexity:3*e.complexity+6});if("mat2"===e.type)return r(`[0,1,null, 2,3,null, null,null,-1].map(function (i) {return i == null ? 0 : i < 0 ? -i : this[i]}, ${e})`,{components:[e.components[0],e.components[1],0,e.components[2],e.components[3],0,0,0,1].map(a,this),type:"mat3",complexity:27+e.complexity});if("mat3"===e.type)return e;if("mat4"===e.type){var _=e.components;return r(`${e}.filter(function (x, i) { return i % 4 !== 3 && i < 12; })`,{components:_.slice(0,3).concat(_.slice(4,7),_.slice(8,11)).map(a,this),type:"mat3",complexity:48+e.complexity})}var g=e.components.slice(0,3).concat(t.components.slice(0,3),n.components.slice(0,3));return r(`${this.types.vec3.call(this,e)}.concat(${this.types.vec3.call(this,t)}, ${this.types.vec3.call(this,n)})`,{components:g.map(a,this),type:"mat3",complexity:p(g)})}function d(e,t,n,i){if(arguments.length>=16){var o=this.process(arguments[0]),s=this.process(arguments[1]),u=this.process(arguments[2]),c=this.process(arguments[3]),l=this.process(arguments[4]),f=this.process(arguments[5]),h=this.process(arguments[6]),d=this.process(arguments[7]),_=this.process(arguments[8]),g=this.process(arguments[9]),m=this.process(arguments[10]),E=this.process(arguments[11]),v=this.process(arguments[12]),y=this.process(arguments[13]),b=this.process(arguments[14]),A=this.process(arguments[15]);return r(`[${(R=[o,s,u,c,l,f,h,d,_,g,m,E,v,y,b,A]).join(", ")}]`,{components:R,type:"mat4",complexity:p(R)})}null==e&&(e=1);e=this.process(e),t=this.process(t),n=this.process(n),i=this.process(i);if(1===this.types[e.type].length)return r(`mat4(${e})`,{components:[e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,e].map(a,this),type:"mat4",include:"mat4",complexity:4*e.complexity+12});if("mat2"===e.type)return r(`[0,1,null,null, 2,3,null,null, null,null,-1,null, null,null,null,-1].map(function (i) {return i == null ? 0 : i < 0 ? -i : this[i]}, ${e})`,{components:[e.components[0],e.components[1],0,0,e.components[2],e.components[3],0,0,0,0,1,0,0,0,0,1].map(a,this),type:"mat4",complexity:48+e.complexity});if("mat3"===e.type){var T=e.components;return r(`[0,1,2,null,3,4,5,null,6,7,8,null,null,null,null,-1].map(function (i) {return i == null ? 0 : i < 0 ? -i : this[i]}, ${e})`,{components:T.slice(0,3).concat(0,T.slice(3,6),0,T.slice(6,9),0,0,0,0,1).map(a,this),type:"mat4",complexity:48+e.complexity})}var R=e.components.slice(0,4).concat(t.components.slice(0,4),n.components.slice(0,4),i.components.slice(0,4));return r(`${this.types.vec4.call(this,e)}.concat(${this.types.vec4.call(this,t)}, ${this.types.vec4.call(this,n)}, ${this.types.vec4.call(this,i)})`,{components:R.map(a,this),type:"mat4",complexity:p(R)})}function p(e){if(Array.isArray(e)){for(var t=0,n=0;n<e.length;n++)t+=e[n].complexity||0;return t}return e.complexity}function _(e,t){if((e+="")===(t+=""))return!0;var n=["double","float","int","uint"],r=n.indexOf(e),i=n.indexOf(t);return r>=0&&i>=0&&r>=i}function g(e,t){function n(){arguments[0];return r(null,{type:t,include:"texture2D",complexity:999})}return n.type=e,n}t.void=function(){return""},o.type="bool",t.bool=o,s.type="int",t.int=t.uint=t.byte=t.short=s,a.type="float",t.float=t.double=a,t.ivec2=u("int","ivec2"),t.uvec2=u("uint","uvec2"),t.bvec2=u("bool","bvec2"),t.dvec2=u("double","dvec2"),t.vec2=u("float","vec2"),t.ivec3=c("int","ivec3"),t.uvec3=c("uint","uvec3"),t.bvec3=c("bool","bvec3"),t.dvec3=c("double","dvec3"),t.vec3=c("float","vec3"),t.ivec4=l("int","ivec4"),t.uvec4=l("uint","uvec4"),t.bvec4=l("bool","bvec4"),t.dvec4=l("double","dvec4"),t.vec4=l("float","vec4"),f.type="vec2",h.type="vec3",d.type="vec4",t.mat2=f,t.mat3=h,t.mat4=d,t.mat2x2=f,t.mat3x3=h,t.mat4x4=d,t.dmat2=f,t.dmat3=h,t.dmat4=d,t.dmat2x2=f,t.dmat3x3=h,t.dmat4x4=d,t.sampler1D=g("vec4","sampler1D"),t.image1D=g("vec4","image1D"),t.sampler2D=g("vec4","sampler2D"),t.image2D=g("vec4","image2D"),t.sampler3D=g("vec4","sampler3D"),t.image3D=g("vec4","image3D"),t.samplerCube=g("vec4","samplerCube"),t.imageCube=g("vec4","imageCube"),t.sampler2DRect=g("vec4","sampler2DRect"),t.image2DRect=g("vec4","image2DRect"),t.sampler1DArray=g("vec4","sampler1DArray"),t.image1DArray=g("vec4","image1DArray"),t.sampler2DArray=g("vec4","sampler2DArray"),t.image2DArray=g("vec4","image2DArray"),t.sampler1DShadow=g("float","sampler1DShadow"),t.sampler2DShadow=g("float","sampler2DShadow"),t.sampler2DRectShadow=g("float","sampler2DRectShadow"),t.sampler1DArrayShadow=g("float","sampler1DArrayShadow"),t.sampler2DArrayShadow=g("float","sampler2DArrayShadow"),t.samplerCubeShadow=g("float","samplerCubeShadow"),t.samplerCubeArrayShadow=g("float","samplerCubeArrayShadow"),t.isampler1D=g("ivec4","isampler1D"),t.iimage1D=g("ivec4","iimage1D"),t.isampler2D=g("ivec4","isampler2D"),t.iimage2D=g("ivec4","iimage2D"),t.isampler3D=g("ivec4","isampler3D"),t.iimage3D=g("ivec4","iimage3D"),t.isamplerCube=g("ivec4","isamplerCube"),t.iimageCube=g("ivec4","iimageCube")},function(module,exports,__webpack_require__){"use strict";var Descriptor=__webpack_require__(37),floatRE=RegExp("^"+__webpack_require__(129).source+"$"),operators=processOperation.operators={"*":"multiply","+":"add","-":"subtract","/":"divide","%":"mod","<<":"lshift",">>":"rshift","==":"equal","<":"less",">":"greater","&&":"and","&=":"and_eq","&":"bitand","|":"bitor","!=":"not_eq","||":"or","|=":"or_eq","^":"xor","^=":"xor_eq"},opComplexity={"*":2,"+":1,"-":1,"/":2};function processOperation(left,right,operator){var self=this,leftType=left&&left.type,rightType=right.type,operatorName=operators[operator];if(!left){if(1===this.types[rightType].length){var a=null,b=right,res=Descriptor(calculate(a,b,operator),{components:[calculate(a,b,operator)],type:leftType,complexity:b.complexity+(opComplexity[operator]||1)});return res}var outType=rightType,vec=right,l=this.types[outType].length;/mat/.test(outType)&&(l*=this.types[this.types[outType].type].length);for(var operands=[],i=0;i<l;i++){if(1==this.types[rightType].length)var rightOp=right,leftOp=left.components[i];else var rightOp=right.components[i],leftOp=left;operands.push(calculate(leftOp,rightOp,operator))}var calcStr=calculate(null,"_",operator);return Descriptor(`${vec}.map(function (_) {return ${calcStr};})`,{components:operands,type:outType,complexity:vec.complexity+2*l+1})}if(1==this.types[leftType].length&&1==this.types[rightType].length){var a=left,b=right,res=Descriptor(calculate(a,b,operator),{components:[calculate(a,b,operator)],type:leftType,complexity:a.complexity+b.complexity+(opComplexity[operator]||1)});return res}if(1==this.types[leftType].length||1==this.types[rightType].length){var outType=1==this.types[leftType].length?rightType:leftType,vec=1==this.types[leftType].length?right:left,scalar=1==this.types[leftType].length?left:right,l=this.types[outType].length;/mat/.test(outType)&&(l*=this.types[this.types[outType].type].length);for(var operands=[],i=0;i<l;i++){if(1==this.types[rightType].length)var rightOp=right,leftOp=left.components[i];else var rightOp=right.components[i],leftOp=left;operands.push(calculate(leftOp,rightOp,operator))}if(scalar.optimize){var calcStr=1==this.types[rightType].length?calculate("_",scalar,operator):calculate(scalar,"_",operator);return Descriptor(`${vec}.map(function (_) {return ${calcStr};})`,{components:operands,type:outType,complexity:vec.complexity+l*(scalar.complexity+2)+1})}var calcStr=1==this.types[rightType].length?calculate("_","this",operator):calculate("this","_",operator);return Descriptor(`${vec}.map(function (_) {return ${calcStr};}, ${scalar})`,{components:operands,type:outType,complexity:vec.complexity+l*(scalar.complexity+2)+1})}if(/vec/.test(leftType)&&/vec/.test(rightType)){for(var outType=1==this.types[leftType].length?rightType:leftType,l=this.types[outType].length,operands=[],i=0;i<l;i++){var leftOp=left.components[i],rightOp=right.components[i];operands.push(calculate(leftOp,rightOp,operator))}var include={};include[leftType]=operatorName;var res=Descriptor(`${leftType}.${operatorName}([], ${left}, ${right})`,{components:operands,type:outType,complexity:left.complexity+right.complexity+3*l+1,include:include});return res}if(/mat/.test(leftType)&&/mat/.test(rightType)&&"*"!==operator){for(var outType=1==this.types[leftType].length?rightType:leftType,l=this.types[outType].length*this.types[this.types[outType].type].length,operands=[],i=0;i<l;i++){var leftOp=left.components[i],rightOp=right.components[i];operands.push(calculate(leftOp,rightOp,operator))}var res=Descriptor(`${left}.map(function (x, i, m){ return x ${operator} this[i];}, ${right})`,{components:operands,complexity:left.complexity+right.complexity+3*l,type:outType});return res}if((/mat/.test(leftType)||/mat/.test(rightType))&&"*"===operator){if(/vec/.test(leftType)){for(var outType=leftType,l=this.types[outType].length,operands=[],leftOp=left,dotComponents=[],i=0;i<l;i++){var start=l*i,end=l*i+l,rightOp=Descriptor(`${right}.slice(${start}, ${end})`,{type:this.types[leftType].type,complexity:right.complexity+l,components:right.components.slice(start,end)});rightOp=this.optimizeDescriptor(rightOp),operands.push(`dot(${leftOp}, ${rightOp})`),dotComponents.push(calculate(`this[${calculate("o",i,"+")}]`,`v[${i}]`,"*"))}this.addInclude("dot");var res=Descriptor(`${leftOp}.map(function (x, i, v) { var o = i * ${l}; return ${dotComponents.join(" + ")};}, ${right})`,{components:operands,complexity:left.complexity+right.complexity+l*(l+3),type:outType});return res}if(/vec/.test(rightType)){for(var outType=rightType,vec=right,mat=left,l=this.types[outType].length,comps=[],i=0;i<l;i++){for(var sum=[],j=0;j<l;j++){var mc=mat.components[j*l+i],vc=vec.components[j];sum.push(calculate(mc,vc,"*"))}comps.push(sum.join(" + "))}var res=Descriptor(`${vec}.map(function (x, i, v) { var sum = 0; for (var j = 0; j < ${l}; j++) {sum += ${calculate("this[j*"+l+"+i]","v[j]","*")}} return sum; }, ${mat})`,{components:comps,type:outType,complexity:vec.complexity+mat.complexity+l*l*3});return res}for(var outType=leftType,l=left,r=right,len=this.types[this.types[outType].type].length,comps=[],i=0;i<len;i++)for(var j=0;j<len;j++){for(var sum=[],o=0;o<len;o++){var mc=left.components[len*o+i],nc=right.components[j*len+o];sum.push(calculate(mc,nc,"*"))}for(var sumComp=sum.shift();sum.length;)sumComp=calculate(sumComp,sum.shift(),"+");comps[j*len+i]=sumComp}var res=Descriptor(`matrixMult(${l}, ${r})`,{components:comps,type:outType,include:"matrixMult"});return res}throw Error(`Impossible to render ${leftType} ${operator} ${rightType}.`);function calculate(left,right,operator){var opResult=void 0;return floatRE.test(left)&&floatRE.test(right)&&(opResult=eval(`${left} ${operator} ${right}`)),floatRE.test(left)&&(left=Descriptor(left),left.value=parseFloat(left)),floatRE.test(right)&&(right=Descriptor(right),right.value=parseFloat(right)),"+"==operator||"-"==operator?(left&&0!==left.value||(opResult="-"==operator?"-"+right:right),0==right&&(opResult=left)):"*"==operator?0==left||0===left.value||0==right?opResult=0:1===left.value?opResult=right:1===right.value&&(opResult=left):"--"!=operator&&"++"!=operator||(left?opResult=left+operator:right&&(opResult=operator+right)),null==opResult&&(opResult="","+"!=operator&&"-"!=operator?!/\s/.test(left)||"("==left[0]&&")"==left[left.length-1]?opResult+=left:opResult+="("+left+")":opResult+=left,opResult+=" "+operator+" ","+"!=operator&&"-"!=operator?!/\s/.test(right)||"("==right[0]&&")"==right[right.length-1]?opResult+=right:opResult+="("+right+")":opResult+=right),opResult=Descriptor(opResult,{complexity:1+(left&&left.complexity||0)+(right.complexity||0),optimize:!1!==(left&&left.optimize)&&!1!==right.optimize}),opResult}}module.exports=processOperation},function(e,t,n){"use strict";(function(t,r){var i=n(29);e.exports=v;var o,s=n(56);v.ReadableState=E;n(28).EventEmitter;var a=function(e,t){return e.listeners(t).length},u=n(57),c=n(30).Buffer,l=t.Uint8Array||function(){};var f=n(25);f.inherits=n(16);var h=n(140),d=void 0;d=h&&h.debuglog?h.debuglog("stream"):function(){};var p,_=n(141),g=n(59);f.inherits(v,u);var m=["error","close","destroy","pause","resume"];function E(e,t){o=o||n(18),e=e||{};var r=t instanceof o;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,s=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new _,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=n(60).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function v(e){if(o=o||n(18),!(this instanceof v))return new v(e);this._readableState=new E(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),u.call(this)}function y(e,t,n,r,i){var o,s=e._readableState;null===t?(s.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,R(e)}(e,s)):(i||(o=function(e,t){var n;(function(e){return c.isBuffer(e)||e instanceof l})(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(s,t)),o?e.emit("error",o):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),r?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):b(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(t=s.decoder.write(t),s.objectMode||0!==t.length?b(e,s,t,!1):S(e,s)):b(e,s,t,!1))):r||(s.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function b(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&R(e)),S(e,t)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(e,t){this.push(null),t(e)},v.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=c.from(e,t),t=""),n=!0),y(this,e,t,!1,n)},v.prototype.unshift=function(e){return y(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(e){return p||(p=n(60).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var A=8388608;function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(d("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(x,e):x(e))}function x(e){d("emit readable"),e.emit("readable"),w(e)}function S(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(I,e,t))}function I(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(d("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function C(e){d("readable nexttick read 0"),e.read(0)}function N(e,t){t.reading||(d("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),w(e),t.flowing&&!t.reading&&e.read(0)}function w(e){var t=e._readableState;for(d("flow",t.flowing);t.flowing&&null!==e.read(););}function F(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),0===(e-=s)){s===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=c.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,s),0===(e-=s)){s===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function M(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(O,t,e))}function O(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function L(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}v.prototype.read=function(e){d("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return d("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?M(this):R(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&M(this),null;var r,i=t.needReadable;return d("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&d("length less than watermark",i=!0),t.ended||t.reading?d("reading or ended",i=!1):i&&(d("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(n,t))),null===(r=e>0?F(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&M(this)),null!==r&&this.emit("data",r),r},v.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,d("pipe count=%d opts=%j",o.pipesCount,t);var u=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:v;function c(t,r){d("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,d("cleanup"),e.removeListener("close",m),e.removeListener("finish",E),e.removeListener("drain",f),e.removeListener("error",g),e.removeListener("unpipe",c),n.removeListener("end",l),n.removeListener("end",v),n.removeListener("data",_),h=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||f())}function l(){d("onend"),e.end()}o.endEmitted?i.nextTick(u):n.once("end",u),e.on("unpipe",c);var f=function(e){return function(){var t=e._readableState;d("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,w(e))}}(n);e.on("drain",f);var h=!1;var p=!1;function _(t){d("ondata"),p=!1,!1!==e.write(t)||p||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==L(o.pipes,e))&&!h&&(d("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function g(t){d("onerror",t),v(),e.removeListener("error",g),0===a(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",E),v()}function E(){d("onfinish"),e.removeListener("close",m),v()}function v(){d("unpipe"),n.unpipe(e)}return n.on("data",_),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?s(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",g),e.once("close",m),e.once("finish",E),e.emit("pipe",n),o.flowing||(d("pipe resume"),n.resume()),e},v.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var s=L(t.pipes,e);return-1===s?this:(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},v.prototype.on=function(e,t){var n=u.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&R(this):i.nextTick(C,this))}return n},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var e=this._readableState;return e.flowing||(d("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(N,e,t))}(this,e)),this},v.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",function(){if(d("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){(d("wrapped data"),n.decoder&&(i=n.decoder.write(i)),!n.objectMode||null!==i&&void 0!==i)&&((n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause())))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<m.length;o++)e.on(m[o],this.emit.bind(this,m[o]));return this._read=function(t){d("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=F}).call(this,n(9),n(15))},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){e.exports=n(28).EventEmitter},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(138),i=n(139),o=n(56);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=a(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|d(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=a(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|d(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(e).length;default:if(r)return G(e).length;t=(""+t).toLowerCase(),r=!0}}function _(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,i){var o,s=1,a=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var f=!0,h=0;h<u;h++)if(c(e,o+h)!==c(t,h)){f=!1;break}if(f)return o}return-1}function E(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function v(e,t,n,r){return V(G(t,e.length-n),e,n,r)}function y(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function b(e,t,n,r){return y(e,t,n,r)}function A(e,t,n,r){return V(j(t),e,n,r)}function T(e,t,n,r){return V(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function R(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,u,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=n)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=S));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return f(null,e)},u.allocUnsafeSlow=function(e){return f(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return R(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var o=i-r,s=n-t,a=Math.min(o,s),c=this.slice(r,i),l=e.slice(t,n),f=0;f<a;++f)if(c[f]!==l[f]){o=c[f],s=l[f];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":return y(this,e,t,n);case"latin1":case"binary":return b(this,e,t,n);case"base64":return A(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function N(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=k(e[o]);return i}function w(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function F(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function O(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function L(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function P(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,o){return o||P(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function D(e,t,n,r,o){return o||P(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if(e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||F(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||F(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||F(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||F(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||F(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||F(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||F(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||F(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||F(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||M(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||M(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);M(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);M(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=u.isBuffer(e)?e:G(new u(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function k(e){return e<16?"0"+e.toString(16):e.toString(16)}function G(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function j(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(9))},function(e,t,n){"use strict";var r=n(29);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(r.nextTick(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";var r=n(30).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=f,t=3;break;default:return this.write=h,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function f(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=s(t[r]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=s(t[r]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";e.exports=o;var r=n(18),i=n(25);function o(e){if(!(this instanceof o))return new o(e);r.call(this,e),this._transformState={afterTransform:function(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush(function(t,n){a(e,t,n)}):a(this,null,null)}function a(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=n(16),i.inherits(o,r),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},function(e,t,n){"use strict";(function(e){t.a="undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||!(void 0===e||"object"!=typeof e.versions||!Boolean(e.versions.electron))||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}).call(this,n(15))},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),i=n.n(r);const o=e=>a(e)?void 0:0,s={[i.a.READ_BUFFER]:e=>a(e)?void 0:i.a.COLOR_ATTACHMENT0,35723:e=>a(e)?void 0:4352,[i.a.RASTERIZER_DISCARD]:o,[i.a.SAMPLES]:o,36795:(e,t)=>{const n=a(e)?e.getExtension("EXT_disjoint_timer_query_webgl2"):e.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?t(n.GPU_DISJOINT_EXT):0},37445:(e,t)=>{const n=e.getExtension("WEBGL_debug_renderer_info");return t(n&&n.UNMASKED_VENDOR_WEBGL||i.a.VENDOR)},37446:(e,t)=>{const n=e.getExtension("WEBGL_debug_renderer_info");return t(n&&n.UNMASKED_RENDERER_WEBGL||i.a.RENDERER)},34047:(e,t)=>{const n=e.luma.extensions.EXT_texture_filter_anisotropic;return n?t(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[i.a.MAX_3D_TEXTURE_SIZE]:o,[i.a.MAX_ARRAY_TEXTURE_LAYERS]:o,[i.a.MAX_CLIENT_WAIT_TIMEOUT_WEBGL]:o,[i.a.MAX_COLOR_ATTACHMENTS]:(e,t)=>{if(!a(e)){const n=e.getExtension("WEBGL_draw_buffers");return n?t(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[i.a.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS]:o,[i.a.MAX_COMBINED_UNIFORM_BLOCKS]:o,[i.a.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS]:o,[i.a.MAX_DRAW_BUFFERS]:e=>{if(!a(e)){const t=e.getExtension("WEBGL_draw_buffers");return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},[i.a.MAX_ELEMENT_INDEX]:e=>e.getExtension("OES_element_index")?2147483647:65535,[i.a.MAX_ELEMENTS_INDICES]:e=>e.getExtension("OES_element_index")?16777216:65535,[i.a.MAX_ELEMENTS_VERTICES]:e=>16777216,[i.a.MAX_FRAGMENT_INPUT_COMPONENTS]:o,[i.a.MAX_FRAGMENT_UNIFORM_BLOCKS]:o,[i.a.MAX_FRAGMENT_UNIFORM_COMPONENTS]:o,[i.a.MAX_SAMPLES]:o,[i.a.MAX_SERVER_WAIT_TIMEOUT]:o,[i.a.MAX_TEXTURE_LOD_BIAS]:o,[i.a.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS]:o,[i.a.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS]:o,[i.a.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS]:o,[i.a.MAX_UNIFORM_BLOCK_SIZE]:o,[i.a.MAX_UNIFORM_BUFFER_BINDINGS]:o,[i.a.MAX_VARYING_COMPONENTS]:o,[i.a.MAX_VERTEX_OUTPUT_COMPONENTS]:o,[i.a.MAX_VERTEX_UNIFORM_BLOCKS]:o,[i.a.MAX_VERTEX_UNIFORM_COMPONENTS]:o,[i.a.MIN_PROGRAM_TEXEL_OFFSET]:o,[i.a.MAX_PROGRAM_TEXEL_OFFSET]:o,[i.a.UNIFORM_BUFFER_OFFSET_ALIGNMENT]:o};function a(e){return e&&32874===e.TEXTURE_BINDING_3D}function u(e,t,n){const r=s[n],i="function"==typeof r?r(e,t,n):r;return void 0!==i?i:t(n)}},function(e,t){e.exports=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}},function(e,t,n){e.exports=function(e,t){var n=r(e[0],e[1],e[2]),s=r(t[0],t[1],t[2]);i(n,n),i(s,s);var a=o(n,s);return a>1?0:Math.acos(a)};var r=n(109),i=n(46),o=n(47)},function(e,t){e.exports=function(e,t,n,r){var i=n[1],o=n[2],s=t[1]-i,a=t[2]-o,u=Math.sin(r),c=Math.cos(r);return e[0]=t[0],e[1]=i+s*c-a*u,e[2]=o+s*u+a*c,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[0],o=n[2],s=t[0]-i,a=t[2]-o,u=Math.sin(r),c=Math.cos(r);return e[0]=i+a*u+s*c,e[1]=t[1],e[2]=o+a*c-s*u,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[0],o=n[1],s=t[0]-i,a=t[1]-o,u=Math.sin(r),c=Math.cos(r);return e[0]=i+s*c-a*u,e[1]=o+s*u+a*c,e[2]=t[2],e}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11],d=e[12],p=e[13],_=e[14],g=e[15];return(t*s-n*o)*(f*g-h*_)-(t*a-r*o)*(l*g-h*p)+(t*u-i*o)*(l*_-f*p)+(n*a-r*s)*(c*g-h*d)-(n*u-i*s)*(c*_-f*d)+(r*u-i*a)*(c*p-l*d)}},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n+n,a=r+r,u=i+i,c=n*s,l=r*s,f=r*a,h=i*s,d=i*a,p=i*u,_=o*s,g=o*a,m=o*u;return e[0]=1-f-p,e[1]=l+m,e[2]=h-g,e[3]=0,e[4]=l-m,e[5]=1-c-p,e[6]=d+_,e[7]=0,e[8]=h+g,e[9]=d-_,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},function(e,t){e.exports=function(e,t,n,r,i,o,s){var a=1/(n-t),u=1/(i-r),c=1/(o-s);return e[0]=2*o*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(i+r)*u,e[10]=(s+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*c,e[15]=0,e}},function(e,t,n){var r=n(110);e.exports=function(e,t,n,i){var o,s,a,u,c,l,f,h,d,p,_=t[0],g=t[1],m=t[2],E=i[0],v=i[1],y=i[2],b=n[0],A=n[1],T=n[2];if(Math.abs(_-b)<1e-6&&Math.abs(g-A)<1e-6&&Math.abs(m-T)<1e-6)return r(e);f=_-b,h=g-A,d=m-T,p=1/Math.sqrt(f*f+h*h+d*d),o=v*(d*=p)-y*(h*=p),s=y*(f*=p)-E*d,a=E*h-v*f,(p=Math.sqrt(o*o+s*s+a*a))?(o*=p=1/p,s*=p,a*=p):(o=0,s=0,a=0);u=h*a-d*s,c=d*o-f*a,l=f*s-h*o,(p=Math.sqrt(u*u+c*c+l*l))?(u*=p=1/p,c*=p,l*=p):(u=0,c=0,l=0);return e[0]=o,e[1]=u,e[2]=f,e[3]=0,e[4]=s,e[5]=c,e[6]=h,e[7]=0,e[8]=a,e[9]=l,e[10]=d,e[11]=0,e[12]=-(o*_+s*g+a*m),e[13]=-(u*_+c*g+l*m),e[14]=-(f*_+h*g+d*m),e[15]=1,e}},function(e,t){e.exports=function(e,t,n,r,i,o,s){var a=1/(t-n),u=1/(r-i),c=1/(o-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(i+r)*u,e[14]=(s+o)*c,e[15]=1,e}},function(e,t){e.exports=function(e,t,n,r,i){var o=1/Math.tan(t/2),s=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*s,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*s,e[15]=0,e}},function(e,t){e.exports=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],s=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=s,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],_=t[13],g=t[14],m=t[15],E=n*a-r*s,v=n*u-i*s,y=n*c-o*s,b=r*u-i*a,A=r*c-o*a,T=i*c-o*u,R=l*_-f*p,x=l*g-h*p,S=l*m-d*p,I=f*g-h*_,C=f*m-d*_,N=h*m-d*g,w=E*N-v*C+y*I+b*S-A*x+T*R;if(!w)return null;return w=1/w,e[0]=(a*N-u*C+c*I)*w,e[1]=(i*C-r*N-o*I)*w,e[2]=(_*T-g*A+m*b)*w,e[3]=(h*A-f*T-d*b)*w,e[4]=(u*S-s*N-c*x)*w,e[5]=(n*N-i*S+o*x)*w,e[6]=(g*y-p*T-m*v)*w,e[7]=(l*T-h*y+d*v)*w,e[8]=(s*C-a*S+c*R)*w,e[9]=(r*S-n*C-o*R)*w,e[10]=(p*A-_*y+m*E)*w,e[11]=(f*y-l*A-d*E)*w,e[12]=(a*x-s*I-u*R)*w,e[13]=(n*I-r*x+i*R)*w,e[14]=(_*v-p*b-g*E)*w,e[15]=(l*b-f*v+h*E)*w,e}},function(e,t){e.exports=function(e,t,n,r){var i,o,s,a,u,c,l,f,h,d,p,_,g,m,E,v,y,b,A,T,R,x,S,I,C=r[0],N=r[1],w=r[2],F=Math.sqrt(C*C+N*N+w*w);if(Math.abs(F)<1e-6)return null;C*=F=1/F,N*=F,w*=F,i=Math.sin(n),o=Math.cos(n),s=1-o,a=t[0],u=t[1],c=t[2],l=t[3],f=t[4],h=t[5],d=t[6],p=t[7],_=t[8],g=t[9],m=t[10],E=t[11],v=C*C*s+o,y=N*C*s+w*i,b=w*C*s-N*i,A=C*N*s-w*i,T=N*N*s+o,R=w*N*s+C*i,x=C*w*s+N*i,S=N*w*s-C*i,I=w*w*s+o,e[0]=a*v+f*y+_*b,e[1]=u*v+h*y+g*b,e[2]=c*v+d*y+m*b,e[3]=l*v+p*y+E*b,e[4]=a*A+f*T+_*R,e[5]=u*A+h*T+g*R,e[6]=c*A+d*T+m*R,e[7]=l*A+p*T+E*R,e[8]=a*x+f*S+_*I,e[9]=u*x+h*S+g*I,e[10]=c*x+d*S+m*I,e[11]=l*x+p*S+E*I,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e}},function(e,t){e.exports=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},function(e,t){e.exports=function(e,t,n){var r,i,o,s,a,u,c,l,f,h,d,p,_=n[0],g=n[1],m=n[2];t===e?(e[12]=t[0]*_+t[4]*g+t[8]*m+t[12],e[13]=t[1]*_+t[5]*g+t[9]*m+t[13],e[14]=t[2]*_+t[6]*g+t[10]*m+t[14],e[15]=t[3]*_+t[7]*g+t[11]*m+t[15]):(r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=s,e[4]=a,e[5]=u,e[6]=c,e[7]=l,e[8]=f,e[9]=h,e[10]=d,e[11]=p,e[12]=r*_+a*g+f*m+t[12],e[13]=i*_+u*g+h*m+t[13],e[14]=o*_+c*g+d*m+t[14],e[15]=s*_+l*g+p*m+t[15]);return e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,e}},function(e,t){e.exports=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e[4]=o*i+c*r,e[5]=s*i+l*r,e[6]=a*i+f*r,e[7]=u*i+h*r,e[8]=c*i-o*r,e[9]=l*i-s*r,e[10]=f*i-a*r,e[11]=h*i-u*r,e}},function(e,t){e.exports=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],s=t[1],a=t[2],u=t[3],c=t[8],l=t[9],f=t[10],h=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e[0]=o*i-c*r,e[1]=s*i-l*r,e[2]=a*i-f*r,e[3]=u*i-h*r,e[8]=o*r+c*i,e[9]=s*r+l*i,e[10]=a*r+f*i,e[11]=u*r+h*i,e}},function(e,t){e.exports=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],s=t[1],a=t[2],u=t[3],c=t[4],l=t[5],f=t[6],h=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e[0]=o*i+c*r,e[1]=s*i+l*r,e[2]=a*i+f*r,e[3]=u*i+h*r,e[4]=c*i-o*r,e[5]=l*i-s*r,e[6]=f*i-a*r,e[7]=h*i-u*r,e}},function(e,t){e.exports=function(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*s+s]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*o+s]-t[3*s+o])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[s]=(t[3*s+i]+t[3*i+s])*n}return e}},function(e,t){e.exports=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}},function(e,t,n){e.exports=n(111)},function(e,t,n){e.exports=n(112)},function(e,t,n){e.exports=n(113)},function(e,t,n){var r=n(47),i=n(40),o=n(41),s=n(46),a=n(42),u=n(43);e.exports=function(e,t,n){var h=r(t,n);return h<-.999999?(i(c,l,t),o(c)<1e-6&&i(c,f,t),s(c,c),u(e,c,Math.PI),e):h>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(i(c,t,n),e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=1+h,a(e,e))};var c=[0,0,0],l=[1,0,0],f=[0,1,0]},function(e,t,n){e.exports=n(115)},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}},function(e,t){e.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;return e[0]=-n*a,e[1]=-r*a,e[2]=-i*a,e[3]=o*a,e}},function(e,t,n){e.exports=n(116)},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=n[0],u=n[1],c=n[2],l=n[3];return e[0]=r*l+s*a+i*c-o*u,e[1]=i*l+s*u+o*a-r*c,e[2]=o*l+s*c+r*u-i*a,e[3]=s*l-r*a-i*u-o*c,e}},function(e,t){e.exports=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(n),u=Math.cos(n);return e[0]=r*u+s*a,e[1]=i*u+o*a,e[2]=o*u-i*a,e[3]=s*u-r*a,e}},function(e,t){e.exports=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(n),u=Math.cos(n);return e[0]=r*u-o*a,e[1]=i*u+s*a,e[2]=o*u+r*a,e[3]=s*u-i*a,e}},function(e,t){e.exports=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(n),u=Math.cos(n);return e[0]=r*u+i*a,e[1]=i*u-r*a,e[2]=o*u+s*a,e[3]=s*u-o*a,e}},function(e,t,n){e.exports=n(117)},function(e,t,n){e.exports=n(118)},function(e,t){e.exports=function(e,t,n,r){var i,o,s,a,u,c=t[0],l=t[1],f=t[2],h=t[3],d=n[0],p=n[1],_=n[2],g=n[3];(o=c*d+l*p+f*_+h*g)<0&&(o=-o,d=-d,p=-p,_=-_,g=-g);1-o>1e-6?(i=Math.acos(o),s=Math.sin(i),a=Math.sin((1-r)*i)/s,u=Math.sin(r*i)/s):(a=1-r,u=r);return e[0]=a*c+u*d,e[1]=a*l+u*p,e[2]=a*f+u*_,e[3]=a*h+u*g,e}},function(e,t,n){(function(t){const r="undefined"==typeof window?t:window,i=n(8);n(153);const o=n(152),s=n(1),a=n(4);r.luma=Object.assign({},r.luma,i,{filters:o},s),r.mathgl=a,e.exports=r.luma}).call(this,n(9))},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){(function(e,r){var i=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,s=String(e).replace(i,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),u=r[n];n<o;u=r[++n])_(u)||!y(u)?s+=" "+u:s+=" "+a(u);return s},t.deprecate=function(n,i){if(E(e.process))return function(){return t.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var o=!1;return function(){if(!o){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),o=!0}return n.apply(this,arguments)}};var o,s={};function a(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&t._extend(r,n),E(r.showHidden)&&(r.showHidden=!1),E(r.depth)&&(r.depth=2),E(r.colors)&&(r.colors=!1),E(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,e,r.depth)}function u(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function c(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&T(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return m(i)||(i=l(e,i,r)),i}var o=function(e,t){if(E(t))return e.stylize("undefined","undefined");if(m(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(g(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(_(t))return e.stylize("null","null")}(e,n);if(o)return o;var s=Object.keys(n),a=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),A(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(n);if(0===s.length){if(T(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(v(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(b(n))return e.stylize(Date.prototype.toString.call(n),"date");if(A(n))return f(n)}var c,y="",R=!1,x=["{","}"];(d(n)&&(R=!0,x=["[","]"]),T(n))&&(y=" [Function"+(n.name?": "+n.name:"")+"]");return v(n)&&(y=" "+RegExp.prototype.toString.call(n)),b(n)&&(y=" "+Date.prototype.toUTCString.call(n)),A(n)&&(y=" "+f(n)),0!==s.length||R&&0!=n.length?r<0?v(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=R?function(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)I(t,String(s))?o.push(h(e,t,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(e,t,n,r,i,!0))}),o}(e,n,r,a,s):s.map(function(t){return h(e,n,r,a,t,R)}),e.seen.pop(),function(e,t,n){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,y,x)):x[0]+y+x[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,r,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),I(r,i)||(s="["+i+"]"),a||(e.seen.indexOf(u.value)<0?(a=_(n)?l(e,u.value,null):l(e,u.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),E(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function d(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function _(e){return null===e}function g(e){return"number"==typeof e}function m(e){return"string"==typeof e}function E(e){return void 0===e}function v(e){return y(e)&&"[object RegExp]"===R(e)}function y(e){return"object"==typeof e&&null!==e}function b(e){return y(e)&&"[object Date]"===R(e)}function A(e){return y(e)&&("[object Error]"===R(e)||e instanceof Error)}function T(e){return"function"==typeof e}function R(e){return Object.prototype.toString.call(e)}function x(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(E(o)&&(o=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!s[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var n=r.pid;s[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else s[e]=function(){};return s[e]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=p,t.isNull=_,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=m,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=E,t.isRegExp=v,t.isObject=y,t.isDate=b,t.isError=A,t.isFunction=T,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(108);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",function(){var e=new Date,t=[x(e.getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}(),t.format.apply(t,arguments))},t.inherits=n(16),t._extend=function(e,t){if(!t||!y(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,n(9),n(15))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){e.exports=function(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}},function(e,t){e.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}},function(e,t){e.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o;s>0&&(s=1/Math.sqrt(s),e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=o*s);return e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}},function(e,t){e.exports=function(e,t,n,r){var i=t[0],o=t[1],s=t[2],a=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=s+r*(n[2]-s),e[3]=a+r*(n[3]-a),e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}},function(e,t){e.exports=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}},function(e,t,n){var r=n(120);e.exports=function(e){for(var t=r(),n=0;n<e.length;n++)t(e[n]);return t(null)}},function(e,t,n){e.exports=function(){var e,t,n,a,b,A,X,z,W,Y,K,q,Q,Z=Ne(l),J=Ne(c),ee=Ne(_),te=Ne(y),ne=Ne(u),re=(Ne(R),Ne(h)),ie=Ne(d),oe=Ne(g),se=Ne(E),ae=Ne(m),ue=Ne(x),ce=Ne(N),le=Ne(F),fe=arguments.length?[].slice.call(arguments):[],he=!1,de=[],pe=[],_e=[],ge=[],me=!1;return de.shift=function(){var e=[].shift.call(this),t=fe[this.length],n=!1;if(s){for(var r="",i=0,o=this.length;i<o;++i)r+=" |";console.log(r,"/"+e.type)}return fe.length?"function"==typeof fe[0]?n=fe[0](e):void 0!==t&&(n=t.test?t.test(e.type):t===e.type):n=!0,n&&!me&&pe.push(e),Q=e.parent,e},de.unshift=function(e,t){e.parent=de[0];var n=[].unshift.call(this,e);if(t=void 0===t||t,s){for(var r="",i=0,o=this.length-1;i<o;++i)r+=" |";console.log(r,"\\"+e.type,e.token.data)}return t&&Q!==e&&Q.children.push(e),Q=e,n},de.fake=function(e){de.unshift(e),de.shift()},de.unexpected=Pe,de.scope=new i(de),de.create_node=function(){var e=$(u,q);return e.parent=Ee.program,e},e=Ue(ke("struct","keyword"),function(){return"{"===q.data?(de.fake($(u,{data:"",position:q.position,type:"ident"})),o):function(e){return e?function(){var e=q.data;return Be("ident")&&(de.unshift(ne()),de.scope.define(e),o)}:function(){if(Be("ident")){var e=Object.create(de.scope.find(q.data));return e.token=q,_e.shift(),o}}}(!0)()},function(){return de.scope.enter(),o},ke("{"),function(){return"preprocessor"===q.type?(de.fake(we()),void _e.shift()):"}"===q.data?(de.scope.exit(),_e.shift(),de.shift()):void(";"!==q.data?de.unshift(Fe(G)):_e.shift())}),t=Ue(function(){return _e.shift(),o},function(){return Be("keyword",["lowp","mediump","highp"])&&(de.unshift(Le()),o)},function(){return de.unshift(Le()),o},function(){return de.shift()}),n=Ue(ke("["),Ge("]"),ke("]"),function(){return de.shift()}),a=Ue(ke("for","keyword"),ke("("),function(){var e;if("ident"===q.type){if((e=de.scope.find(q.data))||(e=de.create_node()),"struct"===e.parent.type)return de.unshift(Fe(U)),o}else if("builtin"===q.type||"keyword"===q.type)return de.unshift(Fe(U)),o;return Ge(";")()},ke(";"),Ge(";"),ke(";"),Ge(")"),ke(")"),Ve(3),je(),ke("}"),He()),b=Ue(ke("if","keyword"),ke("("),Ge(")"),ke(")"),Ve(3),je(),ke("}"),function(){return"else"===q.data?(_e.shift(),de.unshift(J()),o):He()()},He()),A=Ue(ke("return","keyword"),function(){return";"===q.data?o:(de.unshift(Oe(";")),o)},function(){_e.shift(),He()()}),X=Ue(ke("while","keyword"),ke("("),Ge(")"),ke(")"),Ve(3),je(),ke("}"),He()),z=Ue(ke("do","keyword"),Ve(3),je(),ke("}"),ke("while","keyword"),ke("("),Ge(")"),ke(")"),He()),W=Ue(function(){for(var e=1,t=de.length;e<t;++e)if(de[e].mode===h)return Pe("function definition is not allowed within another function");return o},function(){if(Be("ident")){var e=q.data,t=de.scope.find(e);return de.unshift(ne()),de.scope.define(e),de.scope.enter(t?t.scope:null),o}},ke("("),function(){return de.unshift(ie()),o},ke(")"),function(){return";"===q.data?(de.scope.exit(),de.shift(),de.shift()):o},ke("{"),je(),ke("}"),function(){return de.scope.exit(),o},function(){return de.shift(),de.shift(),de.shift()}),Y=Ue(function(){return"void"===q.data?(de.fake(Le()),_e.shift(),o):")"!==q.data?"struct"===q.data?(de.unshift(Me(j,V)),o):(de.unshift(Fe(k)),o):void de.shift()},function(){if(","===q.data)return _e.shift(),0;")"!==q.data?Pe("expected one of `,` or `)`, got "+q.data):de.shift()}),(Q=Z()).expecting="(eof)",Q.mode=l,Q.token={type:"(program)",data:"(program)"},K=Q,Ee.program=K,Ee.scope=function(e){return 1===arguments.length&&(de.scope=e),de.scope},de.unshift(Q),Ee;function Ee(e){return null===e?(function(e){arguments.length&&ve(e);if(de.length>1)return void Pe("unexpected EOF");!0}(),K):(pe=[],ve(e),pe)}function ve(r){if("whitespace"!==r.type&&"line-comment"!==r.type&&"block-comment"!==r.type)for(_e.push(r),(q=q||_e[0])&&ge.length&&(q.preceding=q.preceding||[],q.preceding=q.preceding.concat(ge),ge=[]);ye();)switch(de[0].mode){case c:Ae();break;case l:be();break;case p:Te();break;case _:Re();break;case v:Ce();break;case f:e(!0,!0);break;case y:t();break;case u:Ie();break;case T:Se();break;case R:xe();break;case h:W();break;case d:Y();break;case g:a();break;case m:X();break;case N:z();break;case x:A();break;case E:b();break;case F:n()}else ge.push(r)}function ye(){return!(me||!de.length)&&(q=_e[0])}function be(){return Ue(function(){return de.scope.enter(),o},function(){if(q.data===de[0].expecting)return de.scope.exit(),de.shift();switch(q.type){case"preprocessor":return de.fake(we()),void _e.shift();default:return void de.unshift(J())}})()}function Ae(){if(de[0].brace)return"}"!==q.data?Pe("expected `}`, got "+q.data):(de[0].brace=!1,_e.shift(),de.shift());switch(q.type){case"eof":return function(){he&&(me=!0);return he=!0,de.shift()}();case"keyword":switch(q.data){case"for":return de.unshift(oe());case"if":return de.unshift(se());case"while":return de.unshift(ae());case"do":return de.unshift(ce());case"break":return de.fake($(S,q)),_e.shift();case"continue":return de.fake($(I,q)),_e.shift();case"discard":return de.fake($(C,q)),_e.shift();case"return":return de.unshift(ue());case"precision":return de.unshift(te())}return de.unshift(Fe(U));case"ident":var e;if(e=de.scope.find(q.data))return"struct"===e.parent.type?de.unshift(Fe(U)):de.unshift(Oe(";"));case"operator":if("{"===q.data){de[0].brace=!0;var t=Z();return t.expecting="}",_e.shift(),de.unshift(t)}if(";"===q.data)return _e.shift(),de.shift();default:return de.unshift(Oe(";"))}}function Te(){var e=de[0];return Ue(function(){return"invariant"===q.data?e.flags&L?(de.unshift(Le()),o):Pe("`invariant` is not allowed here"):(de.fake($(w,{data:"",position:q.position})),o)},function(){return function(e){return"const"===e.data||"attribute"===e.data||"uniform"===e.data||"varying"===e.data}(q)?e.flags&P?(de.unshift(Le()),o):Pe("storage is not allowed here"):(de.fake($(w,{data:"",position:q.position})),o)},function(){return function(e){return"in"===e.data||"inout"===e.data||"out"===e.data}(q)?e.flags&B?Pe("parameter is not allowed here"):(de.unshift(Le()),o):(de.fake($(w,{data:"",position:q.position})),o)},function(){return function(e){return"highp"===e.data||"mediump"===e.data||"lowp"===e.data}(q)?(de.unshift(Le()),o):(de.fake($(w,{data:"",position:q.position})),o)},function(){if("struct"===q.data)return e.flags&D?(de.unshift(Me()),o):Pe("cannot nest structs");if("keyword"===q.type)return de.unshift(Le()),o;var t=de.scope.find(q.data);if(t)return de.fake(Object.create(t)),_e.shift(),o;return Pe("expected user defined type, struct or keyword, got "+q.data)},function(){if(","===q.data&&!(e.flags&O))return de.shift();if("["===q.data)return void de.unshift(le());if(")"===q.data)return de.shift();if(";"===q.data)return e.stage+3;if("ident"!==q.type&&"builtin"!==q.type)return Pe("expected identifier, got "+q.data);return e.collected_name=_e.shift(),o},function(){if("("===q.data)return _e.unshift(e.collected_name),delete e.collected_name,de.unshift(re()),e.stage+2;return o},function(){return _e.unshift(e.collected_name),delete e.collected_name,de.unshift(ee()),o},function(){return de.shift()})()}function Re(){if("ident"===q.type||"builtin"===q.type){var e=q.data;return de.unshift(ne()),void de.scope.define(e)}if("operator"===q.type){if(","===q.data)return de[1].flags&O?_e.shift():de.shift();if("="===q.data)return de[1].flags&M?(_e.shift(),void de.unshift(Oe(",",";"))):Pe("`=` is not allowed here.");if("["===q.data)return void de.unshift(le())}return de.shift()}function xe(){return"keyword"===q.type?(de[0].type="keyword",void(de[0].mode=T)):"ident"===q.type?(de[0].type="ident",void(de[0].mode=u)):Pe("expected keyword or user-defined name, got "+q.data)}function Se(){return"keyword"!==q.type?Pe("expected keyword, got "+q.data):(de.shift(),_e.shift())}function Ie(){return"ident"!==q.type&&"builtin"!==q.type?Pe("expected user-defined name, got "+q.data):(de[0].data=q.data,de.shift(),_e.shift())}function Ce(){var e=de[0].expecting;if(de[0].tokens=de[0].tokens||[],void 0===de[0].parenlevel&&(de[0].parenlevel=0,de[0].bracelevel=0),de[0].parenlevel<1&&e.indexOf(q.data)>-1)return function(e){try{r(de,e)}catch(e){throw me=!0,e}return de.shift()}(de[0].tokens);switch("("===q.data?++de[0].parenlevel:")"===q.data&&--de[0].parenlevel,q.data){case"{":++de[0].bracelevel;break;case"}":--de[0].bracelevel;break;case"(":++de[0].parenlevel;break;case")":--de[0].parenlevel}return de[0].parenlevel<0?Pe("unexpected `)`"):de[0].bracelevel<0?Pe("unexpected `}`"):void de[0].tokens.push(_e.shift())}function Ne(e){return function(){return $(e,q)}}function we(){return $(H[q.type],q)}function Fe(e){var t=$(p,q);return t.flags=e,t}function Me(e,t){var n=$(f,q);return n.allow_assign=void 0===e||e,n.allow_comma=void 0===t||t,n}function Oe(){var e=$(v,q);return e.expecting=[].slice.call(arguments),e}function Le(e){var t=q;return e&&(t={type:"(implied)",data:"(default)",position:t.position}),$(T,t)}function Pe(e){throw me=!0,new Error((e||"unexpected "+de)+" at line "+de[0].token.line)}function Be(e,t){return De(e,q.type)&&De(t,q.data)}function De(e,t){switch(typeof e){case"string":return t!==e&&Pe("expected `"+e+"`, got "+t+"\n"+q.data),!me;case"object":return e&&-1===e.indexOf(t)&&Pe("expected one of `"+e.join("`, `")+"`, got "+t),!me}return!0}function Ue(){var e,t,n=[].slice.call(arguments);return function(){var r=de[0];return r.stage||(r.stage=0),(e=n[r.stage])?(t=e())===o?++r.stage:void(void 0!==t&&(r.stage=t)):Pe("parser in undefined state!")}}function ke(e,t){return t=t||"operator",function(){if(Be(t,e)){var n=_e.shift(),r=de[0].children,i=r[r.length-1];return i&&i.token&&n.preceding&&(i.token.succeeding=i.token.succeeding||[],i.token.succeeding=i.token.succeeding.concat(n.preceding)),o}}}function Ge(e){return function(){return de.unshift(Oe(e)),o}}function je(){return function(){var e=Z();return e.expecting="}",de.unshift(e),o}}function Ve(e){return function(){var t=de[0].stage;return"{"!==q.data?(de.unshift(J()),t+e):(_e.shift(),o)}}function He(){return function(){return de.shift(),de.shift()}}};var r=n(121),i=n(122),o=new Object,s=!1,a=0,u=a++,c=a++,l=a++,f=a++,h=a++,d=a++,p=a++,_=a++,g=a++,m=a++,E=a++,v=a++,y=a++,b=a++,A=a++,T=a++,R=a++,x=a++,S=a++,I=a++,C=a++,N=a++,w=a++,F=a++,M=1,O=2,L=8,P=16,B=32,D=64,U=255,k=U&~(M|O|B|L|4),G=U&~(M|L|P|D),j=!1,V=!1,H={"block-comment":b,"line-comment":b,preprocessor:A},X=a=["ident","stmt","stmtlist","struct","function","functionargs","decl","decllist","forloop","whileloop","if","expr","precision","comment","preprocessor","keyword","keyword_or_ident","return","break","continue","discard","do-while","placeholder","quantifier"];function $(e,t){return{mode:e,token:t,children:[],type:X[e],id:(4294967295*Math.random()).toString(16)}}},function(e,t){var n,r,i,o,s={nud:function(){return this.children&&this.children.length?this:m("unexpected")()},led:m("missing operator")},a={};function u(){return this}function c(e,t){var n=a[e];return t=t||0,n?t>n.lbp&&(n.lbp=t):((n=Object.create(s)).id=e,n.lbp=t,a[e]=n),n}function l(e){var t,n=r;for(g(),t=n.nud();e<r.lbp;)n=r,g(),t=n.led(t);return t}function f(e,t,n){c(e,t).led=n||function(e){return this.children=[e,l(t)],this.type="binary",this}}function h(e,t,n){var r=c(e,t);return r.led=n||function(e){return this.children=[e,l(t-1)],this.type="binary",this},r}function d(e,t){var n=c(e);return n.nud=t||function(){return this.children=[l(70)],this.type="unary",this},n}function p(e){c(e,150).led=function(e){return this.children=[e],this.type="suffix",this}}function _(e){return h(e,10,function(e){return this.children=[e,l(9)],this.assignment=!0,this.type="assign",this})}function g(e){var t,s,c,l;if(e&&r.data!==e)return n.unexpected("expected `"+e+"`, got `"+r.data+"`");if(!(o>=i.length)){if(s=(t=i[o++]).data,"ident"===(c=t.type))c=(l=n.scope.find(s)||n.create_node()).type;else if("builtin"===c)l=a["(builtin)"];else if("keyword"===c)l=a["(keyword)"];else if("operator"===c){if(!(l=a[s]))return n.unexpected("unknown operator `"+s+"`")}else{if("float"!==c&&"integer"!==c)return n.unexpected("unexpected token.");c="literal",l=a["(literal)"]}return l&&(l.nud||(l.nud=u),l.children||(l.children=[])),(l=Object.create(l)).token=t,l.type=c,l.data||(l.data=s),r=l}r=a["(end)"]}function m(e){return function(){return n.unexpected(e)}}c("(ident)").nud=u,c("(keyword)").nud=u,c("(builtin)").nud=u,c("(literal)").nud=u,c("(end)"),c(":"),c(";"),c(","),c(")"),c("]"),c("}"),h("&&",30),h("||",30),f("|",43),f("^",44),f("&",45),f("==",46),f("!=",46),f("<",47),f("<=",47),f(">",47),f(">=",47),f(">>",48),f("<<",48),f("+",50),f("-",50),f("*",60),f("/",60),f("%",60),f("?",20,function(e){return this.children=[e,l(0),(g(":"),l(0))],this.type="ternary",this}),f(".",80,function(e){return r.type="literal",n.fake(r),this.children=[e,r],g(),this}),f("[",80,function(e){return this.children=[e,l(0)],this.type="binary",g("]"),this}),f("(",80,function(e){if(this.children=[e],this.type="call",")"!==r.data)for(;this.children.push(l(0)),","===r.data;)g(",");return g(")"),this}),d("-"),d("+"),d("!"),d("~"),d("defined"),d("(",function(){return this.type="group",this.children=[l(0)],g(")"),this}),d("++"),d("--"),p("++"),p("--"),_("="),_("+="),_("-="),_("*="),_("/="),_("%="),_("&="),_("|="),_("^="),_(">>="),_("<<="),e.exports=function(e,t){var r;if(n=e,o=0,(i=t).length){if(g(),(r=l(0)).parent=n[0],function e(t){n.unshift(t,!1);for(var r=0,i=t.children.length;r<i;++r)e(t.children[r]);n.shift()}(r),o<i.length)throw new Error("did not use all tokens");r.parent.children=[r]}}},function(e,t){function n(e){if(this.constructor!==n)return new n(e);this.state=e,this.scopes=[],this.current=null}e.exports=n;var r=n.prototype;r.enter=function(e){this.scopes.push(this.current=this.state[0].scope=e||{})},r.exit=function(){this.scopes.pop(),this.current=this.scopes[this.scopes.length-1]},r.define=function(e){this.current[e]=this.state[0]},r.find=function(e,t){for(var n=this.scopes.length-1;n>-1;--n)if(this.scopes[n].hasOwnProperty(e))return this.scopes[n][e];return null}},function(e,t,n){e.exports=function(e){var t,n,T,R=0,x=0,S=u,I=[],C=[],N=1,w=0,F=0,M=!1,O=!1,L="",P=o,B=r;"300 es"===(e=e||{}).version&&(P=a,B=s);for(var D={},U={},R=0;R<P.length;R++)D[P[R]]=!0;for(var R=0;R<B.length;R++)U[B[R]]=!0;return function(e){return C=[],null!==e?function(e){R=0,e.toString&&(e=e.toString());var n;L+=e.replace(/\r\n/g,"\n"),T=L.length;for(;t=L[R],R<T;){switch(n=R,S){case l:R=H();break;case f:case h:R=V();break;case d:R=X();break;case p:R=W();break;case b:R=z();break;case _:R=Y();break;case c:R=K();break;case v:R=j();break;case u:R=G()}if(n!==R)switch(L[n]){case"\n":w=0,++N;break;default:++w}}return x+=R,L=L.slice(R),C}(e):function(e){I.length&&k(I.join(""));return S=y,k("(eof)"),C}()};function k(e){e.length&&C.push({type:A[S],data:e,position:F,line:N,column:w})}function G(){return I=I.length?[]:I,"/"===n&&"*"===t?(F=x+R-1,S=l,n=t,R+1):"/"===n&&"/"===t?(F=x+R-1,S=f,n=t,R+1):"#"===t?(S=h,F=x+R,R):/\s/.test(t)?(S=v,F=x+R,R):(M=/\d/.test(t),O=/[^\w_]/.test(t),F=x+R,S=M?p:O?d:c,R)}function j(){return/[^\s]/g.test(t)?(k(I.join("")),S=u,R):(I.push(t),n=t,R+1)}function V(){return"\r"!==t&&"\n"!==t||"\\"===n?(I.push(t),n=t,R+1):(k(I.join("")),S=u,R)}function H(){return"/"===t&&"*"===n?(I.push(t),k(I.join("")),S=u,R+1):(I.push(t),n=t,R+1)}function X(){if("."===n&&/\d/.test(t))return S=_,R;if("/"===n&&"*"===t)return S=l,R;if("/"===n&&"/"===t)return S=f,R;if("."===t&&I.length){for(;$(I););return S=_,R}if(";"===t||")"===t||"("===t){if(I.length)for(;$(I););return k(t),S=u,R+1}var e=2===I.length&&"="!==t;if(/[\w_\d\s]/.test(t)||e){for(;$(I););return S=u,R}return I.push(t),n=t,R+1}function $(e){for(var t,n,r=0;;){if(t=i.indexOf(e.slice(0,e.length+r).join("")),n=i[t],-1===t){if(r--+e.length>0)continue;n=e.slice(0,1).join("")}return k(n),F+=n.length,(I=I.slice(n.length)).length}}function z(){return/[^a-fA-F0-9]/.test(t)?(k(I.join("")),S=u,R):(I.push(t),n=t,R+1)}function W(){return"."===t?(I.push(t),S=_,n=t,R+1):/[eE]/.test(t)?(I.push(t),S=_,n=t,R+1):"x"===t&&1===I.length&&"0"===I[0]?(S=b,I.push(t),n=t,R+1):/[^\d]/.test(t)?(k(I.join("")),S=u,R):(I.push(t),n=t,R+1)}function Y(){return"f"===t&&(I.push(t),n=t,R+=1),/[eE]/.test(t)?(I.push(t),n=t,R+1):("-"!==t&&"+"!==t||!/[eE]/.test(n))&&/[^\d]/.test(t)?(k(I.join("")),S=u,R):(I.push(t),n=t,R+1)}function K(){if(/[^\d\w_]/.test(t)){var e=I.join("");return S=U[e]?E:D[e]?m:g,k(I.join("")),S=u,R}return I.push(t),n=t,R+1}};var r=n(51),i=n(124),o=n(52),s=n(125),a=n(126),u=999,c=9999,l=0,f=1,h=2,d=3,p=4,_=5,g=6,m=7,E=8,v=9,y=10,b=11,A=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},function(e,t){e.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},function(e,t,n){var r=n(51);e.exports=r.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},function(e,t,n){var r=n(52);r=r.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),e.exports=r.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},function(e,t,n){"use strict";t.gl_NumWorkGroups="uvec3",t.gl_WorkGroupSize="uvec3",t.gl_WorkGroupID="uvec3",t.gl_LocalInvocationID="uvec3",t.gl_GlobalInvocationID="uvec3",t.gl_LocalInvocationIndex="uint",t.gl_VertexID="int",t.gl_InstanceID="int",t.gl_Position="vec4",t.gl_PointSize="float",t.gl_ClipDistance="float",t.gl_FragCoord="vec4",t.gl_FragColor="vec4",t.gl_FrontFacing="bool",t.gl_PointCoord="vec2",t.gl_PrimitiveID="int",t.gl_SampleID="int",t.gl_SamplePosition="vec2",t.gl_SampleMaskIn="int",t.gl_Layer="int",t.gl_ViewportIndex="int",t.gl_FragDepth="float",t.gl_SampleMask="int"},function(e,t,n){"use strict";e.exports=function(e,t,n){var r,o,s={};if("string"==typeof t&&(t=i(t)),Array.isArray(t)){var a={};for(o=0;o<t.length;o++)a[t[o]]=!0;t=a}for(r in t)t[r]=i(t[r]);var u={};for(r in t){var c=t[r];if(Array.isArray(c))for(o=0;o<c.length;o++){var l=c[o];if(n&&(u[l]=!0),l in e){if(s[r]=e[l],n)for(var f=o;f<c.length;f++)u[c[f]]=!0;break}}else r in e&&(t[r]&&(s[r]=e[r]),n&&(u[r]=!0))}if(n)for(r in e)u[r]||(s[r]=e[r]);return s};var r={};function i(e){return r[e]?r[e]:("string"==typeof e&&(e=r[e]=e.split(/\s*,\s*|\s+/)),e)}},function(e,t){e.exports=/[-+]?(?:\d*\.?\d+|\d+\.?\d*)(?:[eE][-+]?\d+)?/},function(e,t,n){"use strict";var r=n(54).operators;function i(e){if(Number.isInteger(e))return function(t){return this.process(t.children[e+1]).type};var t=e;return this.process(t.children[1]).type}function o(e){return 0|e}function s(e){return+e}function a(e,t){return null==e&&(e=0),null==t&&(t=e),[e,t]}function u(e,t,n){return null==e&&(e=0),null==t&&(t=e),null==n&&(n=t),[e,t,n]}function c(e,t,n,r){return null==e&&(e=0),null==t&&(t=e),null==n&&(n=t),null==r&&(r=n),[e,t,n,r]}function l(e){return null==e&&(e=1),4===e.length?e:2===e.length?[e[0],0,0,e[1]]:[e,0,0,e]}function f(e){return null==e&&(e=1),9===e.length?e:3===e.length?[e[0],0,0,0,e[1],0,0,0,e[2]]:[e,0,0,0,e,0,0,0,e]}function h(e){return null==e&&(e=1),16===e.length?e:4===e.length?[e[0],0,0,0,0,e[1],0,0,0,0,e[2],0,0,0,0,e[3]]:[e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,e]}function d(e,t){for(var n in r){for(var i=[],o=0;o<t;o++)i.push(`out[${o}] = a[${o}] ${n} b[${o}]`);e[r[n]]=new Function("out","a","b",`${i.join("\n")}\nreturn out`),e[r[n]].source=new String(`function ${r[n]} (out, a, b) {\n\t\t\t${i.join(";\n")};\n\n\t\t\treturn out;\n\t\t}`),e[r[n]].toString=e[r[n]].toSource=function(){return this.source}}}function p(e){return e.length?e.map(p):.017453292519943295*e}function _(e){return e.length?e.map(_):57.29577951308232*e}function g(e){return e.length?e.map(g):Math.sin(e)}function m(e){return e.length?e.map(m):Math.cos(e)}function E(e){return e.length?e.map(E):Math.tan(e)}function v(e){return e.length?e.map(v):Math.asin(e)}function y(e){return e.length?e.map(y):Math.acos(e)}function b(e,t){return arguments.length>1?e.length?e.map(function(e,n){return Math.atan2(e,t[n])}):Math.atan2(e,t):e.length?e.map(function(e,t){return Math.atan(e)}):Math.atan(e)}function A(e,t){return e.length?e.map(function(e,n){return Math.pow(e,t[n])}):Math.pow(e,t)}function T(e){return e.length?e.map(T):Math.exp(e)}function R(e){return e.length?e.map(R):Math.log(e)}d(a,2),d(u,3),d(c,4),d(l,4),p.type=i,_.type=i,g.type=i,m.type=i,E.type=i,v.type=i,y.type=i,b.type=i,A.type=i,T.type=i,R.type=i;var x=Math.log2?function e(t){return t.length?t.map(e):Math.log2(t)}:function e(t){return t.length?t.map(e):Math.log(t)/Math.LN2};function S(e){return e.length?e.map(S):Math.pow(2,e)}function I(e){return e.length?e.map(I):Math.sqrt(e)}function C(e){return e.length?e.map(C):1/Math.sqrt(e)}function N(e){return e.length?e.map(N):Math.abs(e)}function w(e){return e.length?e.map(w):Math.floor(e)}function F(e){return e.length?e.map(F):Math.ceil(e)}x.type=i,S.type=i,I.type=i,C.type=i,N.type=i,w.type=i,F.type=i;var M=Math.sign?function e(t){return t.length?t.map(e):Math.sign(t)}:function e(t){return t.length?t.map(e):0===(t=+t)||isNaN(t)?t:t>0?1:-1};function O(e){return e.length?e.map(O):e-Math.floor(e)}function L(e,t){return e.length?t.length?e.map(function(e,n){return 0===e||0===t[n]?0:e%t[n]}):e.map(function(e,n){return 0===e||0===t?0:e%t}):e%t}function P(e,t){return e.length?t.length?e.map(function(e,n){return Math.min(e,t[n])}):e.map(function(e,n){return Math.min(e,t)}):Math.min(e,t)}function B(e,t){return e.length?t.length?e.map(function(e,n){return Math.max(e,t[n])}):e.map(function(e,n){return Math.max(e,t)}):Math.max(e,t)}function D(e,t,n){return e.length?t.length?e.map(function(e,r){return Math.min(Math.max(e,t[r]),n[r])}):e.map(function(e,r){return Math.min(Math.max(e,t),n)}):Math.min(Math.max(e,t),n)}function U(e,t,n){return e.length?n.length?e.map(function(e,r){return U(e,t[r],n[r])}):e.map(function(e,r){return U(e,t[r],n)}):e*(1-n)+t*n}function k(e,t){return t||e?t.length?e.length?t.map(function(t,n){return k(e[n],t)}):t.map(function(t,n){return k(e,t)}):t<e?0:1:0}function G(e,t,n){if(!n&&!e&&!t)return 0;if(n.length)return e.length?n.map(function(n,r){return G(e[r],t[r],n)}):n.map(function(n,r){return G(e,t,n)});var r=Math.min(Math.max((n-e)/(t-e),0),1);return r*r*(3-2*r)}function j(e){for(var t=0,n=0;n<e.length;n++)t+=e[n]*e[n];return Math.sqrt(t)}function V(e,t){for(var n=0,r=0;r<e.length;r++)n+=(e[r]-t[r])*(e[r]-t[r]);return Math.sqrt(n)}function H(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function X(e,t){var n=e[0],r=e[1],i=e[2],o=t[0],s=t[1],a=t[2],u=[0,0,0];return u[0]=r*a-i*s,u[1]=i*o-n*a,u[2]=n*s-r*o,u}function $(e){for(var t=0,n=0;n<e.length;n++)t+=e[n]*e[n];var r=Array(e.length).fill(0);if(t>0){t=1/Math.sqrt(t);for(n=0;n<e.length;n++)r[n]=e[n]*t}return r}function z(e,t,n){null==n&&(n=e);for(var r=0,i=0;i<e.length;i++)r+=n[i]*t[i];return r>0?e.map(function(e){return-e}):e}function W(e,t){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];var i=Array(t.length);for(r=0;r<t.length;r++)i[r]=e[r]-2*n*t[r];return i}function Y(e,t,n){for(var r=0,i=0;i<t.length;i++)r+=t[i]*e[i];var o=1-n*n*(1-r*r),s=Array(t.length).fill(0);if(o>0)for(i=0;i<t.length;i++)s[i]=n*e[i]-(n*r+Math.sqrt(o))*t[i];return s}function K(e,t){for(var n=[],r=e.length,i=0;i<e.length;i++)for(var o=0;o<t.length;o++)n[i*r+o]=e[i]*t[o];return n}function q(e){if(4===e.length)return e[0]*e[3]-e[1]*e[2];if(9===e.length){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7];return t*o*(f=e[8])+n*s*a+r*i*u-r*o*a-n*i*f-t*s*u}t=e[0],n=e[1],r=e[2];var c=e[3],l=(i=e[4],o=e[5],s=e[6],e[7]),f=(a=e[8],u=e[9],e[10]),h=e[11],d=e[12],p=e[13],_=e[14],g=e[15];return(t*o-n*i)*(f*g-h*_)-(t*s-r*i)*(u*g-h*p)+(t*l-c*i)*(u*_-f*p)+(n*s-r*o)*(a*g-h*d)-(n*l-c*o)*(a*_-f*d)+(r*l-c*s)*(a*p-u*d)}function Q(e,t,n){var r=Z(e),i=t[0]%1*r[0]|0,o=4*(t[1]%1*r[1]|0)*r[0]+4*i;return e.data?e.data.slice(o,o+4):e.slice(o,o+4)}function Z(e,t){return e.shape?[e.shape[0],e.shape[1]]:[e.width,e.height]}M.type=i,O.type=i,L.type=i,P.type=i,B.type=i,D.type=i,U.type=i,k.type=i(1),G.type=i(2),j.type="float",V.type="float",H.type="float",X.type="vec3",$.type=i,z.type=i,W.type=i,Y.type=i,K.type=function(e){var t=this.process(e.children[1]).type,n=this.process(e.children[2]).type;return`mat${t.slice(-1)}x${n.slice(-1)}`},q.type="float",Q.include=["textureSize"],Q.type=function(e){var t=this.process(e.children[1]).type;return this.types[t].type},Q.type=function(e){var t=this.process(e.children[1]).type;return/1D/.test(t)?"int":/2D|Cube/.test(t)?"ivec2":"ivec3"},t.bool=function(e){return!!e},t.int=o,t.uint=o,t.float=s,t.double=s,t.vec2=a,t.vec3=u,t.vec4=c,t.dvec2=a,t.dvec3=u,t.dvec4=c,t.ivec2=a,t.ivec3=u,t.ivec4=c,t.uvec2=a,t.uvec3=u,t.uvec4=c,t.mat2=l,t.mat3=f,t.mat4=h,t.mat3x3=f,t.mat4x4=h,t.radians=p,t.degrees=_,t.sin=g,t.cos=m,t.tan=E,t.asin=v,t.acos=y,t.atan=b,t.pow=A,t.exp=T,t.log=R,t.log2=x,t.exp2=S,t.sqrt=I,t.inversesqrt=C,t.abs=N,t.sign=M,t.floor=w,t.ceil=F,t.fract=O,t.mod=L,t.min=P,t.max=B,t.clamp=D,t.mix=U,t.step=k,t.smoothstep=G,t.length=j,t.distance=V,t.dot=H,t.cross=X,t.faceforward=z,t.normalize=$,t.reflect=W,t.refract=Y,t.lessThan=function(e,t){if(e.length){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=e[r]<t[r];return n}return e<t},t.lessThanEqual=function(e,t){if(e.length){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=e[r]<=t[r];return n}return e<=t},t.greaterThan=function(e,t){if(e.length){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=e[r]>t[r];return n}return e>t},t.greaterThanEqual=function(e,t){if(e.length){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=e[r]>=t[r];return n}return e>=t},t.equal=function(e,t){if(e.length){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=e[r]==t[r];return n}return e==t},t.notEqual=function(e,t){if(e.length){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=e[r]!=t[r];return n}return e!=t},t.any=function(e){return e.some(function(e){return e})},t.all=function(e){return e.every(function(e){return e})},t.not=function(e){if(e.length){for(var t=Array(e.length),n=0;n<e.length;n++)t[n]=!e[n];return t}return!e},t.matrixCompMult=function(e,t){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=e[r]*t[r];return n},t.matrixMult=function(e,t){for(var n=16===e.length?4:9===e.length?3:2,r=Array(e.length),i=0;i<n;i++)for(var o=0;o<n;o++){for(var s=0,a=0;a<n;a++)s+=e[n*a+i]*t[o*n+a];r[o*n+i]=s}return r},t.outerProduct=K,t.transpose=function(e){for(var t=16===e.length?4:9===e.length?3:2,n=Array(e.length),r=0;r<t;r++)for(var i=0;i<t;i++)n[i*t+r]=e[r*t+i];return n},t.determinant=q,t.inverse=function(e){var t=e.length,n=Array(t);if(4===t){var r=e[0],i=e[1],o=e[2],s=e[3];return(m=r*s-o*i)?(m=1/m,n[0]=s*m,n[1]=-i*m,n[2]=-o*m,n[3]=r*m,n):n}if(9===t){var a=e[0],u=e[1],c=e[2],l=e[3],f=e[4],h=e[5],d=e[6],p=(y=e[7])*l-f*d;return(m=a*(_=(b=e[8])*f-h*y)+u*(g=-b*l+h*d)+c*p)?(m=1/m,n[0]=_*m,n[1]=(-b*u+c*y)*m,n[2]=(h*u-c*f)*m,n[3]=g*m,n[4]=(b*a-c*d)*m,n[5]=(-h*a+c*l)*m,n[6]=p*m,n[7]=(-y*a+u*d)*m,n[8]=(f*a-u*l)*m,n):n}a=e[0],u=e[1],c=e[2];var _,g,m,E=e[3],v=(l=e[4],f=e[5],h=e[6],e[7]),y=(d=e[8],e[9]),b=e[10],A=e[11],T=e[12],R=e[13],x=e[14],S=e[15],I=a*f-u*l,C=a*v-E*l,N=u*h-c*f,w=u*v-E*f,F=c*v-E*h,M=d*R-y*T,O=d*x-b*T,L=d*S-A*T,P=y*x-b*R,B=y*S-A*R;return(m=I*(g=b*S-A*x)-(_=a*h-c*l)*B+C*P+N*L-w*O+F*M)?(m=1/m,n[0]=(f*g-h*B+v*P)*m,n[1]=(c*B-u*g-E*P)*m,n[2]=(R*F-x*w+S*N)*m,n[3]=(b*w-y*F-A*N)*m,n[4]=(h*L-l*g-v*O)*m,n[5]=(a*g-c*L+E*O)*m,n[6]=(x*C-T*F-S*_)*m,n[7]=(d*F-b*C+A*_)*m,n[8]=(l*B-f*L+v*M)*m,n[9]=(u*L-a*B-E*M)*m,n[10]=(T*w-R*C+S*I)*m,n[11]=(y*C-d*w-A*I)*m,n[12]=(f*O-l*P-h*M)*m,n[13]=(a*P-u*O+c*M)*m,n[14]=(R*_-T*N-x*I)*m,n[15]=(d*N-y*_+b*I)*m,n):n},t.texture1D=t.texture2D=t.texture3D=t.textureCube=t.shadow1D=t.shadow2D=t.shadow3D=t.texture=Q,t.textureSize=Z},function(e,t,n){"use strict";function r(e){return function e(t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?e(i,n):n.push(i)}return n}(e,[])}function i(e,t){if("number"!=typeof t)throw new TypeError("Expected the depth to be a number");return function e(t,n,r){r--;for(var i=0;i<t.length;i++){var o=t[i];r>-1&&Array.isArray(o)?e(o,n,r):n.push(o)}return n}(e,[],t)}e.exports=function(e){if(!Array.isArray(e))throw new TypeError("Expected value to be an array");return r(e)},e.exports.from=r,e.exports.depth=function(e,t){if(!Array.isArray(e))throw new TypeError("Expected value to be an array");return i(e,t)},e.exports.fromDepth=i},function(module,exports,__webpack_require__){var paren=__webpack_require__(133),balanced=__webpack_require__(134),extend=__webpack_require__(36),escaper=__webpack_require__(135);function preprocess(what,how){var result="",source=what+"",macros=extend({__LINE__:0,__FILE__:"_",__VERSION__:100,defined:function(e){return[].slice.call(arguments).every(function(e){return null!=macros[e]})}},how);return process(source);function process(e){if(!e)return"";var t=[],n=e,r=/#[A-Za-z0-9_$]+/gi.exec(e);for(var i in r&&(n=n.slice(0,r.index),e=e.slice(r.index)),n=(n=escape(n,t)).replace(/\bdefined\s*([A-Za-z0-9_$]+)/g,"defined($1)"),macros)macros[i]instanceof Function&&(n=processFunction(n,i,macros[i]));for(var i in n=escape(n,t),macros)macros[i]instanceof Function||(n=processDefinition(n,i,macros[i]));if(n=unescape(n,t),r){if(/^#def/.test(r[0]))e=define(e);else if(/^#undef/.test(r[0]))e=undefine(e);else if(/^#if/.test(r[0]))e=processIf(e);else if(/^#line/.test(r[0])){var o=/#[A-Za-z0-9_]+\s*([-0-9]+)?[^\n]*/.exec(e);macros.__LINE__=parseInt(o[1]),e=e.slice(o.index+o[0].length)}else if(/^#version/.test(r[0])){o=/#[A-Za-z0-9_]+\s*([-0-9]+)?[^\n]*/.exec(e);macros.__VERSION__=parseInt(o[1]),e=e.slice(o.index+o[0].length)}else{var s=/\n/m.exec(e);n+=e.slice(0,s.index)+"\n",e=e.slice(s.index)}return n+process(e)}return n}function processFunction(e,t,n){var r=[];e=escape(e,r);var i=paren(e,{flat:!0,brackets:"()",escape:"___"}),o=new RegExp(t+"\\s*\\(___([0-9]+)\\)","g");return i=i.map(function(e){return e.replace(o,function(e,r){var o=i[r];if((o=o.trim().length?(o=o.split(/\s*,\s*/)).map(function(e){var t=i.slice();return t[0]=e,paren.stringify(t,{flat:!0,escape:"___"})}).map(function(e){return e}):[]).length!=n.length)throw Error(`macro "${t}" requires ${n.length} arguments, but ${o.length} given`);return n.apply(null,o)})}),e=unescape(e=paren.stringify(i,{flat:!0,escape:"___"}),r)}function processDefinition(e,t,n){var r=[];return e=unescape(e=(e=(e=(e=(e=escape(e,r)).replace(new RegExp(`([^#A-Za-z0-9_$]|^)${t}\\s*##\\s*([A-Za-z0-9_$]*)`,"g"),function(e,t,r){return t+n+r})).replace(new RegExp(`([A-Za-z0-9_$]*)\\s*##\\s*${t}([^A-Za-z0-9_$]|$)`,"g"),function(e,t,r){return t+n+r})).replace(new RegExp(`([^#A-Za-z0-9_$]|^)${t}([^A-Za-z0-9_$]|$)`,"g"),function(e,t,r){return null==macros[n]||macros[n]instanceof Function||(n=macros[n]),t+n+r})).replace(new RegExp(`#${t}([^A-Za-z0-9_$]|$)`,"g"),function(e,t){return'"'+n+'"'+t}),r)}function escape(e,t){return escaper.replace(e,!0,t)}function unescape(e,t){return t&&t.length?escaper.paste(e,t):e}function define(e){var t=/#[A-Za-z]+[ ]*([A-Za-z0-9_$]*)(?:\(([^\(\)]*)\))?[ \r]*([^\n]*)$/m.exec(e);e=e.slice(t.index+t[0].length);var n=t[1],r=t[2],i=t[3];if(!n||!i)throw Error(`Macro definition "${t[0]}" is malformed`);if(null!=r){function o(){for(var e=i,t=0;t<r.length;t++)e=processDefinition(e,r[t],arguments[t]);return e=process(e)}r=r.trim().length?r.split(/\s*,\s*/):[],Object.defineProperty(o,"length",{value:r.length}),macros[n]=o}else macros[n]=i;return e}function undefine(e){var t=/#[A-Za-z0-9_]+[ ]*([A-Za-z0-9_$]+)/.exec(e);return delete macros[t[1]],e.slice(t.index+t[0].length)}function processIf(str){var match=balanced("#if","#endif",str);if(!match)return str;var body=match.body,post=match.post,elseBody="",matchElse;if((matchElse=/^\s*#else[^\n\r]*$/m.exec(body))&&(elseBody=body.slice(matchElse.index+matchElse[0].length),body=body.slice(0,matchElse.index)),/^def/.test(body)){body=body.slice(3);var nameMatch=/[A-Za-z0-9_$]+/.exec(body),name=nameMatch[0];body=body.slice(name.length+nameMatch.index),str=null!=macros[name]?process(body):process(elseBody)}else if(/^ndef/.test(body)){body=body.slice(4);var nameMatch=/[A-Za-z0-9_$]+/.exec(body),name=nameMatch[0];body=body.slice(name.length+nameMatch.index),str=null==macros[name]?process(body):process(elseBody)}else{for(var clauses=body.split(/^\s*#elif\s+/m),result=!1,i=0;i<clauses.length;i++){var clause=clauses[i],exprMatch=/\s*(.*)/.exec(clause),expr=exprMatch[0];clause=clause.slice(expr.length+exprMatch.index),expr=process(expr);try{result=eval(expr)}catch(e){result=!1}if(result){str=process(clause);break}}result||(str=process(elseBody))}var match=/[\n\r]/.exec(post);return match&&(post=post.slice(match.index)),str+post}}module.exports=preprocess},function(e,t,n){"use strict";function r(e,t){if("string"!=typeof e)return[e];var n=[e];"string"==typeof t||Array.isArray(t)?t={brackets:t}:t||(t={});var r=t.brackets?Array.isArray(t.brackets)?t.brackets:[t.brackets]:["{}","[]","()"],i=t.escape||"___",o=!!t.flat;r.forEach(function(e){var t=new RegExp(["\\",e[0],"[^\\",e[0],"\\",e[1],"]*\\",e[1]].join("")),r=[];function o(t,o,s){var a=n.push(t.slice(e[0].length,-e[1].length))-1;return r.push(a),i+a}n.forEach(function(e,r){for(var i,s=0;e!=i;)if(i=e,e=e.replace(t,o),s++>1e4)throw Error("References have circular dependency. Please, check them.");n[r]=e}),r=r.reverse(),n=n.map(function(t){return r.forEach(function(n){t=t.replace(new RegExp("(\\"+i+n+"(?![0-9]))","g"),e[0]+"$1"+e[1])}),t})});var s=new RegExp("\\"+i+"([0-9]+)");return o?n:function e(t,n,r){for(var i,o=[],a=0;i=s.exec(t);){if(a++>1e4)throw Error("Circular references in parenthesis");o.push(t.slice(0,i.index)),o.push(e(n[i[1]],n)),t=t.slice(i.index+i[0].length)}return o.push(t),o}(n[0],n)}function i(e,t){if(t&&t.flat){var n,r=t&&t.escape||"___",i=e[0];if(!i)return"";for(var o=new RegExp("\\"+r+"([0-9]+)"),s=0;i!=n;){if(s++>1e4)throw Error("Circular references in "+e);n=i,i=i.replace(o,a)}return i}return e.reduce(function e(t,n){return Array.isArray(n)&&(n=n.reduce(e,"")),t+n},"");function a(t,n){if(null==e[n])throw Error("Reference "+n+"is undefined");return e[n]}}function o(e,t){return Array.isArray(e)?i(e,t):r(e,t)}o.parse=r,o.stringify=i,e.exports=o},function(e,t){function n(e,t,n){var i=r(e,t,n);return i&&{start:i[0],end:i[1],pre:n.slice(0,i[0]),body:n.slice(i[0]+e.length,i[1]),post:n.slice(i[1]+t.length)}}function r(e,t,n){var r,i,o,s,a,u=n.indexOf(e),c=n.indexOf(t,u+1),l=u;if(u>=0&&c>0){for(r=[],o=n.length;l<n.length&&l>=0&&!a;)l==u?(r.push(l),u=n.indexOf(e,l+1)):1==r.length?a=[r.pop(),c]:((i=r.pop())<o&&(o=i,s=c),c=n.indexOf(t,l+1)),l=u<c&&u>=0?u:c;r.length&&(a=[o,s])}return a}e.exports=n,n.range=r},function(e,t,n){
/*!
 * Escaper v2.5.3
 * https://github.com/kobezzza/Escaper
 *
 * Released under the MIT license
 * https://github.com/kobezzza/Escaper/blob/master/LICENSE
 *
 * Date: Tue, 23 Jan 2018 15:58:45 GMT
 */
!function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=void 0,r=n={VERSION:[2,5,3],content:[],cache:{},snakeskinRgxp:null,symbols:null,replace:C,paste:w},i={'"':!0,"'":!0,"`":!0},o={"/":!0};for(var s in i){if(!i.hasOwnProperty(s))break;o[s]=!0}var a={"//":!0,"//*":!0,"//!":!0,"//#":!0,"//@":!0,"//$":!0},u={"/*":!0,"/**":!0,"/*!":!0,"/*#":!0,"/*@":!0,"/*$":!0},c=[],l={};for(var f in o){if(!o.hasOwnProperty(f))break;c.push(f),l[f]=!0}for(var h in a){if(!a.hasOwnProperty(h))break;c.push(h),l[h]=!0}for(var d in u){if(!u.hasOwnProperty(d))break;c.push(d),l[d]=!0}var p=[],_={g:!0,m:!0,i:!0,y:!0,u:!0};for(var g in _){if(!_.hasOwnProperty(g))break;p.push(g)}var m={"-":!0,"+":!0,"*":!0,"%":!0,"~":!0,">":!0,"<":!0,"^":!0,",":!0,";":!0,"=":!0,"|":!0,"&":!0,"!":!0,"?":!0,":":!0,"(":!0,"{":!0,"[":!0},E={return:!0,yield:!0,await:!0,typeof:!0,void:!0,instanceof:!0,delete:!0,in:!0,new:!0,of:!0};function v(e,t,n){for(var r in e){if(!e.hasOwnProperty(r))break;r in t==0&&(t[r]=n)}}var y=void 0,b=void 0,A=/[^\s/]/,T=/[a-z]/,R=/\s/,x=/[\r\n]/,S=/\${pos}/g,I={object:!0,function:!0};function C(e,r,s,f){y=y||n.symbols||"a-z",b=b||n.snakeskinRgxp||new RegExp("[!$"+y+"_]","i");var h=n,d=h.cache,g=h.content,C=Boolean(r&&I[void 0===r?"undefined":t(r)]),N=C?Object(r):{};function w(e){return N["@label"]?N["@label"].replace(S,e):"__ESCAPER_QUOT__"+e+"_"}var F=!1;"boolean"==typeof r&&(F=Boolean(r)),"@comments"in N&&(v(u,N,N["@comments"]),v(a,N,N["@comments"]),delete N["@comments"]),"@strings"in N&&(v(i,N,N["@strings"]),delete N["@strings"]),"@literals"in N&&(v(o,N,N["@literals"]),delete N["@literals"]),"@all"in N&&(v(l,N,N["@all"]),delete N["@all"]);for(var M="",O=-1;++O<c.length;){var L=c[O];u[L]||a[L]?N[L]=F||N[L]:N[L]=N[L]||!C,M+=N[L]+","}var P=e,B=s||g;if(B===g&&d[M]&&d[M][P])return d[M][P];for(var D=!1,U=!0,k=!1,G=!1,j=0,V=!1,H=0,X=!1,$=void 0,z=void 0,W="",Y="",K=-1;++K<e.length;){var q=e.charAt(K),Q=e.charAt(K+1),Z=e.substr(K,2),J=e.substr(K,3);if(G)(x.test(Q)&&a[G]||u[q+e.charAt(K-1)]&&K-j>2&&u[G])&&(N[G]&&($=e.substring(j,K+1),-1===N[G]?z="":(z=w(B.length),B.push($)),e=e.substring(0,j)+z+e.substring(K+1),K+=z.length-$.length),G=!1);else{if(!D){if("/"===q&&((a[Z]||u[Z])&&(G=a[J]||u[J]?J:Z),G)){j=K;continue}m[q]||E[Y]?(U=!0,Y=""):A.test(q)&&(U=!1),T.test(q)?W+=q:(Y=W,W="");var ee=!1;f&&("|"===q&&b.test(Q)?(X=!0,U=!1,ee=!0):X&&R.test(q)&&(X=!1,U=!0,ee=!0)),ee||(m[q]?U=!0:A.test(q)&&(U=!1))}if("/"!==D||k||("["===q?V=!0:"]"===q&&(V=!1)),!D&&H&&("}"===q?H--:"{"===q&&H++,H||(q="`")),"`"!==D||k||"${"!==Z||(q="`",K++,H++),!l[q]||"/"===q&&!U||D){if(D&&("\\"===q||k))k=!k;else if(l[q]&&D===q&&!k&&("/"!==D||!V)){if("/"===q)for(var te=-1;++te<p.length;)_[e.charAt(K+1)]&&K++;D=!1,U=!1,N[q]&&($=e.substring(j,K+1),-1===N[q]?z="":(z=w(B.length),B.push($)),e=e.substring(0,j)+z+e.substring(K+1),K+=z.length-$.length)}}else D=q,j=K}}return B===g&&(d[M]=d[M]||{},d[M][P]=e),e}var N=/__ESCAPER_QUOT__(\d+)_/g;function w(e,t,r){return e.replace(r||N,function(e,r){return(t||n.content)[r]})}e.default=r,e.replace=C,e.paste=w,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){"use strict";var r=n(50),i=n(49),o=n(48),s=n(137).Transform;function a(e){if(!(this instanceof a))return new a(e);s.call(this,{objectMode:!0}),this.tree=null,this.source="",this.on("data",function(e){this.source+=e+"\n"}),this.compiler=o(e).compiler}n(16)(a,s),a.prototype._transform=function(e,t,n){if("string"==typeof e){var o=i(r(e,{version:"300 es"}));n(null,this.compiler.process(o)),this.tree=o}else this._isFunctionMode?("function"===e.type&&(this._isFunctionMode=!1),n(null)):"stmt"===e.type?n(null,this.compiler.process(e)):("functionargs"===e.type?this._isFunctionMode=!0:"stmtlist"===e.type&&(this.tree=e),n(null))},e.exports=a},function(e,t,n){e.exports=i;var r=n(28).EventEmitter;function i(){r.call(this)}n(16)(i,r),i.Readable=n(38),i.Writable=n(147),i.Duplex=n(148),i.Transform=n(149),i.PassThrough=n(150),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",u));var s=!1;function a(){s||(s=!0,e.end())}function u(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(l(),0===r.listenerCount(this,"error"))throw e}function l(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",a),n.removeListener("close",u),n.removeListener("error",c),e.removeListener("error",c),n.removeListener("end",l),n.removeListener("close",l),e.removeListener("close",l)}return n.on("error",c),e.on("error",c),n.on("end",l),n.on("close",l),e.on("close",l),e.emit("pipe",n),e}},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=c(e),r=n[0],s=n[1],a=new o(function(e,t,n){return 3*(t+n)/4-n}(0,r,s)),u=0,l=s>0?r-4:r,f=0;f<l;f+=4)t=i[e.charCodeAt(f)]<<18|i[e.charCodeAt(f+1)]<<12|i[e.charCodeAt(f+2)]<<6|i[e.charCodeAt(f+3)],a[u++]=t>>16&255,a[u++]=t>>8&255,a[u++]=255&t;2===s&&(t=i[e.charCodeAt(f)]<<2|i[e.charCodeAt(f+1)]>>4,a[u++]=255&t);1===s&&(t=i[e.charCodeAt(f)]<<10|i[e.charCodeAt(f+1)]<<4|i[e.charCodeAt(f+2)]>>2,a[u++]=t>>8&255,a[u++]=255&t);return a},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(f(e,s,s+16383>a?a:s+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function f(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(l(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=e[t+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+f],f+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(s++,u/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(t*u-1)*Math.pow(2,i),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;e[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+d]=255&s,d+=p,s/=256,c-=8);e[n+d-p]|=128*_}},function(e,t){},function(e,t,n){"use strict";var r=n(30).Buffer,i=n(142);function o(e,t,n){e.copy(t,n)}e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t=r.allocUnsafe(e>>>0),n=this.head,i=0;n;)o(n.data,t,i),i+=n.data.length,n=n.next;return t},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(144),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(9))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i=1,o={},s=!1,a=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick(function(){l(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&l(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),r=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){l(e.data)},r=function(t){e.port2.postMessage(t)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var e=a.documentElement;r=function(t){var n=a.createElement("script");n.onreadystatechange=function(){l(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():r=function(e){setTimeout(l,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var s={callback:e,args:t};return o[i]=s,r(i),i++},u.clearImmediate=c}function c(e){delete o[e]}function l(e){if(s)setTimeout(l,0,e);else{var t=o[e];if(t){s=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}(t)}finally{c(e),s=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(9),n(15))},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,n(9))},function(e,t,n){"use strict";e.exports=o;var r=n(61),i=n(25);function o(e){if(!(this instanceof o))return new o(e);r.call(this,e)}i.inherits=n(16),i.inherits(o,r),o.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(39)},function(e,t,n){e.exports=n(18)},function(e,t,n){e.exports=n(38).Transform},function(e,t,n){e.exports=n(38).PassThrough},function(e,t,n){(function(t){WebGLDebugUtils=function(){var e;void 0===e&&(e=t);var n=function(t){e.console&&e.console.error?e.console.error(t):function(t){e.console&&e.console.log&&e.console.log(t)}(t)},r={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},bindBuffer:{2:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}},bufferData:{3:{0:!0,2:!0},4:{0:!0,2:!0},5:{0:!0,2:!0}},bufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},copyBufferSubData:{5:{0:!0,1:!0}},getBufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},blitFramebuffer:{10:{8:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]},9:!0}},framebufferTextureLayer:{5:{0:!0,1:!0}},invalidateFramebuffer:{2:{0:!0}},invalidateSubFramebuffer:{6:{0:!0}},readBuffer:{1:{0:!0}},getInternalformatParameter:{3:{0:!0,1:!0,2:!0}},renderbufferStorageMultisample:{5:{0:!0,2:!0}},texStorage2D:{5:{0:!0,2:!0}},texStorage3D:{6:{0:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0},10:{0:!0,2:!0,6:!0,7:!0}},texImage3D:{10:{0:!0,2:!0,7:!0,8:!0},11:{0:!0,2:!0,7:!0,8:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0},10:{0:!0,6:!0,7:!0}},texSubImage3D:{11:{0:!0,8:!0,9:!0},12:{0:!0,8:!0,9:!0}},copyTexSubImage3D:{9:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0},8:{0:!0,2:!0},9:{0:!0,2:!0}},compressedTexImage3D:{8:{0:!0,2:!0},9:{0:!0,2:!0},10:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0},9:{0:!0,6:!0},10:{0:!0,6:!0}},compressedTexSubImage3D:{10:{0:!0,8:!0},11:{0:!0,8:!0},12:{0:!0,8:!0}},vertexAttribIPointer:{5:{2:!0}},drawArraysInstanced:{4:{0:!0}},drawElementsInstanced:{5:{0:!0,2:!0}},drawRangeElements:{6:{0:!0,4:!0}},readPixels:{7:{4:!0,5:!0},8:{4:!0,5:!0}},clearBufferfv:{3:{0:!0},4:{0:!0}},clearBufferiv:{3:{0:!0},4:{0:!0}},clearBufferuiv:{3:{0:!0},4:{0:!0}},clearBufferfi:{4:{0:!0}},beginQuery:{2:{0:!0}},endQuery:{1:{0:!0}},getQuery:{2:{0:!0,1:!0}},getQueryParameter:{2:{1:!0}},samplerParameteri:{3:{1:!0,2:!0}},samplerParameterf:{3:{1:!0}},getSamplerParameter:{2:{1:!0}},fenceSync:{2:{0:!0,1:{enumBitwiseOr:[]}}},clientWaitSync:{3:{1:{enumBitwiseOr:["SYNC_FLUSH_COMMANDS_BIT"]}}},waitSync:{3:{1:{enumBitwiseOr:[]}}},getSyncParameter:{2:{1:!0}},bindTransformFeedback:{2:{0:!0}},beginTransformFeedback:{1:{0:!0}},transformFeedbackVaryings:{3:{2:!0}},bindBufferBase:{3:{0:!0}},bindBufferRange:{5:{0:!0}},getIndexedParameter:{2:{0:!0}},getActiveUniforms:{3:{2:!0}},getActiveUniformBlockParameter:{3:{2:!0}}},i=null,o=null;function s(e){if(null==i)for(var t in i={},o={},e)"number"==typeof e[t]&&(i[e[t]]=t,o[t]=e[t])}function a(){if(null==i)throw"WebGLDebugUtils.init(ctx) not called"}function u(e){a();var t=i[e];return void 0!==t?"gl."+t:"/*UNKNOWN WebGL ENUM*/ 0x"+e.toString(16)}function c(e,t,n,i){var s;if(void 0!==(s=r[e])&&(void 0!==(s=s[t])&&s[n])){if("object"==typeof s[n]&&void 0!==s[n].enumBitwiseOr){for(var a=s[n].enumBitwiseOr,c=0,l=[],f=0;f<a.length;++f){var h=o[a[f]];0!=(i&h)&&(c|=h,l.push(u(h)))}return c===i?l.join(" | "):u(i)}return u(i)}return null===i?"null":void 0===i?"undefined":i.toString()}function l(e,t,n){e.__defineGetter__(n,function(){return t[n]}),e.__defineSetter__(n,function(e){t[n]=e})}function f(e){var t=!!e.createTransformFeedback;t&&e.bindVertexArray(null);var n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r);for(var i=0;i<n;++i)e.disableVertexAttribArray(i),e.vertexAttribPointer(i,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(i,0),t&&e.vertexAttribDivisor(i,0);e.deleteBuffer(r);var o=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);for(i=0;i<o;++i)e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null),t&&(e.bindTexture(e.TEXTURE_2D_ARRAY,null),e.bindTexture(e.TEXTURE_3D,null),e.bindSampler(i,null));if(e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),t){e.drawBuffers([e.BACK]),e.readBuffer(e.BACK),e.bindBuffer(e.COPY_READ_BUFFER,null),e.bindBuffer(e.COPY_WRITE_BUFFER,null),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),e.bindBuffer(e.PIXEL_UNPACK_BUFFER,null);var s=e.getParameter(e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS);for(i=0;i<s;++i)e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,i,null);var a=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);for(i=0;i<a;++i)e.bindBufferBase(e.UNIFORM_BUFFER,i,null);e.disable(e.RASTERIZER_DISCARD),e.pixelStorei(e.UNPACK_IMAGE_HEIGHT,0),e.pixelStorei(e.UNPACK_SKIP_IMAGES,0),e.pixelStorei(e.UNPACK_ROW_LENGTH,0),e.pixelStorei(e.UNPACK_SKIP_ROWS,0),e.pixelStorei(e.UNPACK_SKIP_PIXELS,0),e.pixelStorei(e.PACK_ROW_LENGTH,0),e.pixelStorei(e.PACK_SKIP_ROWS,0),e.pixelStorei(e.PACK_SKIP_PIXELS,0),e.hint(e.FRAGMENT_SHADER_DERIVATIVE_HINT,e.DONT_CARE)}for(;e.getError(););}return{init:s,mightBeEnum:function(e){return a(),void 0!==i[e]},glEnumToString:u,glFunctionArgToString:c,glFunctionArgsToString:function(e,t){for(var n="",r=t.length,i=0;i<r;++i)n+=(0==i?"":", ")+c(e,r,i,t[i]);return n},makeDebugContext:function e(t,r,i,o){o=o||t,s(t),r=r||function(e,t,r){for(var i="",o=r.length,s=0;s<o;++s)i+=(0==s?"":", ")+c(t,o,s,r[s]);n("WebGL error "+u(e)+" in "+t+"("+i+")")};var a={};function f(e,t){return function(){i&&i(t,arguments);var n=e[t].apply(e,arguments),s=o.getError();return 0!=s&&(a[s]=!0,r(s,t,arguments)),n}}var h={};for(var d in t)if("function"==typeof t[d])if("getExtension"!=d)h[d]=f(t,d);else{var p=f(t,d);h[d]=function(){var n=p.apply(t,arguments);return n?e(n,r,i,o):null}}else l(h,t,d);return h.getError=function(){for(var e in a)if(a.hasOwnProperty(e)&&a[e])return a[e]=!1,e;return t.NO_ERROR},h},makeLostContextSimulatingCanvas:function(t){var n,r,i=[],o=[],s={},a=1,u=!1,c=[],h=0,d=0,p=!1,_=0,g={};function m(e){return"function"==typeof e?e:function(t){e.handleEvent(t)}}t.getContext=function(i){return function(){var o=i.apply(t,arguments);if(o instanceof WebGLRenderingContext||e.WebGL2RenderingContext&&o instanceof WebGL2RenderingContext){if(o!=n){if(n)throw"got different context";r=e.WebGL2RenderingContext&&o instanceof WebGL2RenderingContext,s=function(e){for(var t in e)"function"==typeof e[t]?s[t]=b(e,t):l(s,e,t);s.getError=function(){if(y(),!u)for(;e=n.getError();)g[e]=!0;for(var e in g)if(g[e])return delete g[e],e;return s.NO_ERROR};var i=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"];r&&i.push("createQuery","createSampler","fenceSync","createTransformFeedback","createVertexArray");for(var o=0;o<i.length;++o){var f=i[o];s[f]=function(t){return function(){if(y(),u)return null;var n=t.apply(e,arguments);return n.__webglDebugContextLostId__=a,c.push(n),n}}(e[f])}var h=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];r&&h.push("getInternalformatParameter","getQuery","getQueryParameter","getSamplerParameter","getSyncParameter","getTransformFeedbackVarying","getIndexedParameter","getUniformIndices","getActiveUniforms","getActiveUniformBlockParameter","getActiveUniformBlockName");for(var o=0;o<h.length;++o){var f=h[o];s[f]=function(t){return function(){return y(),u?null:t.apply(e,arguments)}}(s[f])}var d=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];r&&d.push("isQuery","isSampler","isSync","isTransformFeedback","isVertexArray");for(var o=0;o<d.length;++o){var f=d[o];s[f]=function(t){return function(){return y(),!u&&t.apply(e,arguments)}}(s[f])}return s.checkFramebufferStatus=function(t){return function(){return y(),u?s.FRAMEBUFFER_UNSUPPORTED:t.apply(e,arguments)}}(s.checkFramebufferStatus),s.getAttribLocation=function(t){return function(){return y(),u?-1:t.apply(e,arguments)}}(s.getAttribLocation),s.getVertexAttribOffset=function(t){return function(){return y(),u?0:t.apply(e,arguments)}}(s.getVertexAttribOffset),s.isContextLost=function(){return u},r&&(s.getFragDataLocation=function(t){return function(){return y(),u?-1:t.apply(e,arguments)}}(s.getFragDataLocation),s.clientWaitSync=function(t){return function(){return y(),u?s.WAIT_FAILED:t.apply(e,arguments)}}(s.clientWaitSync),s.getUniformBlockIndex=function(t){return function(){return y(),u?s.INVALID_INDEX:t.apply(e,arguments)}}(s.getUniformBlockIndex)),s}(n=o)}return s}return o}}(t.getContext);var E=function(e){i.push(m(e))},v=function(e){o.push(m(e))};function y(){++d,u||h==d&&t.loseContext()}function b(e,t){var n=e[t];return function(){if(y(),!u)return n.apply(e,arguments)}}function A(e){return{statusMessage:e,preventDefault:function(){p=!0}}}return function(e){var t=e.addEventListener;e.addEventListener=function(n,r,i){switch(n){case"webglcontextlost":E(r);break;case"webglcontextrestored":v(r);break;default:t.apply(e,arguments)}}}(t),t.loseContext=function(){if(!u){for(u=!0,h=0,++a;n.getError(););!function(){for(var e=Object.keys(g),t=0;t<e.length;++t)delete g[e[t]]}(),g[n.CONTEXT_LOST_WEBGL]=!0;var e=A("context lost"),r=i.slice();setTimeout(function(){for(var n=0;n<r.length;++n)r[n](e);_>=0&&setTimeout(function(){t.restoreContext()},_)},0)}},t.restoreContext=function(){u&&o.length&&setTimeout(function(){if(!p)throw"can not restore. webglcontestlost listener did not call event.preventDefault";!function(){for(var e=0;e<c.length;++e){var t=c[e];t instanceof WebGLBuffer?n.deleteBuffer(t):t instanceof WebGLFramebuffer?n.deleteFramebuffer(t):t instanceof WebGLProgram?n.deleteProgram(t):t instanceof WebGLRenderbuffer?n.deleteRenderbuffer(t):t instanceof WebGLShader?n.deleteShader(t):t instanceof WebGLTexture?n.deleteTexture(t):r&&(t instanceof WebGLQuery?n.deleteQuery(t):t instanceof WebGLSampler?n.deleteSampler(t):t instanceof WebGLSync?n.deleteSync(t):t instanceof WebGLTransformFeedback?n.deleteTransformFeedback(t):t instanceof WebGLVertexArrayObject&&n.deleteVertexArray(t))}}(),f(n),u=!1,d=0,p=!1;for(var e=o.slice(),t=A("context restored"),i=0;i<e.length;++i)e[i](t)},0)},t.loseContextInNCalls=function(e){if(u)throw"You can not ask a lost contet to be lost";h=d+e},t.getNumCalls=function(){return d},t.setRestoreTimeout=function(e){_=e},t},resetToInitialState:f}}(),e.exports=WebGLDebugUtils}).call(this,n(9))},function(e,t,n){"use strict";n.r(t);class r{constructor(e){const t=e.length;this.xa=[],this.ya=[],this.u=[],this.y2=[],e.sort((e,t)=>e[0]-t[0]);for(let n=0;n<t;n++)this.xa.push(e[n][0]),this.ya.push(e[n][1]);this.u[0]=0,this.y2[0]=0;for(let e=1;e<t-1;++e){const t=this.xa[e+1]-this.xa[e-1],n=(this.xa[e]-this.xa[e-1])/t,r=n*this.y2[e-1]+2;this.y2[e]=(n-1)/r;const i=(this.ya[e+1]-this.ya[e])/(this.xa[e+1]-this.xa[e])-(this.ya[e]-this.ya[e-1])/(this.xa[e]-this.xa[e-1]);this.u[e]=(6*i/t-n*this.u[e-1])/r}this.y2[t-1]=0;for(let e=t-2;e>=0;--e)this.y2[e]=this.y2[e]*this.y2[e+1]+this.u[e]}interpolate(e){let t=0,n=this.ya.length-1;for(;n-t>1;){const r=n+t>>1;this.xa[r]>e?n=r:t=r}const r=this.xa[n]-this.xa[t],i=(this.xa[n]-e)/r,o=(e-this.xa[t])/r;return i*this.ya[t]+o*this.ya[n]+((i*i*i-i)*this.y2[t]+(o*o*o-o)*this.y2[n])*(r*r)/6}}var i={name:"curves",uniforms:{map:{type:"sampler2D"}},fs:"uniform sampler2D red;\nuniform sampler2D green;\nuniform sampler2D blue;\n\nvec4 curves_filterColor(vec4 color) {\n  color.r = texture2D(red, vec2(color.r)).r;\n  color.g = texture2D(green, vec2(color.g)).g;\n  color.b = texture2D(blue, vec2(color.b)).b;\n  return color;\n}\n",passes:[{filter:!0}],getCurvesArray:function(e=[[0,0],[1,1]],t,n){e=s(e),1===arguments.length?t=n=e:(t=s(t),n=s(n));const r=[];for(let i=0;i<256;i++)r.splice(r.length,0,e[i],t[i],n[i],255);return new Uint8Array(r)}};const o=(e,t,n)=>Math.max(Math.min(e,n),t);function s(e){const t=new r(e),n=[];for(let e=0;e<256;e++)n.push(o(Math.floor(256*t.interpolate(e/255)),0,55)),n.push(o(Math.floor(256*t.interpolate(e/255)),0,55));return n}var a={name:"brightnessContrast",uniforms:{brightness:{value:0,min:-1,max:1},contrast:{value:0,min:-1,max:1}},fs:"uniform float brightness;\nuniform float contrast;\n\nvec4 brightnessContrast_filterColor(vec4 color) {\n  color.rgb += brightness;\n  if (contrast > 0.0) {\n    color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;\n  } else {\n    color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;\n  }\n  return color;\n}\n\nvec4 brightnessContrast_filterColor(vec4 color, vec2 texSize, vec2 texCoords) {\n  return brightnessContrast_filterColor(color);\n}\n",passes:[{filter:!0}]};var u={name:"denoise",uniforms:{strength:{value:.5,min:0,max:.1,adjust:e=>.53+200*Math.pow(1-e,4)}},fs:"uniform float strength;\n\nvec4 denoise_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  float adjustedExponent = 3. + 200. * pow(1. - strength, 4.);\n\n  vec4 center = texture2D(texture, texCoord);\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n  for (float x = -4.0; x <= 4.0; x += 1.0) {\n    for (float y = -4.0; y <= 4.0; y += 1.0) {\n      vec4 sample = texture2D(texture, texCoord + vec2(x, y) / texSize);\n      float weight = 1.0 - abs(dot(sample.rgb - center.rgb, vec3(0.25)));\n      weight = pow(weight, adjustedExponent);\n      color += sample * weight;\n      total += weight;\n    }\n  }\n\n  return color / total;\n}\n",passes:[{sampler:!0},{sampler:!0}]};var c={name:"hueSaturation",uniforms:{hue:{value:0,min:-1,max:1},saturation:{value:0,min:-1,max:1}},fs:"uniform float hue;\nuniform float saturation;\n\nvec4 hueSaturation_filterColor(vec4 color) {\n  // hue adjustment, wolfram alpha: RotationTransform[angle, {1, 1, 1}][{x, y, z}]\n  float angle = hue * 3.14159265;\n  float s = sin(angle), c = cos(angle);\n  vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;\n  float len = length(color.rgb);\n  color.rgb = vec3(\n    dot(color.rgb, weights.xyz),\n    dot(color.rgb, weights.zxy),\n    dot(color.rgb, weights.yzx)\n  );\n\n  // saturation adjustment\n  float average = (color.r + color.g + color.b) / 3.0;\n  if (saturation > 0.0) {\n    color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));\n  } else {\n    color.rgb += (average - color.rgb) * (-saturation);\n  }\n\n  return color;\n}\n\nvec4 hueSaturation_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return hueSaturation_filterColor(color);\n}\n",passes:[{filter:!0}]};var l={name:"noise",uniforms:{amount:{value:.5,min:0,max:1}},fs:"uniform float amount;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvec4 noise_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return noise_filterColor(color, texCoord);\n}\n",passes:[{filter:!0}]};var f={name:"sepia",uniforms:{amount:{value:.5,min:0,max:1}},fs:"uniform float amount;\n\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * amount))) + (g * (0.769 * amount)) + (b * (0.189 * amount)));\n  color.g = min(1.0, (r * 0.349 * amount) + (g * (1.0 - (0.314 * amount))) + (b * 0.168 * amount));\n  color.b = min(1.0, (r * 0.272 * amount) + (g * 0.534 * amount) + (b * (1.0 - (0.869 * amount))));\n\n  return color;\n}\n\nvec4 sepia_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return sepia_filterColor(color);\n}\n",passes:[{filter:!0}]};var h={name:"random",fs:"float random(vec3 scale, float seed) {\n  /* use the fragment position for a different seed per-pixel */\n  return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n"};var d={name:"triangleBlur",uniforms:{radius:{value:20,min:0,softMax:100},delta:{value:[1,0],private:!0}},fs:"uniform float radius;\nuniform vec2 delta;\n\nvec4 triangleBlur_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 adjustedDelta = delta * radius / texSize;\n\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n\n  /* randomize the lookup values to hide the fixed number of samples */\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec4 sample = texture2D(texture, texCoord + adjustedDelta * percent);\n\n    /* switch to pre-multiplied alpha to correctly blur transparent images */\n    sample.rgb *= sample.a;\n\n    color += sample * weight;\n    total += weight;\n  }\n\n  color = color / total;\n\n  /* switch back from pre-multiplied alpha */\n  color.rgb /= color.a + 0.00001;\n\n  return color;\n}\n",dependencies:[h],passes:[{sampler:!0,uniforms:{delta:[1,0]}},{sampler:!0,uniforms:{delta:[0,1]}}]};var p={name:"unsharpMask",uniforms:{radius:{value:20,min:0,softMax:200},strength:{value:1,min:0,softMax:5}},dependencies:[d],passes:[{module:d,target:"texture1"},{sampler:!0,uniforms:{blurredTexture:"texture1"}}]};var _={name:"vibrance",uniforms:{amount:{value:0,min:-1,max:1}},fs:"uniform float amount;\n\nvec4 vibrance_filterColor(vec4 color) {\n  float average = (color.r + color.g + color.b) / 3.0;\n  float mx = max(color.r, max(color.g, color.b));\n  float amt = (mx - average) * (-amount * 3.0);\n  color.rgb = mix(color.rgb, vec3(mx), amt);\n  return color;\n}\n\nvec4 vibrance_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return vibrance_filterColor(color);\n}\n",passes:[{filter:!0}]};var g={name:"vignette",fs:"uniform float radius;\nuniform float amount;\n\nvec4 vignette_filterColor(vec4 color, vec2 texCoord) {\n  float dist = distance(texCoord, vec2(0.5, 0.5));\n  color.rgb *= smoothstep(0.8, radius * 0.799, dist * (amount + radius));\n  return color;\n}\n\nvec4 vignette_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return vignette_filterColor(color, texCoord);\n}\n",uniforms:{radius:{value:.5,min:0,max:1},amount:{value:.5,min:0,max:1}},passes:[{filter:!0}]};var m={name:"tiltShift",uniforms:{blurRadius:{value:15,min:0,max:50},gradientRadius:{value:200,min:0,max:400},start:[0,0],end:[1,1],invert:{value:!1,private:!0}},fs:"uniform float blurRadius;\nuniform float gradientRadius;\nuniform vec2 start;\nuniform vec2 end;\nuniform bool invert;\n\nvec2 tiltShift_getDelta() {\n  vec2 vector = normalize(end - start);\n  return invert ? vec2(-vector.y, vector.x) : vector;\n}\n\nvec4 tiltShift_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n\n  /* randomize the lookup values to hide the fixed number of samples */\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n  float radius = smoothstep(0.0, 1.0,\n    abs(dot(texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec4 sample = texture2D(texture, texCoord + tiltShift_getDelta() / texSize * percent * radius);\n\n    /* switch to pre-multiplied alpha to correctly blur transparent images */\n    sample.rgb *= sample.a;\n\n    color += sample * weight;\n    total += weight;\n  }\n\n  color = color / total;\n\n  /* switch back from pre-multiplied alpha */\n  color.rgb /= color.a + 0.00001;\n\n  return color;\n}\n",dependencies:[h],passes:[{sampler:!0,uniforms:{invert:!1}},{sampler:!0,uniforms:{invert:!0}}]};var E={name:"zoomBlur",uniforms:{center:[.5,.5],strength:{value:.3,min:0,softMax:1}},fs:"\nuniform vec2 center;\nuniform float strength;\n\nvec4 zoomBlur_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n  vec2 toCenter = center - texCoord * texSize;\n\n  /* randomize the lookup values to hide the fixed number of samples */\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = 0.0; t <= 40.0; t++) {\n    float percent = (t + offset) / 40.0;\n    float weight = 4.0 * (percent - percent * percent);\n    vec4 sample = texture2D(texture, texCoord + toCenter * percent * strength / texSize);\n\n    /* switch to pre-multiplied alpha to correctly blur transparent images */\n    sample.rgb *= sample.a;\n\n    color += sample * weight;\n    total += weight;\n  }\n\n  color = color / total;\n\n  /* switch back from pre-multiplied alpha */\n  color.rgb /= color.a + 0.00001;\n\n  return color;\n}\n",dependencies:[h],passes:[{sampler:!0}]};var v={name:"colorHalftone",uniforms:{center:[.5,.5],angle:{value:1.1,softMin:0,softMax:Math.PI/2},size:{value:4,min:1,softMin:3,softMax:20}},fs:"uniform vec2 center;\nuniform float angle;\nuniform float size;\n\nfloat scale = 3.1514 / size;\n\nfloat pattern(float angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(angle), c = cos(angle);\n  vec2 tex = texCoord * texSize - center;\n  vec2 point = vec2(\n\tc * tex.x - s * tex.y,\n\ts * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n\tcmy * 10.0 - 3.0 + vec3(\n    pattern(angle + 0.26179, texSize, texCoord),\n\t  pattern(angle + 1.30899, texSize, texCoord),\n    pattern(angle, texSize, texCoord)\n  ),\n\t0.0,\n\t1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n",passes:[{filter:!0}]};var y={name:"dotScreen",uniforms:{center:[.5,.5],angle:{value:1.1,softMin:0,softMax:Math.PI/2},size:{value:3,min:1,softMin:3,softMax:20}},fs:"uniform vec2 center;\nuniform float angle;\nuniform float size;\n\nfloat pattern(vec2 texSize, vec2 texCoord) {\n  float scale = 3.1415 / size;\n\n  float s = sin(angle), c = cos(angle);\n  vec2 tex = texCoord * texSize - center;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvec4 dotScreen_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  float average = (color.r + color.g + color.b) / 3.0;\n  return vec4(vec3(average * 10.0 - 5.0 + pattern(texSize, texCoord)), color.a);\n}\n",passes:[{filter:!0}]};var b={name:"edgeWork",uniforms:{radius:{value:2,min:1,softMax:50},delta:{value:[1,0],private:!0}},fs:"uniform float radius;\nuniform vec2 delta;\n\nvec4 edgeWork_sampleColor1(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 relativeDelta = radius * delta / texSize;\n\n  vec2 color = vec2(0.0);\n  vec2 total = vec2(0.0);\n\n  /* randomize the lookup values to hide the fixed number of samples */\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec3 sample = texture2D(texture, texCoord + relativeDelta * percent).rgb;\n    float average = (sample.r + sample.g + sample.b) / 3.0;\n    color.x += average * weight;\n    total.x += weight;\n    if (abs(t) < 15.0) {\n      weight = weight * 2.0 - 1.0;\n      color.y += average * weight;\n      total.y += weight;\n    }\n  }\n  return vec4(color / total, 0.0, 1.0);\n}\n\nvec4 edgeWork_sampleColor2(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 relativeDelta = radius * delta / texSize;\n\n  vec2 color = vec2(0.0);\n  vec2 total = vec2(0.0);\n\n  /* randomize the lookup values to hide the fixed number of samples */\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec2 sample = texture2D(texture, texCoord + relativeDelta * percent).xy;\n    color.x += sample.x * weight;\n    total.x += weight;\n    if (abs(t) < 15.0) {\n      weight = weight * 2.0 - 1.0;\n      color.y += sample.y * weight;\n      total.y += weight;\n    }\n  }\n  float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);\n  return vec4(c, c, c, 1.0);\n}\n",dependencies:[h],passes:[{sampler:"edgeWork_sampleColor1",uniforms:{delta:[1,0]}},{sampler:"edgeWork_sampleColor2",uniforms:{delta:[0,1]}}]};var A={name:"hexagonalPixelate",uniforms:{center:{value:[.5,.5],hint:"screenspace"},scale:{value:10,min:1,softMin:5,softMax:50}},fs:"uniform vec2 center;\nuniform float scale;\n\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - center) / scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= scale / texSize;\n\n  return texture2D(texture, choice + center / texSize);\n}\n",passes:[{sampler:!0}]};var T={name:"ink",uniforms:{strength:{value:.25,min:0,softMax:1}},fs:"uniform float strength;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = strength * strength * strength * strength * strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n",passes:[{sampler:!0}]};var R={name:"warp",fs:"vec4 warp_sampleColor(sampler2D texture, vec2 texSize, vec2 coord) {\n  vec4 color = texture2D(texture, coord / texSize);\n  vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);\n  if (coord != clampedCoord) {\n    /* fade to transparent if we are outside the image */\n    color.a *= max(0.0, 1.0 - length(coord - clampedCoord));\n  }\n\n  return color;\n}\n"};var x={name:"bulgePinch",fs:"uniform float radius;\nuniform float strength;\nuniform vec2 center;\n\nvec2 bulgePinch_warp(vec2 coord) {\n  coord -= center;\n  float distance = length(coord);\n  if (distance < radius) {\n    float percent = distance / radius;\n    if (strength > 0.0) {\n      coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n    } else {\n      coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n    }\n  }\n  coord += center;\n  return coord;\n}\n\nvec4 bulgePinch_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 coord = texCoord * texSize;\n  coord = bulgePinch_warp(coord);\n\n  return warp_sampleColor(texture, texSize, coord);\n}\n",uniforms:{center:[.5,.5],radius:{value:200,min:1,softMax:600},strength:{value:.5,min:-1,max:1}},dependencies:[R],passes:[{sampler:!0}]};var S={name:"swirl",uniforms:{center:[.5,.5],radius:{value:200,min:1,softMax:600},angle:{value:3,softMin:-25,softMax:25}},fs:"uniform float radius;\nuniform float angle;\nuniform vec2 center;\n\nvec2 swirl_warp(vec2 coord) {\n  coord -= center;\n  float distance = length(coord);\n  if (distance < radius) {\n    float percent = (radius - distance) / radius;\n    float theta = percent * percent * angle;\n    float s = sin(theta);\n    float c = cos(theta);\n    coord = vec2(\n      coord.x * c - coord.y * s,\n      coord.x * s + coord.y * c\n    );\n  }\n  coord += center;\n  return coord;\n}\n\nvec4 swirl_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 coord = texCoord * texSize;\n  coord = swirl_warp(coord);\n\n  return warp_sampleColor(texture, texSize, coord);\n}\n",dependencies:[R],passes:[{sampler:!0}]};n.d(t,"splineInterpolate",function(){return s}),n.d(t,"brightnessContrast",function(){return a}),n.d(t,"denoise",function(){return u}),n.d(t,"hueSaturation",function(){return c}),n.d(t,"noise",function(){return l}),n.d(t,"sepia",function(){return f}),n.d(t,"unsharpMask",function(){return p}),n.d(t,"vibrance",function(){return _}),n.d(t,"vignette",function(){return g}),n.d(t,"curves",function(){return i}),n.d(t,"tiltShift",function(){return m}),n.d(t,"triangleBlur",function(){return d}),n.d(t,"zoomBlur",function(){return E}),n.d(t,"colorHalftone",function(){return v}),n.d(t,"dotScreen",function(){return y}),n.d(t,"edgeWork",function(){return b}),n.d(t,"hexagonalPixelate",function(){return A}),n.d(t,"ink",function(){return T}),n.d(t,"bulgePinch",function(){return x}),n.d(t,"swirl",function(){return S}),n.d(t,"random",function(){return h})},function(e,t,n){"use strict";n.r(t);var r=n(8),i=n(20),o=n(4);const s={},a={NONE:0,DEPTH:1,FRAGMENT:2},u=[1,1,0,1],c=[0,0,1,1],l=[1,0,0,1];var f=({model:e,draw:t,colorMode:n=a.NONE})=>{const r=function(e){const{id:t,program:n}=e;let r=s[n.vs.source];r||(r=Object(i.c)(`${t}-vs`,n.vs.source),s[n.vs.source]=r);let o=s[n.fs.source];o||(o=Object(i.a)(`${t}-fs`,n.fs.source),s[n.fs.source]=o);return{vs:r,fs:o}}(e),{uniforms:o}=e.program,{instancedAttributes:u,vertexAttributes:c,indices:l,attributeValues:f,vertexCount:p}=function(e){const t={},n={},r={};let i,o=null,s=1;for(const i in e){const a=e[i];a.isIndexed?o=a:a.divisor?n[i]=a:(r[i]=a,a.constant||(s=a.getBuffer().getElementCount()/a.size)),t[i]=!a.constant&&a.getBuffer().getData()}i=o?t[o.id]:Array.from({length:s},(e,t)=>t);return{instancedAttributes:n,vertexAttributes:r,indices:i,attributeValues:t,vertexCount:s}}(e._attributes),_=e.getDrawMode(),g=e.instanceCount||1;for(let e=0;e<g;e++){const i=h(u,e,f),s=[],a=[];for(let e=0;e<p;e++){const t=Object.assign({},i,h(c,e,f)),{position:u,color:l}=d(r,o,t,n);s[e]=u,a[e]=l}t({indices:l,drawMode:_,positions:s,colors:a})}};function h(e,t,n){const r={};for(const i in e){const o=e[i];if(o.constant)r[i]=o.value;else{const{size:e}=o,s=n[i].subarray(t*e,(t+1)*e);r[i]=Array.from(s)}}return r}function d(e,t,n,r){const{gl_Position:i,varyings:s}=e.vs(t,n);let f;switch(r){case a.DEPTH:{const e=Object(o.clamp)(i[2]/i[3],-1,1);f=Object(o.lerp)(u,c,(e+1)/2);break}case a.FRAGMENT:{const{gl_FragColor:n,isDiscarded:r}=e.fs(t,s);f=r?l:n;break}}return{position:i,color:f}}var p=n(0),_=n.n(p);class g{constructor(e){this.sourceCanvas=e;const t=e.offsetParent;"static"===window.getComputedStyle(t).position&&(t.style.position="relative"),this.canvas=this._createCanvas(t),this.context=this.canvas.getContext("2d"),this._draw=this._draw.bind(this)}clear(e={}){const{canvas:t,context:n}=this,{clientWidth:r,clientHeight:i}=this.sourceCanvas;t.width=r,t.height=i,n.clearRect(0,0,r,i);for(const t in e)n[t]=e[t]}drawModel(e,t){f(Object.assign({},t,{model:e,draw:this._draw}))}_draw({drawMode:e,indices:t,positions:n,colors:r}){switch(this.positions=n.map(this._clipspaceToScreen,this),this.colors=r.map(this._rgbaToColor,this),e){case _.a.POINTS:for(let e=0;e<t.length;e++)this._drawPoint(t[e]);break;case _.a.LINES:for(let e=0;e<t.length-1;e+=2)this._drawLine(t[e],t[e]+1);break;case _.a.LINE_STRIP:for(let e=0;e<t.length-1;e++)this._drawLine(t[e],t[e+1]);break;case _.a.LINE_LOOP:for(let e=0;e<t.length;e++)this._drawLine(0===e?t[t.length-1]:t[e-1],t[e]);break;case _.a.TRIANGLES:for(let e=0;e<t.length-2;e+=3)this._drawTriangle(t[e],t[e+1],t[e+2]);break;case _.a.TRIANGLE_STRIP:for(let e=0;e<t.length-2;e++)this._drawTriangle(t[e],t[e+1],t[e+2]);break;case _.a.TRIANGLE_FAN:for(let e=1;e<t.length-1;e++)this._drawTriangle(t[0],t[e],t[e+1]);break;default:throw new Error("unknown draw mode")}}_createCanvas(e){const t=document.createElement("canvas");return e.append(t),Object.assign(t.style,{position:"absolute",left:"0px",top:"0px",pointerEvents:"none"}),t}_clipspaceToScreen(e){const{width:t,height:n}=this.canvas,[r,i,o,s]=e,a=o/s;return a<-1||a>1?null:[(r/s+1)*t/2,(1-i/s)*n/2]}_rgbaToColor(e){if(Array.isArray(e)){const t=e.slice(0,3).map(e=>255*e|0),n=Number.isFinite(e[3])?e[3]:1;return`rgba(${t.join(",")},${n.toFixed(2)})`}return e}_drawPoint(e){const{context:t,positions:n,colors:r}=this,i=n[e],o=r[e];i&&(o&&(t.fillStyle=o),t.fillRect(i[0]-.5,i[1]-.5,1,1))}_drawLine(e,t){const{context:n,positions:r,colors:i}=this,o=r[e],s=r[t],a=i[e],u=i[t];if(o&&s){if(n.beginPath(),a!==u){const e=n.createLinearGradient(o[0],o[1],s[0],s[1]);e.addColorStop(0,a),e.addColorStop(1,u),n.strokeStyle=e}else a&&(n.strokeStyle=a);n.moveTo(o[0],o[1]),n.lineTo(s[0],s[1]),n.stroke()}}_drawTriangle(e,t,n){this._drawLine(e,t),this._drawLine(t,n),this._drawLine(n,e)}}const m=n(151);function E(e){return e.luma=e.luma||{},e.luma}function v(e,{debug:t=!0}={}){return null===e?null:t?function(e){if(null===e)return null;const t=E(e);if(t.realContext)return e;if(t.debugContext)return t.debugContext;const n=m.makeDebugContext(e,b,A);return Object.assign(class{}.prototype,n),t.debugContext=n,n.debug=!0,n.gl=e,r.log.info("debug context actived.")(),n}(e):function(e){if(null===e)return null;const t=E(e);return t.realContext?t.realContext:e}(e)}function y(e,t){let n=m.glFunctionArgsToString(e,t);return`gl.${e}(${n=`${n.slice(0,100)}${n.length>100?"...":""}`})`}function b(e,t,n){const i=`${m.glEnumToString(e)} in gl.${t}(${m.glFunctionArgsToString(t,n)})`;if(r.log.throw)throw new Error(i);r.log.error(i)()}function A(e,t){let n;if(r.log.priority>=4&&(n=y(e,t),r.log.log(4,n)()),r.log.break){n=n||y(e,t);r.log.break&&r.log.break.every(e=>-1!==n.indexOf(e))}for(const i of t)if(void 0===i){if(n=n||y(e,t),r.log.throw)throw new Error(`Undefined argument: ${n}`);r.log.error(`Undefined argument: ${n}`)()}}n.d(t,"COLOR_MODE",function(){return a}),n.d(t,"_DebugContext",function(){return g}),n.d(t,"compileShaderModule",function(){return i.b}),n.d(t,"compileVertexShader",function(){return i.c}),n.d(t,"compileFragmentShader",function(){return i.a}),n.d(t,"makeDebugContext",function(){return v}),r.global.makeDebugContext=v,r.log.info("@luma.gl/debug: WebGL debug support installed")}])});